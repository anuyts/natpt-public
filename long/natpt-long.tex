\documentclass[a4paper]{memoir}
	\setsecnumdepth{subsubsection}
	%\renewcommand{\thechapter}{\Roman{chapter}}
	%\setlength\cftchapternumwidth{3em}
	\renewcommand{\thesubsubsection}{\arabic{chapter}.\arabic{section}.\arabic{subsection} (\alph{subsubsection})}

\usepackage{a4wide}

\usepackage{amsthm}
\pdfoutput=1

\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{mathrsfs}
\RequirePackage{mathtools}
%\RequirePackage{mathabx}
\RequirePackage{latexsym}
%\RequirePackage{epstopdf}
%\RequirePackage{array}
\RequirePackage{stmaryrd}
\RequirePackage[normalem]{ulem}
%\RequirePackage{xfrac}
\RequirePackage{soul}
	\sethlcolor{lightgray}
	
\usepackage{enumitem}
	\setlist{noitemsep}

%\usepackage{bm}
\usepackage[all,cmtip]{xy}
%\usepackage{mathtools}
%\usepackage{longtable}

%\usepackage{mdframed}
%\let\framedCopy=\framed
%\let\framed=\undefined

\usepackage[hidelinks,bookmarksnumbered,bookmarksdepth=subsubsection]{hyperref}
	\setcounter{tocdepth}{3}
\RequirePackage{cleveref}

\usepackage{wasysym}
\usepackage{stmaryrd}
%\usepackage[notext]{stix}
\usepackage{fontawesome}
\RequirePackage{amssymb}
\RequirePackage[dvipsnames]{xcolor}
\usepackage{xypic}
	\CompileMatrices
\RequirePackage{mathtools}
\usepackage{stmaryrd}

\usepackage{libertine}

\usepackage[english]{babel}
%\usepackage[dutch]{babel}

\allowdisplaybreaks

\usepackage{../natpt-macros}
	\renewcommand{\thetheorem}{\arabic{chapter}.\arabic{section}.\arabic{subsection}\textdegree\arabic{theorem}}

%\newcommand{\todoi}[1]{\textbf{\textcolor{red}{#1 \qed}}\par\noindent}
%\newcommand{\todo}[1]{\textbf{\textcolor{red}{\footnote{\textcolor{red}{#1}}}}}
%\newcommand{\todoi}[1]{}
%\newcommand{\todo}[1]{}

\newcommand{\thetitle}{Models of Naturality Pretype Theory: \\ Technical Report \\ v0.2}
\newcommand{\theauthors}{Andreas Nuyts\thanks{Andreas Nuyts holds a Postdoctoral Fellowship from the Research Foundation - Flanders (FWO; 1247922N). This research is partially funded by the Research Fund KU Leuven.} \\ DistriNet, KU Leuven, Belgium}
\begin{document}
	\addtolength{\voffset}{-.5in}

\title{\thetitle}
%\subtitle{Technical report}
\date{\today}
\author{\theauthors{}}
%\address{imec-DistriNet, KU Leuven, Belgium}
\maketitle
%\vspace*{-.5in}
%\begin{abstract}
%\end{abstract}

\pagebreak

\tableofcontents

%\pagebreak

\chapter{Base Categories and Modes} \label{ch:modes}

In this chapter, we establish the object part of the mode theory for naturality pretype theory and its model.
Modes will be \textbf{anpolarity masks} $\vec a$ (\cref{sec:mask}) which will be modelled in presheaf categories over certain base categories.
We propose two families of base categories, parametrized by the mask $\vec a$, and both are built using the category $\jetset{\vec a}$ of \textbf{jet sets} over $\vec a$ (\cref{sec:jetset}).
Jet sets themselves are not suitable as a base category, e.g.\ because they are closed under coproducts, which the Yoneda-embedding will never preserve.

The more complex but better behaved family of base categories are categories of \textbf{jet cubes} $\jetcubefwd \mycubex M {\vec a}$ (\cref{sec:jetcubes}).
While we can get a grasp on jet cubes by characterizing their morphisms using a calculus (\cref{sec:jetcubes:calculus}), this calculus is relatively complex and its soundness and completeness proofs are even more complex.

For these reasons, we alternatively propose to use categories of \textbf{jet topes} $\jettope{\vec a}$ (\cref{sec:jettope}). These are full subcategories of $\jetset{\vec a}$ on objects that satisfy certain somewhat arbitrary well-behavedness criteria.
The main purpose of the categories of jet topes is to be workable for most basic purposes without being as complex as the categories of jet cubes.

Upon a first lecture, readers may choose to omit \cref{sec:jetcubes} on jet cubes.

Finally in \cref{sec:pb}, we introduce a number of operations on anpolarity masks which serve to insert bridge and/or path relations for every degree.
These will be both a technical device and a source of interesting modes in practice. \todoi{This paragraph shouldn't be here.}

%\todoi{I momentarily had some doubt about usability of jet topes, but I think it's okay.
%The calculus and its soundness proof are used mainly for modalities interacting with the interval. But these will not be used intensively in the NatPT paper itself.}

\section{Anpolarity Masks} \label{sec:mask}
In RelDTT, modes were natural numbers (minus one) expressing the number of available relations.
In NatPT, we will specify for each of these relations whether it is directed or not.
\begin{definition}
	\label{def:anpolarity}
	\label{def:anpolarity-order}
	An \textbf{anpolarity}\footnote{`An' is Latin for `whether', as in `Nescio an polare sit,' meaning `I do not know whether it is polar'.} is an element of the set $\Anpolarity := \accol{\ypolar, \npolar}$, where $\ypolar$ stands for polar/directed and $\npolar$ stands for nonpolar/symmetric.
	We equip $\Anpolarity$ with the partial order $\npolar \sqsubseteq \ypolar$, corresponding to the intuition that symmetric relations are a subset of directed (i.e.\ potentially asymmetric) relations.
	
	An \textbf{anpolarity mask} or just \textbf{mask} is a list $\vec a \in \List\,\Anpolarity$ of anpolarities. We write $\lenpol{\vec a}$ for its length, and call the numbers $0, \ldots, \lenpol{\vec a} - 1$ \textbf{degrees}.
	We define $\sqsubseteq$ on masks of equal length pointwise.
	
	Both for anpolarities and for masks of equal length, we denote meets (infima) with $\sqcap$ and joins (suprema) with $\sqcup$.
\end{definition}

\section{Jet Sets} \label{sec:jetset}
\subsection{Definitions} \label{sec:jetset:def}
\begin{definition} \label{def:jetset}
	Let $\vec a$ be a mask. An \textbf{$\vec a$-jet-set} is a set $X$ equipped with $\lenpol{\vec a}$ (proof-irrelevant%
	\footnote{So these relations are functions $X \to X \to \Prop$ where $\Prop$ is a universe of $h$-propositions \cite{hottbook}. In most applications, these relations will be decidable, but we do not require this.}%
	) reflexive relations $\jet_i$ where
	\begin{itemize}
		\item $0 \leq i < \lenpol{\vec a}$ is called the \textbf{degree},
		\item $\jet_i$ is called the \textbf{$i$-jet relation},
		\item its opposite $\tej_i$ is called the \textbf{opposite $i$-jet relation},
	\end{itemize}
	such that
	\begin{itemize}
		\item when $a_i = \npolar$, then $\jet_i$ is symmetric, in which case we will denote it as $\edge_i$ and call it the \textbf{$i$-edge relation} (notwithstanding that we still consider it a special case of a jet relation),
		\item $x \jet_i y$ implies both $x \jet_{i+1} y$ and $x \tej_{i+1} y$ whenever $0 \leq i < i+1 < \lenpol{\vec a}$.
	\end{itemize}
	A \textbf{morphism} of $\vec a$-jet-sets is a function that preserves all the jet and edge relations.
	
	The category of $\vec a$-jet-sets is called $\jetset{\vec a}$.
\end{definition}
\begin{definition} \label{def:full-jetsethom}
	A jet set morphism is called \textbf{full} if it reflects all jet relations.
\end{definition}
\begin{definition} \label{def:jet-surjective}
	A jet set morphism $f : X \to Y$ is called \textbf{jet-surjective} if it is surjective as a function, and moreover for any $\vec y \jet_j \vec y'$ in $Y$, there exist $\vec x \jet_j \vec x'$ in $X$ such that $f(\vec x) = \vec y$ and $f(\vec x') = \vec y'$. 
\end{definition}
\begin{definition} \label{def:transitive-jetset}
	A jet set is called \textbf{transitive} if each of the $i$-jet relations is transitive (i.e. a pre-order and, if $i = \npolar$, an equivalence relation).
\end{definition}
The following proposition will not really be used directly, but is a nice encouragement:
\begin{proposition} \label{thm:jetset-equipment}
	Let $X$ be a transitive $\vec a$-jet-set and $0 \leq i < j < \lenpol{\vec a}$.
	Then the double category whose objects are elements of $X$, morphisms are (unique) proofs of $x \jet_i y$, pro-arrows are (unique) proofs of $x \jet_{j} y$ and squares are elements of the unit type, is a pro-arrow equipment \cite{nlab:proarrow,proarrow1,proarrow2}.
	%\todo{Refer to dedicated section instead.}
\end{proposition}
\begin{proof}
	It is clearly a double category. The existence of companions and conjoints is trivial.
\end{proof}
\begin{definition}
	We define the
	\begin{itemize}
		\item \textbf{$i$-equijet relation} $\equijet_i$ as the symmetric interior of $\jet_i$, i.e.\ $x \equijet_i y$ if and only if $x \jet_i y$ and $x \tej_i y$;
		\item \textbf{$i$-infrajet relation} $\infrajet_i$ as the symmetric closure of $\jet_i$, i.e.\ $x \infrajet_i y$ if and only if $x \jet_i y$ or $x \tej_i y$.
	\end{itemize}
\end{definition}
It is immediately clear that for nonpolar degrees, the jet/edge, equijet and infrajet relations coincide.
In general, we can observe that $x \infrajet_i y$ implies $x \equijet_j y$ for $i < j$.
So for mode $[\ypolar, \ypolar, \npolar]$, we get
\[
\xymatrix{
	& 
	\jet_0
		\ar@{:>}[rd]
	&&& 
	\jet_1 
		\ar@{:>}[rd]
	&&& 
	\jet_2 
		\ar@{<:>}[rd]
	\\
	\equijet_0
		\ar@{:>}[ru]
		\ar@{:>}[rd]
	&&
	\infrajet_0
		\ar@{:>}[r]
	&
	\equijet_1
		\ar@{:>}[ru]
		\ar@{:>}[rd]
	&&
	\infrajet_1
		\ar@{:>}[r]
	&
	\equijet_2
		\ar@{<:>}[ru]
		\ar@{<:>}[rd]
	&
	\edge_2
		\ar@{<:>}[l]
		\ar@{<:>}[u]
		\ar@{<:>}[r]
		\ar@{<:>}[d]
	&
	\infrajet_2.
	\\
	& 
	\tej_0 
		\ar@{:>}[ru]
	&&& 
	\tej_1 
		\ar@{:>}[ru]
	&&& 
	\tej_2 
		\ar@{<:>}[ru]
}
\]

\begin{definition} \label{def:op}
	Let $\vec a$ be a mask, $i < \lenpol{\vec a}$ and $X \in \Obj(\jetset{\vec a})$.
	We define the \textbf{$i$-opposite $\Op_i(X)$ of $X$} as the jet set with the same carrier and relations as $X$ except that the $i$-jet relation is reversed: $x \jet_i^{\Op_i(X)} y$ if and only if $x \tej_i^X y$.
	This defines a functor $\Op_i(X) : \jetset{\vec a} \to \jetset{\vec a}$.
\end{definition}
We have $\Op_i \circ \Op_i = \Id$ and if $a_i = \npolar$ then $\Op_i = \Id$.
\begin{definition}
	\label{def:sym-forget}
	\label{def:anpolarity-order-step}
	Write $\vec a \sqsubset_i \vec b$ if $\lenpol{\vec a} = \lenpol{\vec b}$, $a_j = b_j$ for all $j \neq i$, $a_i = \npolar$ and $b_i = \ypolar$.
	
	If $\vec a \sqsubset_i \vec b$, then we write $\Usym_i : \jetset{\vec a} \to \jetset{\vec b}$ for the forgetful functor which forgets the symmetry of $\jet_i$.
\end{definition}
\begin{proposition} \label{def:sym-free} \label{def:sym-cofree}
	The forgetful functor $\Usym_i$ is part of an adjoint triple $\Fsym_i \dashv \Usym_i \dashv \Csym_i$ where $\Fsym_i$ and $\Csym_i$ take a $\vec b$-jet-set $X$ to a $\vec a$-jet-set of the same carrier with the same $j$-jet relations for $j \neq i$ but where
	\begin{itemize}
		\item $x \edge_i^{\Fsym_i X} y$ if and only if $x \infrajet_i^X y$,
		\item $x \edge_i^{\Csym_i X} y$ if and only if $x \equijet_i^X y$.
	\end{itemize}
	We have $\Fsym_i \circ \Usym_i = \Csym_i \circ \Usym_i = \Id$, so that $\UFsym_i := \Usym_i \circ \Fsym_i$ is an idempotent monad and $\UCsym_i := \Usym_i \circ \Csym_i$ is an idempotent comonad.
\end{proposition}
\begin{definition} \label{def:sym-closure-of-sym}
	We extend the definition of $\UFsym_i$ and $\UCsym_i$ to endofunctors on $\jetset{\vec b}$ where $b_i$ can be \emph{any} anpolarity:
	\begin{itemize}
		\item If $b_i = \ypolar$ then they are defined as above,
		\item If $b_i = \npolar$ then they are defined as the identity functor.
	\end{itemize}
	Either way, they are an idempotent (co)monad and we have $\UFsym_i \dashv \UCsym_i$.
\end{definition}

\subsection{Intervals and Prisms}
\begin{definition} \label{def:interval}
	Let $\vec a$ be a mask and $i < \lenpol{\vec a}$.
	\begin{itemize}
		\item The \textbf{$i$-jet interval} $\rival{\jet_i}$ is defined as the $\vec a$-jet-set with carrier $\accol{0, 1}$ and relations generated by $0 \jet_i 1$.
		\item The \textbf{opposite $i$-jet interval} $\rival{\tej_i}$ is defined as the $\vec a$-jet-set with carrier $\accol{0, 1}$ and relations generated by $0 \tej_i 1$.
		\item The \textbf{$i$-equijet interval} $\rival{\equijet_i}$ is defined as the $\vec a$-jet-set with carrier $\accol{0, 1}$ and relations generated by $0 \equijet_i 1$.
	\end{itemize}
	If $a_i = \npolar$ then $\rival{\jet_i} = \rival{\tej_i} = \rival{\equijet_i} =: \rival{\edge_i}$ is called the \textbf{$i$-edge interval}.
\end{definition}
Note that it would be meaningless to define an $i$-infrajet interval in the same way.

\begin{definition} \label{def:prism}
	Let $\vec a$ be a mask, $i < \lenpol{\vec a}$ and $X \in \Obj(\jetset{\vec a})$.
	We define the \textbf{$i$-twisted-prism $X \multip \rival{\jet_i}$} on $X$ as the $\vec a$-jet-set with
	\begin{itemize}
		\item carrier $X \times \accol{0, 1}$,
		\item jet relations generated by the following requirements:
		\begin{itemize}
			\item $(\loch, 0) : \Op_i(X) \to X \multip \rival{\jet_i}$ is a jet set morphism,
			\item $(\loch, 1) : X \to X \multip \rival{\jet_i}$ is a jet set morphism,
			\item $(x, 0) \jet_i (x, 1)$ for all $x \in X$.
		\end{itemize}
	\end{itemize}
	This defines the \textbf{$i$-twisted-prism functor} $\loch \multip \rival{\jet_i} : \jetset{\vec a} \to \jetset{\vec a}$.
	
	We define the \textbf{opposite $i$-twisted-prism $X \multip \rival{\tej_i}$} on $X$ as the jet set of mask $\vec a$ with
	\begin{itemize}
		\item carrier $X \times \accol{0, 1}$,
		\item jet relations generated by the following requirements:
		\begin{itemize}
			\item $(\loch, 0) : X \to X \multip \rival{\tej_i}$ is a jet set morphism,
			\item $(\loch, 1) : \Op_i(X) \to X \multip \rival{\tej_i}$ is a jet set morphism,
			\item $(x, 0) \tej_i (x, 1)$ for all $x \in X$.
		\end{itemize}
	\end{itemize}
	This defines the \textbf{opposite $i$-twisted-prism functor} $\loch \multip \rival{\jet_i} : \jetset{\vec a} \to \jetset{\vec a}$.
	
	If $a_i = \npolar$, then we call this simply the \textbf{$i$-prism functor $\loch \multip \rival{\edge_i}$.}
\end{definition}
Note that in both instances, we take the opposite at the source-side of the jet interval by which we multiply. This makes it unclear what a prism functor for the equijet interval $\rival{\equijet_i}$ should look like.
%\todoi{Should there be a prism functor for $\rival{\equijet_i}$? It would only be well-defined on symmetric jet sets, the category of which is $\jetset{\vec a'}$ where $a'_i = \npolar$, so it is derived from $\loch \multip \rival{\edge_i}$ and the forgetful functor $U^\npolar_i$.}
\begin{corollary} \label{thm:twisted-prism-op}
	We have $\loch \multip \rival{\tej_i} = \Op_i(\loch \multip \rival{\jet_i})$. \qed
\end{corollary}
\begin{corollary} \label{thm:commute-diff-degree}
	Let $F_i$ be a functor between jet set categories of any of the following forms: $\Op_i$, $\Fsym_i$, $\Usym_i$, $\Csym_i$, $\loch \multip \rival{\jet_i}$, $\loch \multip \rival{\tej_i}$, $\loch \multip \rival{\edge_i}$.
	Let $G_j$ be a functor between jet set categories also of one of these forms, but for a different degree $j$.
	Then $F_i$ and $G_j$ commute, i.e.\ there is a natural isomorphism $F_i G_j \cong G_j F_i$.
\end{corollary}
\begin{corollary} \label{thm:commute-symmetric}
The functor $\loch \multip \rival{\edge_i}$ commutes with itself, i.e. $(x, v, w) \mapsto (x, w, v)$ is a natural automorphism of $\loch \multip \rival{\edge_i} \multip \rival{\edge_i}$. \qed
\end{corollary}

\section{Jet Topes} \label{sec:jettope}
\begin{definition}
	\label{def:jet-connected}
	\label{def:jet-sublinear}
	In a jet set $X$, write $\jet_i^*$ for the transitive closure of the $\jet_i$, and similarly $\infrajet_i^*$ for the transitive closure of $\infrajet_i$.
	\begin{itemize}
		\item We say that $x$ and $y$ are \textbf{$i$-connected} if $x \infrajet_i^* y$, and correspondingly define \textbf{$i$-connected components}.
		We say that $X$ is \textbf{$i$-connected} if any two elements are $i$-connected.
		\item We say that $X$ is \textbf{$i$-orientable} if on any $i$-connected component, the relation $\jetsym_i^*$ is a total pre-order, i.e.\ if $x \infrajet_i^* y$ implies either $x \jet_i^* y$ or $x \tej_i^* y$.
		\item We say that $X$ is \textbf{$i$-acyclic} if $x \jet_i^* y$ and $x \tej_i^* y$ together imply $x \equijet_i^* y$.
		\item We say that $X$ is \textbf{$i$-antisymmetric} if $x \equijet_i y$ implies $x \infrajet_{i-1} y$ for $i > 0$, or $x = y$ for $i = 0$.
	\end{itemize}
\end{definition}
Note that $i$-orientability and $i$-acyclicity are vacuous at symmetric degrees $i$.
On the other hand, $i$-antisymmetry at a symmetric degree $i$ would completely define the $i$-edge relation.
%\begin{definition} 
%	A jet set is called \textbf{$i$-orientable} if the $i$-jet relation has no cycles, i.e. sequences
%	\[
%		x_0 \jet_i x_1 \jet_i \cdots \jet_i x_n = x_0
%	\]
%	with $n \geq 2$.
%\end{definition}
\begin{definition} \label{def:jet-tope}
	Let $\vec a$ be a mask of length $n$.
	An $\vec a$-jet-set $X$ is a \textbf{jet tope} if it is:
	\begin{enumerate}
		\item finite,
		\item $(n-1)$-connected if $n > 0$, or a subsingleton if $n = 0$,
		\item $i$-orientable for every degree $i$,
		\item $i$-acyclic for every degree $i$,
		\item $i$-antisymmetric for every \emph{directed} degree $i$.
		%\item for every $0 \leq i < n$, the relation $\jet_i^*$ is a total pre-order on any connected component of $X$, i.e. if $x \infrajet_i^* y$, then $x \jet_i^* y$ or $x \tej_i^* y$. We call this property \textbf{$i$-orientability}.
	\end{enumerate}
	The \textbf{category of jet topes} $\jettope{\vec a}$ is defined as the full subcategory of $\jetset{\vec a}$ on jet topes.
\end{definition}
The conceptual reason for asking $i$-antisymmetry is to exclude the equijet interval $\rival{\equijetsym_i}$, so that the only jet tope intervals at directed degrees are $\rival{\jetsym_i}$ and $\rival{\tejsym_i}$.
Having an $i$-equijet interval object in the base category, will cause presheaves to contain `formal' $i$-equijets as an additional symmetric relation, stricter than the $i$-jet relation, which we wish to avoid.
\begin{proposition} \label{thm:lift-to-jet-topes}
	Jet topes are closed under the functors $\Op_i$, $\Fsym_i$,
	%$\Usym_i$, $\Csym_{i \neq n-1}$, $\UFsym_i$, $\UCsym_{i \neq n-1}$,
	$\loch \multip \rival{\jet_i}$ and $\loch \multip \rival{\tej_i}$.
\end{proposition}
\begin{proof}
	Clearly, each of these functors preserves finiteness.
	
	Moreover, by existence of $0 \leq i < n$, we conclude that $n > 0$, so our jet tope needs to be $(n-1)$-connected rather than a subsingleton.
	
	We prove the other properties in the definition of a jet tope:
	\begin{description}
		\item[\framebox{$\Op_i$}] Trivial.
		\item[\framebox{$\Fsym_i$}] This functor (defined in \cref{def:sym-free}) clearly preserves $(n-1)$-connectedness even if $i = n-1$.
		Meanwhile, $j$-orientability and $j$-antisymmetry are unaffected for $j \neq i$ and not required for $j = i$.
		In the case of $i$-antisymmetry, we use that $\infrajetsym_{i-1}$ and equality (if $i = 0$) remain unchanged.
%		\item[$\Usym_i$] This functor does not modify the jet set, so the conditions are preserved.
%		\item[$\Csym_{i \neq n-1}$] Since $i \neq n-1$, this functor preserves $(n-1)$-connectedness. Meanwhile, $j$-acyclicity is unaffected for $j \neq i$ and vacuous for $i$ which is symmetric in the codomain of $\Csym_i$.
%		\item[$\UFsym_i$] Since $\UFsym_i = \Usym_i \circ \Fsym_i$.
%		\item[$\UCsym_{i \neq n-1}$] Since $\UCsym_i = \Usym_i \circ \Csym_i$.
		\item[\framebox{$\loch \multip \rival{\jet_i}$}] To see $(n-1)$-connectedness, note that:
		\begin{itemize}
			\item All objects of the form $(x, 0)$ are $(n-1)$-connected,
			\item All objects of the form $(x, 1)$ are $(n-1)$-connected,
			\item Since $i \leq n-1$, we always have $(x, 0) \infrajet_{n-1} (x, 1)$.
		\end{itemize}
		Assume $a_j = \ypolar$. For $j$-orientability, $j$-acyclicity and $j$-antisymmetry, we consider 3 situations:
		\begin{description}
			\item[$j < i$] Then for every $x$, we have $(x, 0) \not\infrajet_j (x, 1)$. Every $j$-connected component $C \subseteq X$ produces two $j$-connected components $\set{(c, 0)}{c \in C}$ and $\set{(c, 1)}{c \in C}$, where $j$-orientability, $j$-acyclicity and $j$-antisymmetry are inherited from $X$.
			\item[$j > i$] Then for every $x$, we have $(x, 0) \equijet_j (x, 1)$. Every $j$-connected component $C \subseteq X$ produces one $j$-connected component $\set{(c, u)}{c \in C, u \in \accol{0, 1}}$, where totality of $\jet_j^*$ is inherited from $X$.
			
			For $j$-acyclicity, note that $(x, u) \jet_j^* (y, v) \Leftrightarrow x \jet_j^* y$ and $(x, u) \equijet_j^* (y, v) \Leftrightarrow x \equijet_j^* y$. Thus, $j$-acyclicity is also inherited from $X$.
			
			For $j$-antisymmetry, note that $(x, u) \equijet_j (y, v)$ means that either $x \equijet_j y$ and $u = v$ or that $x = y$ and $u \neq v$.
			In the former case, we get $x \infrajet_{j-1} y$ and hence $(x, u) \infrajet_{j-1} (y, v)$.
			In the latter case, since $j-1 \geq i$, we get $(x, 0) \jet_{j-1} (x, 1)$, so that $(x, u) \infrajet_{j-1} (y, v)$.
			\item[$j = i$] Then $(x, u) \infrajet_i^* (y, v)$ if and only if $x \infrajet_i^* y$.
			By $i$-orientability of the original jet tope $X$, we have $x \jet_i^* y$ or $x \tej_i^* y$. Say we have $x \jet_i^* y$.
			Then we have $(y, 0) \jet_i^* (x, 0) \jet_i (x, 1) \jet_i^* (y, 1)$, and thus either $(x, u) \jet_i^* (y, v)$ or $(x, u) \tej_i^* (y, v)$ depending on $u$ and $v$.
			
			For $i$-acyclicity, note that if $(x, u) \jet_i^* (y, v)$ and $(x, u) \tej_i^* (y, v)$, then $u = v$, so this is inherited from $i$-acyclicity of $X$.
			
			For $i$-antisymmetry, $(x, u) \equijet_i (y, v)$ implies $u = v$, so this is also inherited from $i$-antisymme\-try of $X$.
		\end{description}
		\item[\framebox{$\loch \multip \rival{\tej_i}$}] By an analogous argument. \qedhere
	\end{description}
\end{proof}

\section{Jet Cubes} \label{sec:jetcubes}
In \cref{sec:cubes}, we define a family of \emph{cube} categories $\cubecat_M^\mycubex$ parametrized by a monad $M$ which defines the available operations on cube dimensions, and a choice $\mycubex \in \accol{\affine, \cartes}$ of whether we want our cubes to be affine (no diagonals) or cartesian.

In \cref{sec:jetcubes:def}, we define a family of \emph{jet cube} categories $\jetcube{\myorix}{\mycubex}{M}{\vec a}$ furthermore parametrized by a mask $\vec a$ and an orientation kit $\myorix$, which determines whether jets can only be forward or also backward and/or bidirectional.

In \cref{sec:jetcubes:calculus}, we characterize morphisms in certain jet cube categories using a calculus.

In \cref{sec:jetcubes:sss}, we shed light on jet cubes from a different corner by introducing the \emph{semisymmetric separated product}.

In \cref{sec:jetcubes:comparison} we compare our general class of jet cube categories to existing cube categories in the literature.

\subsection{Cube Categories} \label{sec:cubes}
We introduce a family of cube categories with one flavour of dimension. Fix a monad $M$ on $\Set$.
\begin{example} \label{ex:cube-monads}
	Typically $M$ will be one of the following:
	\begin{itemize}
		\item The `exception' monad $\bipointed$ that sends a set $X$ to $X \uplus \accol{0,1}$, which is the carrier of the free bipointed set over $X$;
		\item The monad $\bipointedsym$ that sends a set $X$ to $X \uplus \set{\lnot x}{x \in X} \uplus \accol{0, 1}$, which is the carrier of the free [bipointed set equipped with an involution $\lnot$ that swaps $0$ and $1$] over $X$;
		\item The monad $\distlattice$ that sends a set $X$ to the carrier of the free distributive lattice over $X$;
		\item The monad $\demorgan$ that sends a set $X$ to the carrier of the free De Morgan algebra over $X$;
		\item The monad $\booleanalg$ that sends a set $X$ to the carrier of the free boolean algebra over $X$.
	\end{itemize}
\end{example}

\subsubsection{Cartesian Cubes}
\begin{definition} \label{def:cube}
	We construct the \textbf{(named) category of cartesian $M$-cubes} $\cubecat^\cartes_M$ (and $\namedcubecat^\cartes_M$ resp.) stepwise:
	\begin{itemize}
		\item The Kleisli category $\Kleisli(M)$ of $M$ has objects $\inKleisli{X}$ where $X$ is a set, and its morphisms $\inKleisli f : \inKleisli X \to \inKleisli Y$ are functions $f : X \to MY$.
		\item Of this, we take the opposite $\Kleisli(M)\op$. (This is the Lawvere theory corresponding to the monad $M$.)
		\item We define $\namedcubecat^\cartes_M$ as the full subcategory of $\Kleisli(M)\op$ on finite sets. (Alternatively, this is the opposite Kleisli category of the restriction of $M$ to finite sets, either as a monad on $\FinSet$ or as a relative monad $\FinSet \to \Set$.)
		\item We define $\cubecat^\cartes_M$ as a designate skeleton of $\namedcubecat_M$, e.g.\ the full subcategory of $\namedcubecat^\cartes_M$ on sets of the form $\accol{0, \ldots, n-1}$ with $n \geq 0$.
	\end{itemize}
\end{definition}
Objects of $\namedcubecat^\cartes_M$ will be denoted as tuples of names $(\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX)$ where $\IX$ is meaningless but conveys the intuition that we regard $\dm{i}_k$ as a value ranging over the interval (the cube given by the singleton object).
A morphism $\vfi : (\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX) \to (\dm{j}_0 : \IX, \ldots, \dm{j}_{m-1} : \IX)$ is then a function sending each $\dm{j}_k$ to an expression $\dm{j}_k \psub{\vfi} \in M\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}$.
The morphism $\vfi$ will also be denoted as $(\dm{j}_0 \psub \vfi / \dm{j}_0, \ldots, \dm{j}_{m-1} \psub \vfi / \dm{j}_{m-1})$.
The situation in $\cubecat^\cartes_M$ is the same except that we now regard the names $\dm{i}_k$ as De Bruijn indices.

\begin{corollary}
The categories $\cubecat^\cartes_M$ and $\namedcubecat^\cartes_M$ have finite products, given by finite coproducts of sets. \qed
\end{corollary}

\subsubsection{Affine Cubes}
If $T$ is a \emph{container} monad \cite{container-combinatorics}, i.e. a monad whose underlying functor is a container functor \cite{containers} of the form $TX = \Sigma(s : S).(P(s) \to X)$, then we define $T^\# X$ as the set of \emph{affine} expressions $\Sigma(s : S).(P(s) \hookrightarrow X)$, which is an endofunctor on the category $\Set^{\hookrightarrow}$ of sets and injective functions.
If $M$ is merely a \emph{quotient} of a container monad, i.e. $M$ is of the form $MX = TX/\sim_X$ with $T$ as above, then we define $M^\# X$ as the set of equivalence classes with an affine representant.

\begin{remark}
An important source of monads such as $M$ are monads specified by a syntactic algebraic theory \cite{manes-book,adamek-book,keml-diagrams}.
A syntactic algebraic theory specifies a set of operations $S_0$, assigns to each operation $s : S_0$ an arity $P_0(s)$ which is again a set, and subjects these to a set of axioms.%
\footnote{We use `syntactic algebraic theory' to refer to the syntactic presentation as described here, and `monad' and `Lawvere theory' to refer to the less syntactic objects they specify.
%There seems to be disagreement on the terminology.
%Syntactic algebraic theories (a.k.a. presentations of algebraic theories \cite{manes-book,keml-diagrams}) give rise to a monad and a Lawvere category (a.k.a. Lawvere theory or algebraic theory \cite{manes-book}).
%Depending on your definition of a Lawvere theory, the monadic presentation and the Lawvere theory may be interderivable; in turn, they give rise to a category of algebras.
%Neither of these two steps reflects equivalence, so we truly have three different notions, and there is disagreement which one the term `algebraic theory' refers to \cite{adamek-book}.
%
%Different syntactic algebraic theories may have the same category of models, in which case they are called \emph{Morita equivalent} \cite[ch.\ 15]{adamek-book}. We can thus distinguish algebraic theories by their syntactic presentation or consider them up to Morita equivalence. We will use \emph{syntactic algebraic theory} in the former case and \emph{monadic/Lawverian algebraic theory} in the latter case. Some authors insist on the usage of the word `presentation' for the former case \cite{manes-book}, or call the latter case `algebraic categories' \cite{adamek-book}, while the term `algebraic theories' seems to be in use for either case.
}
The container $(S_0, P_0)$ specifies a container functor $FX = \Sigma(s : S_0).(P_0(s) \to X)$ on $\Set$.
A free monad $F^*$ over this functor $F$ exists and satisfies the fixpoint equation $F^* X \cong X \uplus F F^* X$.
We remark that the free monad $F^*$ over a container functor $F$ is again a container functor, i.e.\ there exists a container $(S, P)$ such that
$F^* X = \Sigma(s : S).(P(s) \to X)$
specifies the free monad over $F$.
The axioms determine an equivalence relation $\sim_X$ on $F^* X$ such that $M X := F^* X/\sim_X$ is again a monad.
This situation applies to each of the monads in \cref{ex:cube-monads}.

In fact, often the quotient can be taken already at the level of the container, so that there exists a container $(S', P')$ such that $MX \cong \Sigma(s : S').(P'(s) \to X)$.
\end{remark}

We say that $(s, f), (s', f') \in T^\# X$ are \textbf{mutually fresh}, denoted $(s, f) \freshbin (s', f')$, if the images of $f$ and $f'$ are disjoint.
Elements of $M^\# X$ are mutually fresh if they have mutually fresh representants.
We call the monad $(T, \eta, \mu)$ \textbf{affine} if $\eta_X : X \to TX$ lands in $T^\# X$ for all $X$ and $\mu_X : TTX \to TX$ restricted to $(TT)^\# X$ (note that container functors are closed under composition) lands in $T^\# X$; and similar for $M$.

\begin{definition}
Let $M$ be a quotient of a container monad, and let it be affine.
We construct the \textbf{(named) category of affine $M$-cubes $\cubecat_M^\affine$} (and $\namedcubecat_M^\affine$ resp.) stepwise:
\begin{itemize}
	\item The affine Kleisli category $\Kleisli^\#(M)$ has objects $\inKleisli{X}$ where $X$ is a set, and its morphisms $\inKleisli f : \inKleisli X \to \inKleisli Y$ are functions $f : X \to M^\#Y$ such that for any $x \neq x'$ in $X$, we have $f(x) \freshbin f(x')$.
	Identity and composition are well-defined because $M$ is affine.
	\item Of this, we take the opposite $\Kleisli^\#(M)\op$.
	\item We define $\namedcubecat_M^\affine$ as the full subcategory of $\Kleisli^\#(M)\op$ on finite sets.
	\item We define $\cubecat_M^\affine$ as a designate skeleton of $\namedcubecat^\affine_M$, e.g.\ the full subcategory of $\namedcubecat^\affine_M$ on sets of the form $\accol{0, \ldots, n-1}$ with $n \geq 0$.
\end{itemize}
\end{definition}
Objects will be represented as for the cartesian cube categories.

\begin{corollary}
The categories $\cubecat^\affine_M$ and $\namedcubecat^\affine_M$ have a symmetric monoidal structure $(\top, {*})$ given by finite coproducts of sets. The binary operation is called the \textbf{separated product}. \qed
\end{corollary}

\subsubsection{Examples}
This way, we get -- among others -- the following cube categories:
\begin{enumerate}
	\item[$\cubecat^\cartes_{\bipointed}$] The cartesian cube category.
	A morphism $\vfi : V \to W$ sends every dimension $\dm{j} \in W$ to $\dm{j} \psub \vfi \in V \cup \accol{0, 1}$.
	Its cubes have diagonals.
	\item[$\cubecat^\affine_{\bipointed}$] The affine cube category \cite{bch}.
	A morphism $\vfi : V \to W$ sends every dimension $\dm{j} \in W$ to $\dm{j} \psub \vfi \in V \cup \accol{0, 1}$, such that if $\dm{j}\psub \vfi = \dm{j}' \psub \vfi \in V$ then $\dm{j} = \dm{j}'$.
	Its cubes have no diagonals.
	\item[$\cubecat^\cartes_{\bipointedsym}$] The symmetric cartesian cube category. We have a negation/involution/symmetry $(\lnot \dm{i} / \dm{j}) : (\dm i : \IX) \to (\dm{j} : \IX)$.
	\item[$\cubecat^\cartes_{\distlattice}$] The cartesian cube category with connections. We have morphisms $(\dm i \vee \dm{j} / \dm k), (\dm i \wedge \dm{j} / \dm k) : (\dm i : \IX, \dm{j} : \IX) \to (\dm k : \IX)$. There are no symmetries
	\item[$\cubecat^\cartes_{\demorgan}$] The CCHM cube category \cite{cubical}, which combines symmetries and connections. We have $(\dm i \wedge \lnot \dm i / \dm j) \neq (0/\dm j) : (\dm i : \IX) \to (\dm j : \IX)$ and $(\dm i \vee \lnot \dm i / \dm j) \neq (1/\dm j) : (\dm i : \IX) \to (\dm j : \IX)$.
	\item[$\cubecat^\cartes_{\booleanalg}$] A cube category very similar to the CCHM one, but we have $(\dm i \wedge \lnot \dm i / \dm j) = (0/\dm j) : (\dm i : \IX) \to (\dm j : \IX)$ and $(\dm i \vee \lnot \dm i / \dm j) = (1/\dm j) : (\dm i : \IX) \to (\dm j : \IX)$.
\end{enumerate}
We remark that $\cubecat^\affine_{\demorgan}$ and $\cubecat^\affine_{\booleanalg}$ should be isomorphic as the additional law of boolean algebras w.r.t.\ de Morgan algebras only affects non-affine expressions.

\subsubsection{The Endpoint Model}
We remarked above that $\catL := \Kleisli(M)\op$ is the Lawvere category of $M$.
It is known then (see e.g.\ \cite{keml-diagrams}), that the Eilenberg-Moore category of $M$ (which is the category of Eilenberg-Moore algebras of $M$) is equivalent category of models of $\catL$ (which is the category of product-preserving functors $\catL \to \Set$).
Such functors are fully determined by the image of the singleton set (as every set is a coproduct of singletons and the Kleisli-category retains coproducts) and that image will be exactly the carrier of the corresponding Eilenberg-Moore algebra.

It is clear that both the cartesian and affine (named) cube categories are subcategories of $\catL$.
As such, any $M$-algebra induces a functor $\catL \to \Set$ and hence a functor from either of the $M$-cube categories to $\Set$.

The initial algebra of any monad $M$ on $\Set$ has carrier $M \eset$, which for each of the monads in \cref{ex:cube-monads} equals $\accol{0, 1}$.
Correspondingly, the initial model of $\catL$ is the functor $\EP : \catL \to \Set$ sending $(\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX)$ to $\accol{0, 1}^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}}$.
We call this the \textbf{endpoint model}.
It is naturally isomorphic (in fact equal) to $\Hom_\catL((), \loch) : \catL \to \Set$, since we have
\small \[
	\Hom_\catL((), (\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX))
	= \Hom_{\Kleisli(M)}(\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}, \eset)
	= (M\eset)^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}}
	= \accol{0, 1}^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}}.
\] \normalsize

%We are interested, in particular, in $M$-algebra structures on the set of endpoints $\accol{0, 1}$.
%Each of the monads in \cref{ex:cube-monads} has an obvious such algebra structure.
%Thus, we get functors from each of the corresponding cube categories to $\Set$,
%sending $(\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX)$ to $\accol{0, 1}^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}}$.
%We will denote each of those functors as $\EP$.

Recall that a morphism $\vfi : (\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX) \to (\dm{j}_0 : \IX, \ldots, \dm{j}_{m-1} : \IX)$ assigns to each $\dm j$ a value $\dm j\psub \vfi$ in $M \accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}$, the free $M$-algebra over $\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}$.
The function $\EP(\vfi)$ is defined by
\[
	\EP(\vfi)
	\paren{ v^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}} \to \accol{0, 1}} }
	(\dm j)
	= \alpha\paren{ M(v)(\dm j \psub \vfi) },
\]
where $\alpha : M\accol{0, 1} \to \accol{0, 1}$ is the algebra structure on $\accol{0, 1}$.
Using the operation $\bindop^\alpha : MX \to (X \to \accol{0, 1}) \to \accol{0, 1} : \hat x \mapsto f \mapsto \alpha (Mf(\hat x))$, we can write this as $\EP(\vfi)(v)(\dm j) = \dm j \psub \vfi \bindop^\alpha v$.

\begin{proposition} \label{thm:booleanalg-ff}
	The functor $\EP : \cubecat^\cartes_\booleanalg \to \Set$ is fully faithful.
\end{proposition}
\begin{proof}
	We need to show that any function $f : \accol{0, 1}^{\accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}} \to \accol{0, 1}^{\accol{\dm{j}_0, \ldots, \dm{j}_{m-1}}}$
	can be obtained as some $\EP(\vfi)$ with $\vfi : (\dm{i}_0 : \IX, \ldots, \dm{i}_{n-1} : \IX) \to (\dm{j}_0 : \IX, \ldots, \dm{j}_{m-1} : \IX)$.
	We remark that such a function $f$ in fact consists of $m$ truth tables in $n$ boolean variables.
	From the full disjunctive normal form, it is clear that elements of the free boolean algebra are in 1-1 correspondence with truth tables.
	Concretely, for each $\dm j$, define $\dm j \psub \vfi$ to be the element of $\booleanalg \accol{\dm{i}_0, \ldots, \dm{i}_{n-1}}$ corresponding to the truth table $f(\loch, \dm j)$.
	Then $\dm j \psub \vfi \bindop^\alpha v$ will evaluate $\dm j \psub \vfi$ after replacing each variable $\dm i$ with its value $v(\dm i)$, yielding the value $f(v, \dm j)$ prescribed by the truth table $f(\loch, \dm j)$.
\end{proof}
\begin{proposition} \label{thm:monad-coercions-faithful}
	The obvious functor $I : \cubecat_M^\mycubey \to \cubecat_N^\mycubex$ where
	\begin{itemize}
		\item $\mycubey, \mycubex \in \accol{\affine, \cartes}$ and $\mycubey \leq \mycubex$ according to the order $\affine \leq \cartes$,
		\item $M, N \in \accol{\bipointed, \bipointedsym, \distlattice, \booleanalg}$ and $M \leq N$ according to the partial order
		\[
			\xymatrix{
				\bipointed
					\ar[r]^\leq
					\ar[d]_{\rotatebox{270}{$\scriptstyle\leq$}}
				& \bipointedsym
					\ar[d]_{\rotatebox{270}{$\scriptstyle\leq$}}
					\ar@/^/[ddr]^{\rotatebox{270}{$\scriptstyle\leq$}}
				\\
				\distlattice
					\ar[r]^\leq
					\ar@/_/[rrd]_\leq
				& \demorgan
				\\
				&& \booleanalg,
			}
		\]
		is faithful.
	\end{itemize}
\end{proposition}
\begin{proof}
	In a first step, it is obvious by construction that $\cubecat^\affine_M \to \cubecat^\cartes_M$ is faithful.
	
	In a second step, note that we have a monad morphism $\iota : M \to N$ such that $\iota_X : M(X) \to N(X)$ is injective for all $X$. Then the resulting functor between the Kleisli categories, which are opposite to the cartesian cube categories, is faithful.
\end{proof}
Clearly, the functor $I : \cubecat_\demorgan^\cartes \to \cubecat_\booleanalg^\cartes$ is not faithful: it sends the morphisms $(0/\dm j), (\dm i \wedge \lnot \dm i/\dm j) : (\dm i : \IX) \to (\dm j : \IX)$ in $\cubecat_\demorgan^\cartes$ to the same morphism in $\cubecat_\booleanalg^\cartes$.
\begin{corollary} \label{thm:monads-faithful}
	The functor $\EP : \cubecat^\mycubex_M \to \Set$ is faithful for each $M \in \accol{\bipointed, \bipointedsym, \distlattice, \booleanalg}$.
\end{corollary}
\begin{proof}
	Follows by composing \cref{thm:booleanalg-ff} and \cref{thm:monad-coercions-faithful}.
\end{proof}

\subsection{Jet Cubes} \label{sec:jetcubes:def}

\subsubsection{Jet Cube Objects}
\begin{definition} \label{def:orientation-kit}
	An \textbf{orientation kit} is one of the following sets of formal symbols:\footnote{The letters stand for \emph{forward}, \emph{backward} and \emph{equijet}.}
	\[
		\orif = \accol{{\jet}}, \qquad
		\orife = \accol{{\jet}, {\equijet}}, \qquad
		\orifb = \accol{{\jet}, {\tej}}, \qquad
		\orifbe = \accol{{\jet}, {\tej}, {\equijet}}.
	\]
	The set of orientation kits will be denoted $\orikit = \accol{\orif, \orife, \orifb, \orifbe}$.
\end{definition}
\begin{definition} \label{def:jet-cube}
	Let $\vec a$ be a mask and $\myorix$ an orientation kit.
	We define the set of \textbf{$(\myorix, \vec{a})$-jet-cubes} as the set of lists of elements of $\set{P_i}{P \in \myorix, 0 \leq i < \lenpol{\vec a}}$,
	where we identify all $P_i = Q_i =: {\edge}_i$ ($P, Q \in \myorix$) if $a_i = \npolar$.
	We denote jet cubes as
	$(\dm i_0 : \rival{(P_0)_{i_0}}, \ldots, \dm i_{n-1} : \rival{(P_{n-1})_{i_{n-1}}})$,
	thinking of the names $\dm{i}_k$ as De Bruijn indices.
	
%	degrees $0 \leq i < \lenpol{\vec a}$, but we denote them as
%	$(\dm i_0 : \rival{\jet_{i_0}}, \ldots, \dm i_{n-1} : \rival{\jet_{i_{n-1}}})$, thinking of the names $\dm{i}_k$ as De Bruijn indices.
%	If $a_i = \npolar$, we write $\rival{\edge_i}$ instead of $\rival{\jet_i}$.
%	
%%	More generally, we define the set of \textbf{trioriented jet cubes of mask $\vec a$} as the set of lists of elements of $\set{\jet_i, \tej_i}{a_i = \ypolar} \cup \set{\edge_i}{a_i = \npolar}$, but we denote them as
%%	$(\dm i_0 : \rival{\jet_{i_0}}, \ldots, \dm i_{n-1} : \rival{\tej_{i_{n-1}}})$.
%%	If $a_i = \npolar$, we use the symbols $\rival{\jet_i}$, $\rival{\tej_i}$ and $\rival{\edge_i}$ interchangeably.
%	
%	More generally, we define the set of \textbf{trioriented $\vec a$-jet-cubes} as the set of lists of elements of \allowbreak $\set{\jet_i, \tej_i, \equijet_i}{0 \leq i < \lenpol{\vec a}}$, where we identify ${\jet_i} = {\tej_i} = {\equijet_i} =: {\edge_i}$ if $a_i = \npolar$, and where $\jet_i$ and $\tej_i$ cannot occur to the left of $\equijet_i$ if $a_i = \ypolar$.
%	We denote them e.g.\ as $(\dm i_0 : \rival{\jet_{i_0}}, \ldots, \dm i_{n-1} : \rival{\tej_{i_{n-1}}})$.
\end{definition}
\begin{definition} \label{def:symmetric-var}
	We call a variable $\dm i$ of an $(\myorix, \vec a)$-jet-cube \textbf{$i$-symmetric} (for a degree $0 \leq i < \lenpol{\vec a}$) if \emph{any} of the following conditions holds:
	\begin{itemize}
		\item $\dm i$ is not of degree $i$,
		\item $\dm i$ is an equijet variable, i.e.\ $\dm i : \rival{\equijet_j}$,
		\item $a_i = \npolar$.
	\end{itemize}
	Otherwise, it is called \textbf{$i$-directed}.
	Thus, if $\dm i$ is $i$-directed, then $a_i = \ypolar$ and $\dm i : \rival{\jet_i}$ or $\dm i : \rival{\tej_i}$.
\end{definition}
\begin{definition} \label{def:sym-forget-cube}
	Let $\vec a \sqsubset_i \vec b$ and ${\equijet} \in \myorix$. For any $(\myorix, \vec a)$-jet-cube $W$, we define the $(\myorix, \vec b)$-jet-cube $\Usymcube_i W$ by replacing every occurrence of $\edge_i$ with $\equijet_i$.
\end{definition}
Note that a $\vec b$-jet-cube is uniquely in the image of $\Usymcube_i$ if it does not feature the symbols $\jet_i$ and $\tej_i$, i.e.\ if all variables are $i$-symmetric.
\begin{definition} \label{def:jep}
	For any $(\myorix, \vec a)$-jet-cube $W$, we define the $\vec a$-jet-set $\JEP(W)$ as follows:
	\[ \begin{array}{l c l l}
		\JEP(()) &=& \top, \\
		\JEP(W, \dm i : \rival{\jet_i}) &=& \JEP(W) \multip \rival{\jet_i}, \\
		\JEP(W, \dm i : \rival{\tej_i}) &=& \JEP(W) \multip \rival{\tej_i}, \\
		\JEP(W, \dm i : \rival{\edge_i}) &=& \JEP(W) \multip \rival{\edge_i}, \\
		\JEP(W, \dm i : \rival{\equijet_i}) &=& \Usym_i \, \JEP\paren{(\Usymcube_i)\inv(W, \dm i : \rival{\equijet_i})}
		& \text{if $a_i = \ypolar$} \\
		&=& \Usym_i \, \JEP\paren{(\Usymcube_i)\inv(W), \dm i : \rival{\edge_i}} \\
		&=& \Usym_i\paren{\JEP\paren{(\Usymcube_i)\inv(W)} \multip \rival{\edge_i}}.
	\end{array} \]
	Setting $V = (\Usymcube_i)\inv(W)$, the last equation can be rephrased as
	\[ \begin{array}{l c l l}
		\JEP(\Usymcube_i V, \dm i : \rival{\equijet_i})
		= \JEP(\Usymcube_i(V, \dm i : \rival{\edge_i}))
		&=& \Usym_i(\JEP(V, \dm i : \rival{\edge_i})) \\
		&=& \Usym_i(\JEP(V) \multip \rival{\edge_i}).
	\end{array} \]
\end{definition}
\begin{definition} \label{def:jet-cube-erasure}
	We define the \textbf{jet-erasure function} $\erasejc{\loch}$, which sends $(\myorix, \vec a)$-jet-cubes to cubes (i.e. objects of any of the cube categories defined in \cref{sec:cubes}), by
	\[
		\erasejc{()} = (),
		\qquad
		\erasejc{(W, \dm i : \rival{\jet_i})} =
		\erasejc{(W, \dm i : \rival{\tej_i})} =
		\erasejc{(W, \dm i : \rival{\equijet_i})} =
		\erasejc{(W, \dm i : \rival{\edge_i})} =
		(\erasejc{W}, i : \IX).
	\]
\end{definition}
\begin{corollary} \label{thm:jet-cube-pullback}
	For any $(\myorix, \vec a)$-jet-cube $W$, the carrier of $\JEP(W)$ is $\EP(\erasejc{W})$.
	Thus, every jet cube determines an object of the following strict pullback of categories:
	\[
			\xymatrix{
				\accol{\text{$(\myorix, \vec a)$-jet-cubes}}
					\ar@/^/[rrrd]^{\JEP}
					\ar@/_/[rdd]_{\erasejc{\loch}}
					\ar@{.>}[rd]
				\\
				&
				\cubecat^\mycubex_M \times_\Set \jetset{\vec a}
					\ar@{.>}[rr]
					\ar@{.>}[d]
					\xydrcorner
				&&
				\jetset{\vec a}
					\ar[d]^U
				\\
				&
				\cubecat^\mycubex_M
					\ar[rr]_{\EP}
				&&
				\Set,
			}
	\]
	It is straightforward to see that the function thus obtained is injective. \qed
\end{corollary}

\subsubsection{Jet Cube Categories}
\begin{definition} \label{def:jet-cube-cat}
	Let $\vec a$ be a mask, $\myorix \in \orikit$, $\mycubex \in \accol{\affine, \cartes}$ and $M$ a monad on $\Set$.
	We define
	the category $\jetcube{\myorix}{\mycubex}{M}{\vec a}$ of \textbf{$(\myorix, \vec a)$-jet-$M$-cubes}
	as the full subcategory of $\cubecat^\mycubex_M \times_\Set \jetset{\vec a}$ on $(\myorix, \vec a)$-jet-cubes, as justified by \cref{thm:jet-cube-pullback}.
	The functions $\JEP$ and $\erasejc{\loch}$ are correspondingly extended to functors.
\end{definition}
\begin{corollary} \label{thm:jet-cubes-are-topes}
	For $\myorix \in \accol{\orif, \orifb}$, the functor $\JEP : \jetcube{\myorix}{\mycubex}{M}{\vec a} \to \jetset{\vec a}$ factors over the inclusion $\jettope{\vec a} \hookrightarrow \jetset{\vec a}$.
\end{corollary}
\begin{proof}
	By induction on the dimension and using \cref{thm:lift-to-jet-topes}, it is clear that for any jet cube $W$, the jet set $\JEP(W)$ is a jet tope, which factors the action on objects. The action on morphisms factors because $\jettope{\vec a}$ is a full subcategory of $\jetset{\vec a}$.
\end{proof}
We will ultimately only be interested in $(\orif, \vec a)$-jet-cubes, but in \cref{sec:jetcubes:calculus}, we define an inductive predicate to determine whether a cube morphism $\vfi : \erasejc V \to \erasejc W$ is in fact a jet cube morphism $V \to W$, and this predicate's inference rules make use of $(\orifbe, \vec a)$-jet-cubes in their premises.
The orientation kits $\orife$ and $\orifb$ are only introduced for explanatory purposes: we can easily relate jet cubes with and without $\tej$ (\cref{thm:backward-jets-equivalent}), and later on\todo{Refer} we will be able to relate jet cubes with and without $\equijet$ by inserting additional symmetric degrees.
\begin{proposition} \label{thm:backward-jets-equivalent}
	Let $(\myorix, \myorix') \in \accol{(\orif, \orifb), (\orife, \orifbe)}$ and $M \in \accol{\bipointedsym, \booleanalg}$.
	Then the inclusion
	\[
		\jetcube{\myorix}{\mycubex}{M}{\vec a} \hookrightarrow \jetcube{\myorix'}{\mycubex}{M}{\vec a},
	\]
	which is fully faithful by definition, is also split essentially surjective and therefore an equivalence.
\end{proposition}
\begin{proof}
	One proves, by induction on the length of the jet cube, that any jet cube is isomorphic to the jet cube in which every occurrence of $\rival{\tej_i}$ is replaced with $\rival{\jet_i}$.
\end{proof}
\begin{proposition} \label{thm:lift-to-jet-cubes}
	The following functors on $\vec a$-jet-sets lift over $\JEP$ to functors on $(\myorix, \vec a)$-jet-cubes under the following conditions:
	\begin{center}
		\begin{tabular}{c c c c l}
			$\Op_i$ & lifts to & $\Opcube_i$ & if & ${\tej} \in \myorix$ \\
			$\Fsym_i$ & lifts to & $\Fsymcube_i$ && \\
			$\Usym_i$ & lifts to & $\Usymcube_i$ & if & ${\equijet} \in \myorix$ \\
			$\UFsym_i$ & lifts to & $\UFsymcube_i$ & if & ${\equijet} \in \myorix$ \\
			$\loch \multip \rival{\jet_i}$ & lifts to & $\loch \multip (\dm i : \rival{\jet_i})$ && \\
			$\loch \multip \rival{\edge_i}$ & lifts to & $\loch \multip (\dm i : \rival{\edge_i})$ & if & $a_i = \npolar$ \\
			$\loch \multip \rival{\tej_i}$ & lifts to & $\loch \multip (\dm i : \rival{\tej_i})$ & if & ${\tej} \in \myorix$ \\
		\end{tabular}
	\end{center}
%	The functors $\Fsym_i$, $\loch \multip \rival{\jet_i}$ and $\loch \multip \rival{\edge_i}$ lift to both forward and trioriented jet-$M$-cube categories.
%	The functors $\Op_i$, $\Usym_i$ and $\loch \multip \rival{\tej_i}$ lift to trioriented jet-$M$-cube categories.
%	We denote the resulting functors as $\Fsymcube_i$, $\loch \multip (\dm i : \rival{\jet_i})$, $\loch \multip (\dm i : \rival{\edge_i})$, $\Opcube_i$, $\Usymcube_i$ (in agreement with \cref{def:sym-forget-cube}) and $\loch \multip (\dm i : \rival{\tej_i})$, where each time $\dm i$ represents a bound De Bruijn index.
	We have $\Fsymcube_i \dashv \Usymcube_i$ and thus an idempotent monad $\UFsymcube_i := \Usymcube_i \circ \Fsymcube_i$, whose definition we extend to masks $\vec b$ where $b_i = \npolar$ as in \cref{def:sym-closure-of-sym}.
\end{proposition}
\begin{proof}
	The functors $\Fsym_i$, $\Op_i$ and $\Usym_i$ have no effect on the carrier, so they certainly lift to $\cubecat_M^\mycubex$, hence to the pullback $\cubecat_M^\mycubex \times_\Set \jetset{\vec a}$.
	\begin{itemize}
		\item $\Fsym_i$ lifts to jet cubes by replacing every occurrence of $\jet_i$, $\tej_i$ or $\equijet_i$ with $\edge_i$.
		\item $\Op_i$ lifts to jet cubes if ${\tej} \in \myorix$ by reversing the \emph{last} occurrence of either $\jet_i$ or $\tej_i$ (\cref{thm:twisted-prism-op}), if present.
		\item $\Usym_i$ lifts to jet cubes as the operation $\Usymcube_i$ already introduced in \cref{def:sym-forget-cube}.
	\end{itemize}
	To prove $\Fsymcube \dashv \Usymcube$, we need to build unit and co-unit natural transformations.
	Since the categories of jet cubes are fully faithful subcategories of the pullback $\cubecat_M^\mycubex \times_\Set \jetset{\vec a}$, it suffices to build them there.
	They were already established in $\jetset{\vec a}$ by \cref{def:sym-free,def:sym-cofree}.
	As they reduce to the identity unit and co-unit of $\Id \dashv \Id$ for the carriers, they trivially lift to $\cubecat_M^\mycubex$.
	
	The various prism functors multiply the carrier with $\accol{0, 1}$ and thus lift over $\EP$ to the affine/cartesian cube category by multiplying with $(\dm i : \IX)$.
	Hence, they also lift to the pullback $\cubecat_M^\mycubex \times_\Set \jetset{\vec a}$.
	Each of them lifts to jet cubes by appending the symbol concerned (if available).
\end{proof}
%\begin{definition} \label{def:prism-cube}
%	Let $\vec a$ be a mask, $\mycubex \in \accol{\affine, \cartes}$ and $i < \lenpol{\vec a}$. We define the \textbf{$i$-twisted-prism functor $\loch \multip (\dm i : \rival{\jet_i}) : \jetcubefwd{\mycubex}{M}{\vec a} \to \jetcubefwd{\mycubex}{M}{\vec a}$} on jet cubes as follows:\footnote{We still think of $\dm i$ as a De Bruijn index.}
%	\begin{itemize}
%		\item The object $W$ is sent to $(W, \dm i : \rival{\jet_i})$.
%		\item The morphism $\vfi : V \to W$ is sent to the morphism $\vfi \multip (\dm i : \rival{\jet_i})$ such that
%		\begin{itemize}
%			\item If $\mycubex = \affine$ then $\erasejc{\vfi \multip (\dm i : \rival{\jet_i})} = \erasejc \vfi * (\dm i : \IX)$,
%			\item If $\mycubex = \cartes$ then $\erasejc{\vfi \multip (\dm i : \rival{\jet_i})} = \erasejc \vfi \times (\dm i : \IX)$,
%			\item $\JEP(\vfi \multip (\dm i : \rival{\jet_i})) = \JEP(\vfi) \multip \rival{\jet_i}$.
%		\end{itemize}
%	\end{itemize}
%	If $a_i = \npolar$, then we call this simply the \textbf{$i$-prism functor} $\loch \multip (\dm i : \rival{\edge_i}) : \jetcubefwd{\mycubex}{M}{\vec a} \to \jetcubefwd{\mycubex}{M}{\vec a}$.
%	
%	We similarly define, on trioriented jet cubes:
%	\begin{itemize}
%		\item the $i$-twisted-prism functor $\loch \multip (\dm i : \rival{\jet_i}) : \jetcubefwd{\mycubex}{M}{\vec a} \to \jetcubefwd{\mycubex}{M}{\vec a}$ when $a_i = \ypolar$,
%		\item the opposite $i$-twisted-prism functor $\loch \multip (\dm i : \rival{\tej_i}) : \jetcubefwd{\mycubex}{M}{\vec a} \to \jetcubefwd{\mycubex}{M}{\vec a}$ when $a_i = \ypolar$,
%		\item the $i$-prism functor $\loch \multip (\dm i : \rival{\edge_i}) : \jetcubefwd{\mycubex}{M}{\vec a} \to \jetcubefwd{\mycubex}{M}{\vec a}$ when $a_i = \npolar$.
%	\end{itemize}
%\end{definition}
\begin{proposition} \label{thm:cube-commute-diff-degree}
	Any two functors on jet cubes concerned in \cref{thm:lift-to-jet-cubes}, instantiated on different degrees, commute.
	In other words, the natural transformation given in \cref{thm:commute-diff-degree} lifts to jet cubes when the associated functors lift.
\end{proposition}
\begin{proof}
	Since the categories of jet cubes are fully faithful subcategories of the pullback $\cubecat_M^\mycubex \times_\Set \jetset{\vec a}$, it suffices to prove the natural isomorphism there.
	The isomorphism was already established in $\jetset{\vec a}$ by \cref{thm:commute-diff-degree}, and the effect on the carrier is either nothing (when at most one prism functor is involved) or swapping components (when both functors are prism functors).
	These isomorphisms lift to $\cubecat_M^\mycubex$.
\end{proof}
\begin{proposition} \label{thm:cube-commute-symmetric}
	The functor $\loch \multip (\dm i : \rival{\edge_i})$ commutes with itself, i.e.\ the natural automorphism given in \cref{thm:commute-symmetric} lifts to jet cubes as $(\dm i / \dm i, \dm j / \dm j) : \loch \multip (\dm i : \rival{\edge_i}) \multip (\dm j : \rival{\edge_i}) \cong \loch \multip (\dm j : \rival{\edge_i}) \multip (\dm i : \rival{\edge_i})$.
\end{proposition}
\begin{proof}
	Analogous to the proof of \cref{thm:cube-commute-diff-degree}.
	The isomorphism was already established in $\jetset{\vec a}$ by \cref{thm:commute-symmetric}, and the effect on the carrier is swapping components, which lifts to $\cubecat_M^\mycubex$.
\end{proof}
\begin{remark} \label{rem:two-monads}
	As of this point we will only be interested in the monads $\bipointedsym$ and $\booleanalg$ because:
	\begin{itemize}
		\item We need involutions in order to be able to work with the source-side of the twisted prism, ruling out $\bipointed$ and $\distlattice$.
		\item We do not see any advantage of $\demorgan$ over $\booleanalg$. In particular, we want $\EP$ to be faithful (\cref{thm:monad-coercions-faithful}).
	\end{itemize}
\end{remark}
\begin{theorem} \label{thm:affine-automatic}
	Assuming decidability of the affineness predicate on cube morphisms, then for $M \in \accol{\bipointed, \bipointedsym}$, we have isomorphisms of categories\footnote{Depending on the formalization, possibly even equalities.}
	\[
		\jetcube \myorix \affine M {\vec a} \cong \jetcube \myorix \cartes M {\vec a},
	\]
	which act as the identity on objects.
\end{theorem}
\begin{proof}
	%Since the forward jet cube categories are full subcategories of the trioriented ones, it suffices to prove the first isomorphism.
	%There, 
	We know that $\jetcube \myorix \affine \bipointedsym {\vec a}$ is a subcategory of $\jetcube \myorix \cartes \bipointedsym {\vec a}$.
	So we need to show that any morphism in $\jetcubetri \cartes \bipointedsym {\vec a}$ is in fact affine.
	Take such a morphism $\hat \vfi : V \to W$ (write $\vfi = \erasejc{\hat \vfi}$) and assume it is not affine.
	Since $M$ only has nullary and unary operations, this means that $W$ has dimensions $\dm i$ and $\dm j$ such that $\dm i \psub \vfi$ and $\dm j \psub \vfi$ are not mutually fresh, meaning that $V$ has some dimension $\dm k$ such that $\dm i \psub \vfi, \dm j \psub \vfi \in \accol{\dm k, \lnot \dm k}$.
	Then $\JEP(\hat \vfi)$ cannot be a jet set morphism as $\JEP(W)$ has no diagonals. This is a contradiction.
\end{proof}
Note that the situation is not so simple for $\booleanalg$.
For example, at symmetric degrees, $\jetcubefwd \cartes \booleanalg{\vec a}$ features the `exclusive or' operation
\[
	((\dm i \vee \dm j) \wedge \lnot(\dm i \wedge \dm j)/\dm k) : (\dm i : \rival{\edge_i}, \dm j : \rival{\edge_i}) \to (\dm k : \rival{\edge_i})
\]
which cannot be constructed in $\jetcubefwd \affine \booleanalg{\vec a}$.
More startlingly, even at directed degrees, we have operations such as the following:
\[
	(\dm i \wedge \dm j/\dm p, \dm j \wedge \dm k/\dm q) : (\dm i : \rival{\jet_i}, \dm j : \rival{\jet_i}, \dm k : \rival{\jet_i}) \to (\dm p : \rival{\jet_i}, \dm q : \rival{\jet_i}),
\]
which collapses five consecutive points of the Hamiltonian path and is a legitimate jet cube morphism:
\[
	\xymatrix{
		(1, 0, 0)
			\ar[rrr]
		&&& (1, 0, 1)
			\ar[ld]
			\ar@{.>}[ddd]
		\\
		& (0, 0, 0)
			\ar[lu]
			\ar@{.>}[r]
		& (0, 0, 1)
			\ar[d]
		\\
		& (0, 1, 0)
			\ar[u]
			\ar@{.>}[r]
		& (0, 1, 1)
			\ar[rd]
		\\
		(1, 1, 0)
			\ar[ru]
			\ar@{.>}[uuu]
			\ar@{.>}[rrr]
			\ar@{}[rrrdd]|{\rotatebox{270}{$\mapsto$}}
		&&& (1, 1, 1)
		\\
		\\
		(0, 0)
			\ar@{=}[rrr]
		&&& (0, 0)
			\ar@{=}[ld]
			\ar@{.>}[ddd]
		\\
		& (0, 0)
			\ar@{=}[lu]
			\ar@{:}[r]
		& (0, 0)
			\ar[d]
		\\
		& (0, 0)
			\ar@{=}[u]
			\ar@{.>}[r]
		& (0, 1)
			\ar[rd]
		\\
		(1, 0)
			\ar[ru]
			\ar@{.>}[uuu]
			\ar@{.>}[rrr]
		&&& (1, 1).
	}
\]
While the operations $\vee$ and $\wedge$ in themselves are useful in developing a base category for pro-arrow equipments in order to extract companion and conjoint squares from an arrow, cube transformations such as the one above are not assumed in the definition of pro-arrow equipments, so we wish to exclude these.
For this reason, we will no longer be interested in cartesian jet-$\booleanalg$-cubes.
By \cref{thm:affine-automatic}, we are also no longer interested in cartesian jet-$\bipointedsym$-cubes.
In short then, by \cref{rem:two-monads}:
\begin{remark} \label{rem:no-cartesian}
	We are no longer interested in cartesian jet cubes.
\end{remark}

\subsection{A Calculus for Jet Cube Morphisms} \label{sec:jetcubes:calculus}
In this section, we develop a calculus that inductively generates the morphisms of the category \allowbreak $\jetcubetri{\affine}{M}{\vec a}$ and therefore also those of its full subcategories $\jetcube{\myorix}{\affine}{M}{\vec a}$.

Since the forgetful functor $U : \jetset{\vec a} \to \Set$ is faithful, so is $\erasejc \loch : \jetcube{\myorix}{\affine}{M}{\vec a} \to \cubecat^\affine_M$.
As such, we can regard `being a morphism of jet cubes' as a proof-irrelevant property of morphisms of cubes, which we will therefore use as preterms.
Our calculus will therefore feature a single judgement $\sez \vfi : V \to W$ meaning that the morphism $\vfi : \erasejc V \to \erasejc W$ is in fact a morphism of jet cubes.
Soundness (\cref{thm:calculus-sound}) of the calculus will be the property that the judgement's meaning actually holds when the judgement is derivable, whereas completeness (\cref{thm:calculus-complete}) means that the judgement is derivable when its meaning is true.
We do not have to bother with an equational theory, as we can simply inherit it from $\cubecat_M^\affine$.

\begin{definition} \label{def:conv-jet-cube-cat}
	We call a jet cube \textbf{conventional} if each of its dimensions has a degree equal to or lower than the previous one.
	We write $\convjetcube{\myorix}{\mycubex}{M}{\vec a}$ for the full subcategory of $\jetcube{\myorix}{\mycubex}{M}{\vec a}$ on conventional cubes.
\end{definition}
\begin{corollary} \label{thm:conv-jet-cube-cat}
	By \cref{thm:cube-commute-diff-degree}, the inclusion $\convjetcube{\myorix}{\mycubex}{M}{\vec a} \hookrightarrow \jetcube{\myorix}{\mycubex}{M}{\vec a}$ is essentially surjective (in fact split essentially surjective by the existence of sorting algorithms) and thus an equivalence of categories. \qed
\end{corollary}
%\begin{convention} \label{conv:sort-cubes}
%	When presenting the calculus, as justified by \cref{thm:cube-commute-diff-degree}, we will order the dimensions of a (forward/trioriented) jet cube by \emph{decreasing} degree.
%\end{convention}
\begin{figure}
	\[
		\inferencel{terminal}{
		}{
			\sez () : V \to ()
		}{}
	\]
	\[
		\inferencel{src:fwd}{
			\sez \vfi : V \to \Opcube_i(W)
		}{
			\sez (\vfi, 0/\dm i) : V \to (W, \dm i : \rival{\jet_i})
		}{}
		\qquad
		\inferencel{src:bck}{
			\sez \vfi : V \to \Opcube_i(W)
		}{
			\sez (\vfi, 1/\dm i) : V \to (W, \dm i : \rival{\tej_i})
		}{}
	\]
	\[
		\inferencel{tgt:fwd}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, 1/\dm i) : V \to (W, \dm i : \rival{\jet_i})
		}{}
		\qquad
		\inferencel{tgt:bck}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, 0/\dm i) : V \to (W, \dm i : \rival{\tej_i})
		}{}
	\]
	\[
		\inferencel{inv:fwd}{
			\sez (\vfi, t/\dm i) : V \to (W, \dm i : \rival{\tej_i})
		}{
			\sez (\vfi, \lnot t/\dm i) : V \to (W, \dm i : \rival{\jet_i})
		}{}
		\qquad
		\inferencel{inv:bck}{
			\sez (\vfi, t/\dm i) : V \to (W, \dm i : \rival{\jet_i})
		}{
			\sez (\vfi, \lnot t/\dm i) : V \to (W, \dm i : \rival{\tej_i})
		}{}
	\]
	\[
		\inferencel{prism:fwd}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, \dm i / \dm i) : (V, \dm i : \rival{\jet_i}) \to (W, \dm i : \rival{\jet_i})
		}{}
		\qquad
		\inferencel{prism:bck}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, \dm i / \dm i) : (V, \dm i : \rival{\tej_i}) \to (W, \dm i : \rival{\tej_i})
		}{}
	\]
%	\[
%		\inferencel{prism:sym}{
%			\sez \vfi : (U, V) \to W
%		}{
%			\sez (\vfi, \dm i / \dm i) : (U, \dm i : \rival{\edge_i}, V) \to (W, \dm i : \rival{\edge_i})
%		}{}
%	\]
	\[
		\inferencel{symmetrize}{
			\sez \vfi : \Fsymcube_i V \to W
		}{
			\sez \vfi : V \to \Usymcube_i W
		}{}
	\]
	\[
		\inferencel{wkn}{
			\sez \vfi : \UFsymcube_i(V) \to W \qquad
			R \in \accol{\jet, \tej, \equijet}
		}{
			\sez (\vfi, \dm i / \novar) : (V, \dm i : \rival{R_i}) \to W
		}{}
%		\qquad
%		\inferencel{wkn:bck}{
%			\sez \vfi : \UFsymcube_i(V) \to W
%		}{
%			\sez (\vfi, \dm i / \novar) : (V, \dm i : \rival{\jet_i}) \to W
%		}{}
		\qquad
		\inferencel{exchange}{
			\sez \vfi : (V, \dm j : \rival{\equijet_i}, U_1, \dm i : \rival{\equijet_i}, U_2) \to W
		}{
			\sez \vfi : (V, \dm i : \rival{\equijet_i}, U_1, \dm j : \rival{\equijet_i}, U_2) \to W
		}{}
	\]
	\[
		\inferencel{concursor}{
			P \in \accol{\jet, \tej, \equijet}
			\qquad
			Q \in \accol{\jet, \tej}
			\qquad
			j > i
			\\
			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
		}{
			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{P_j}, V) \to (W, \dm i : \rival{Q_i})
		}{}
%		\inferencel{concursor:fwd}{
%			P \in \left\{
%				\begin{array}{c l}
%					\jet & \text{(`companion')}, \\
%					\tej & \text{(`conjoint')}, \\
%					\equijet & \text{(`equiconcursor')},
%				\end{array}
%			\right\}
%			\\
%			\\
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{P_j}, V) \to (W, \dm i : \rival{\jet_i})
%		}{}
%		\qquad
%		\inferencel{concursor:bck}{
%			P \in \left\{
%				\begin{array}{c l}
%					\tej & \text{(`companion')}, \\
%					\jet & \text{(`conjoint')}, \\
%					\equijet & \text{(`equiconcursor')},
%				\end{array}
%			\right\}
%			\\
%			\\
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{P_j}, V) \to (W, \dm i : \rival{\tej_i})
%		}{}
	\]
%	\[
%		\inferencel{companion:fwd}{
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\jet_j}, V) \to (W, \dm i : \rival{\jet_i})
%		}{}
%		\qquad
%		\inferencel{companion:bck}{
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\tej_j}, V) \to (W, \dm i : \rival{\tej_i})
%		}{}
%	\]
%	\[
%		\inferencel{conjoint:fwd}{
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\tej_j}, V) \to (W, \dm i : \rival{\jet_i})
%		}{}
%		\qquad
%		\inferencel{conjoint:bck}{
%			\sez \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\jet_j}, V) \to (W, \dm i : \rival{\tej_i})
%		}{}
%	\]
%	\[
%		\inferencel{equicompanion:fwd}{
%			\sez \vfi : \UFsymcube_i(U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\equijet_j}, V) \to (W, \dm i : \rival{\jet_i})
%		}{}
%		\qquad
%		\inferencel{equicompanion:bck}{
%			\sez \vfi : \UFsymcube_i(U, V) \to W
%			\qquad
%			j > i
%		}{
%			\sez (\vfi, \dm j / \dm i) : (U, \dm j : \rival{\equijet_j}, V) \to (W, \dm i : \rival{\tej_i})
%		}{}
%	\]
	\[
		\inferencel{conn:prism:src-neutral}{
			(Q, \opA) \in \mathemph{\accol{(\jet, \vee), (\tej, \wedge)}} \\
			\sez \vfi : \UFsymcube_i V \to W \\
			\sez (\vfi, t / \dm i) : \mathemph{\Opcube_i V} \to (W, \dm i : \rival{Q_i})
		}{
			\sez (\vfi, t \opA \dm i / \dm i) : (V, \dm i : \rival{Q_i}) \to (W, \dm i : \rival{Q_i})
		}{$\booleanalg$}
		\qquad
		\inferencel{conn:prism:tgt-neutral}{
			(Q, \opA) \in \mathemph{\accol{(\jet, \wedge), (\tej, \vee)}} \\
			\sez \vfi : \UFsymcube_i V \to W \\
			\sez (\vfi, t / \dm i) : \mathemph{V} \to (W, \dm i : \rival{Q_i})
		}{
			\sez (\vfi, t \opA \dm i / \dm i) : (V, \dm i : \rival{Q_i}) \to (W, \dm i : \rival{Q_i})
		}{$\booleanalg$}
	\]
	\[
		\inferencel{conn:prism-inv:src-neutral}{
			(Q, \opA, P) \in \mathemph{\accol{(\jet, \vee, \tej), (\tej, \wedge, \jet)}} \\
			\sez \vfi : \UFsymcube_i V \to W \\
			\sez (\vfi, t / \dm i) : \mathemph{\Opcube_i V} \to (W, \dm i : \rival{Q_i})
		}{
			\sez (\vfi, t \opA \mathemphB{\lnot \dm i} / \dm i) : (V, \dm i : \mathemphB{\rival{P_i}}) \to (W, \dm i : \rival{Q_i})
		}{$\booleanalg$}
		\qquad
		\inferencel{conn:prism-inv:tgt-neutral}{
			(Q, \opA, P) \in \mathemph{\accol{(\jet, \wedge, \tej), (\tej, \vee, \jet)}} \\
			\sez \vfi : \UFsymcube_i V \to W \\
			\sez (\vfi, t / \dm i) : \mathemph{V} \to (W, \dm i : \rival{Q_i})
		}{
			\sez (\vfi, t \opA \mathemphB{\lnot \dm i} / \dm i) : (V, \dm i : \mathemphB{\rival{P_i}}) \to (W, \dm i : \rival{Q_i})
		}{$\booleanalg$}
	\]
	\[
		\inferencel{conn:degree-symmetric}{
			Q \in \accol{\jet, \tej} \qquad
			\opA \in \accol{{\vee}, {\wedge}} \\
			\sez (\vfi, s / \dm i) : \UFsymcube_i V \to (W, \dm i : \rival{Q_i}) \\
			\sez (\vfi, t / \dm i) : V \to (W, \dm i : \rival{Q_i})
		}{
			\sez (\vfi, t \opA s / \dm i) : V \to (W, \dm i : \rival{Q_i})
		}{$\booleanalg$}
	\]
%	\[
%		\inferencel{conj:fwd}{
%			\sez \vfi : \UFsymcube_i V \to W \\
%			\sez (\vfi, s/\dm i, t/\dm j) : V \to (W, \dm i : \rival{\jet_i}, \dm j : \rival{\jet_i})
%		}{
%			\sez (\vfi, s \wedge t/\dm k) : V \to (W, \dm k : \rival{\jet_i})
%		}{$\booleanalg$}
%		\qquad
%		\inferencel{disj:bck}{
%			\sez \vfi : \UFsymcube_i V \to W \\
%			\sez (\vfi, s/\dm i, t/\dm j) : V \to (W, \dm i : \rival{\tej_i}, \dm j : \rival{\tej_i})
%		}{
%			\sez (\vfi, s \vee t/\dm k) : V \to (W, \dm k : \rival{\tej_i})
%		}{$\booleanalg$}
%	\]
%	\[
%		\inferencel{disj:fwd}{
%			\sez \vfi : \UFsymcube_i V \to W \\
%			\sez (\vfi, s/\dm i, t/\dm j) : V \to (W, \dm i : \rival{\tej_i}, \dm j : \rival{\jet_i})
%		}{
%			\sez (\vfi, s \vee t/\dm k) : V \to (W, \dm k : \rival{\jet_i})
%		}{$\booleanalg$}
%	\qquad
%		\inferencel{conj:bck}{
%			\sez \vfi : \UFsymcube_i V \to W \\
%			\sez (\vfi, s/\dm i, t/\dm j) : V \to (W, \dm i : \rival{\jet_i}, \dm j : \rival{\tej_i})
%		}{
%			\sez (\vfi, s \wedge t/\dm k) : V \to (W, \dm k : \rival{\tej_i})
%		}{$\booleanalg$}
%	\]
%	\[
%		\inferencel{truth-table}{
%			a_i = \npolar
%			\qquad
%			\vec t[x_1, \ldots, x_n] \in (\booleanalg \accol{x_1, \ldots, x_n})^m
%			\\
%			\phantom{a_i = \npolar}
%			\qquad
%			\text{$\vec t : \accol{0, 1}^n \to \accol{0, 1}^m$ is non-expansive w.r.t.\ $\ell^1$-distance}
%			\\
%			\sez (\vfi, s_1/\dm i_1, \ldots, s_n/\dm i_n) : V \to (W, \dm i_1 : \rival{\edge_i}, \ldots, \dm i_n : \rival{\edge_i})
%		}{
%			\sez (\vfi, t_1[s_1, \ldots, s_n] / \dm j_1, \ldots, t_m[s_1, \ldots, s_n]) / \dm j_m) : V \to (W, \dm j_1 : \rival{\edge_i}, \ldots, \dm j_m : \rival{\edge_i})
%		}{$\booleanalg$, $\cartes$}
%	\]
	\caption{A calculus of affine $\orifbe$-jet-cube morphisms, for the monads $\bipointedsym$ and $\booleanalg$. See \cref{fig:calculus:sym} for specializations of these rules to symmetric degrees and \cref{fig:calculus:general} for unified versions of the specialized forward/backward rules.}
	\label{fig:calculus}
\end{figure}
\begin{figure}[htb]
	\[
		\inferencel{endpoint:sym}{
			\sez \vfi : V \to W
			\qquad
			c \in \accol{0, 1}
		}{
			\sez (\vfi, c/\dm i) : V \to (W, \dm i : \rival{\edge_i})
		}{}
		\qquad
		\inferencel{inv:sym}{
			\sez (\vfi, t/\dm i) : V \to (W, \dm i : \rival{\edge_i})
		}{
			\sez (\vfi, \lnot t/\dm i) : V \to (W, \dm i : \rival{\edge_i})
		}{}
	\]
	\[
		\inferencel{prism:sym}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, \dm i / \dm i) : (V, \dm i : \rival{\edge_i}) \to (W, \dm i : \rival{\edge_i})
		}{}
		\qquad
		\inferencel{wkn:sym}{
			\sez \vfi : V \to W
		}{
			\sez (\vfi, \dm i / \novar) : (V, \dm i : \rival{\edge_i}) \to W
		}{}
%		\inferencel{conn:prism:sym}{
%			\opA \in \accol{{\vee}, {\wedge}} \\
%			\sez (\vfi, s / \dm i) : V \to (W, \dm i : \rival{\edge_i})
%		}{
%			\sez (\vfi, \dm i \opA s / \dm i) : (V, \dm i : \rival{\edge_i}) \to (W, \dm i : \rival{\edge_i})
%		}{$\booleanalg$}
	\]
	\[
		\inferencel{exchange:sym}{
			\sez \vfi : (V, \dm j : \rival{\edge_i}, U_1, \dm i : \rival{\edge_i}, U_2) \to W
		}{
			\sez \vfi : (V, \dm i : \rival{\edge_i}, U_1, \dm j : \rival{\edge_i}, U_2) \to W
		}{}
		\qquad
		\inferencel{conn:sym}{
			\opA \in \accol{{\vee}, {\wedge}} \\
			\sez (\vfi, s / \dm i) : V \to (W, \dm i : \rival{\edge_i}) \\
			\sez (\vfi, t / \dm i) : V \to (W, \dm i : \rival{\edge_i})
		}{
			\sez (\vfi, t \opA s / \dm i) : V \to (W, \dm i : \rival{\edge_i})
		}{$\booleanalg$}
	\]
	\caption{Symmetric specializations of the rules in \cref{fig:calculus}. Note that the rules \textsc{conn:prism:}$*$ become a special case of \ruleref{conn:degree-symmetric}. We omit \ruleref{terminal} which specifies no degree, \ruleref{concursor} which specifies two, and \ruleref{symmetrize} which already places constraints on the anpolarity $a_i$.}
	\label{fig:calculus:sym}
\end{figure}
\begin{figure}[htb]
	\[
		\inferencel{src}{
			(Q, c) \in \mathemph{\accol{(\jet, 0), (\tej, 1)}} \\
			\sez \vfi : V \to \mathemph{\Opcube_i(W)}
		}{
			\sez (\vfi, c/\dm i) : V \to (W, \dm i : \rival{Q_i})
		}{}
		\qquad
		\inferencel{tgt}{
			(Q, c) \in \mathemph{\accol{(\jet, 1), (\tej, 0)}} \\
			\sez \vfi : V \to \mathemph{W}
		}{
			\sez (\vfi, c/\dm i) : V \to (W, \dm i : \rival{Q_i})
		}{}
	\]
	\[
		\inferencel{inv}{
			\accol{P, Q} = \accol{\jet, \tej} \\
			\sez (\vfi, t/\dm i) : V \to (W, \dm i : \rival{P_i})
		}{
			\sez (\vfi, \lnot t/\dm i) : V \to (W, \dm i : \rival{Q_i})
		}{}
		\qquad
		\inferencel{prism}{
			\sez \vfi : V \to W
			\qquad
			Q \in \accol{\jet, \tej}
		}{
			\sez (\vfi, \dm i / \dm i) : (V, \dm i : \rival{Q_i}) \to (W, \dm i : \rival{Q_i})
		}{}
	\]
	\caption{Unified versions of the specialized forward/backward rules in \cref{fig:calculus}.}
	\label{fig:calculus:general}
\end{figure}
\begin{definition} \label{def:calculus}
	For $M \in \accol{\bipointedsym, \booleanalg}$, any mask $\vec a$ and for any two objects
	\[
		V, W \in \Obj(\convjetcubetri \affine M {\vec a}),
	\]
	we define a proof-irrelevant predicate on morphisms $\vfi : \erasejc V \to \erasejc W$, denoted $\sez \vfi : V \to W$, inductively generated by the inference rules in \cref{fig:calculus}.
\end{definition}
We discuss these inference rules one by one; their soundness and completeness will be proven in \cref{thm:calculus-sound,thm:calculus-complete}.
Specializations of these rules for symmetric degrees are given in \cref{fig:calculus:sym}, and some rules are grouped together in \cref{fig:calculus:general}.

The unique morphism to the terminal cube $()$ is a jet cube morphism (\ruleref{terminal}).

We can substitute the last variable with an endpoint. If this end point is at the last dimension's source side, then the rest of the morphism lands in the $i$-opposite of $W$ (\ruleref{src:fwd}, \ruleref{src:bck}), otherwise it lands in $W$ itself (\ruleref{tgt:fwd}, \ruleref{tgt:bck}).

We can apply an involution to the last variable, provided that we turn around its direction (\ruleref{inv:fwd}, \ruleref{inv:bck}). Doing so means that the source-side is mapped to the source-side and the target-side is mapped to the target-side, so $W$ remains unaffected.

We can apply the (opposite) $i$-twisted prism functor to a morphism (\ruleref{prism:fwd}, \ruleref{prism:bck}).

If the last dimension of our target cube is of the form $\dm i : \rival{\equijet_i}$, then we know that our cube is in the image of $\Usymcube_i$, and we can proceed using the adjunction $\Fsymcube_i \dashv \Usymcube_i$ (\ruleref{symmetrize}).
This turns our last dimension into $\dm i : \rival{\edge_i}$ which is a special case of both $\dm i : \rival{\jet_i}$ and $\dm i : \rival{\tej_i}$, so we can proceed by using the \textsc{fwd} and \textsc{bck} rules of the calculus.

We can weaken w.r.t.\ the last dimension (\ruleref{wkn}) of the source cube, but some caution is required. At the source-side of the last dimension, we find $\Opcube_i(V)$, whereas at the target-side we have $V$.
Thus, $\vfi$ needs to be a morphism of jet cubes from $\Opcube_i(V) \to W$ as well as from $V \to W$.
This can be achieved by asking that $\vfi$ starts from $\UFsymcube_i(V)$, which can be thought of as a join of $\Opcube_i(V)$ and $V$. In the case of an equijet dimension, $\UFsymcube_i(V) = V = \Opcube_i(V)$.

We can exchange variables of the same symmetric degree $i$ (\ruleref{exchange}).
Note that conventionality implies that all variables in $U_1$ are also of type $\rival{\equijet_i}$.

We can substitute the last variable with a variable of a weaker (higher) degree in either direction (or of equijet dimension).
Inspired by \cref{thm:jetset-equipment}, we choose to use terminology from pro-arrow equipments and refer to this action as creating a companion when the direction of the arrow remains the same ($P = Q$), and a conjoint when it reverses ($\accol{P, Q} = \accol{\jet, \tej}$); we introduce the term \textbf{concursor} (\ruleref{concursor}) as the common generalization of companions, conjoints, and their symmetric counterpart \textbf{equiconcursors} ($P = {\equijet}$).
Some measures of caution need to be taken however, which we consider in the case of forward companions ($P = Q = {\jet}$), where we wish to derive $(\vfi, \dm j / \dm i) : (U, \dm j : \rival{\jet_j}, V) \to (W, \dm i : \rival{\jet_i})$.
First of all, we need to enforce affineness and make sure that $\vfi$ does not use the variable $\dm j$, so we will have $\vfi : (\erasejc{U}, \erasejc{V}) \to \erasejc{W}$.
Now let us look at what happens when we set $\dm i$ and $\dm j$ to $0$ or to $1$:
\[
	\xymatrix{
		(\Opcube_j(U), V)
			\ar[d]_{(0/\dm j)}
			\ar@{.>}[rr]^\vfi
		&&
		\Opcube_i(W)
			\ar[d]^{(0/\dm i)}
		\\
		(U, \dm j : \rival{\jet_j}, V)
			\ar[rr]_{(\vfi, \dm j / \dm i)}
		&& (W, \dm i : \rival{\jet_i})
		\\
		(U, V)
			\ar[u]^{(1/\dm j)}
			\ar@{.>}[rr]_\vfi
		&&
		W
			\ar[u]_{(1/\dm i)}
	}
\]
So $\vfi$ needs to be both a morphism of jet cubes from $(U, V)$ to $W$ and from $(\Opcube_j(U), V)$ to $\Opcube_i(W)$ or equivalently from $\Opcube_i(\Opcube_j(U), V)$ to $W$. This can be achieved by asking that $\vfi$ starts from \allowbreak $\UFsym_i(\UFsym_j(U), V)$, which can be thought of as a join of $(U, V)$ and $\Opcube_i(\Opcube_j(U), V)$.

The last five rules involve connections (conjunction and disjunction) and only apply if $M = \booleanalg$, as $\bipointedsym$ does not provide these operations.
Due to the twisted nature of the twisted prism functor, it turns out that we can substitute the last variable of the target cube only with a connection of which one operand (say the right one) is either (the negation of) the last variable of the source cube, or an expression depending only on $i$-symmetric variables.%
\footnote{This is formalized in \cref{thm:char-jet-cube-to-line}.}

In either case, it turns out that whether the last term reduces to $0$ or $1$ on any end point of the source cube, is sufficiently irregular that $i$-directed terms in the remainder of $\vfi$ can only depend on $i$-symmetric variables.
The promotion of all variables of degree $i$ to equijet variables in the context of $\vfi$ in at least one of the premises, precludes their usage in $i$-directed terms.

In the latter case, we can use \ruleref{conn:degree-symmetric}, where $s$ is also checked in the symmetrized context.

In the former case, we get to apply a rule that combines a connection, possibly an inversion, and the \ruleref{prism} rules.
The main point worth remarking upon is that the behaviour of $t$ only matters when the other operand reduces to the neutral element of the connection at hand.
Depending on this, we decide whether $t$ must be checked in the $i$-opposite context or not.
For example, in \ruleref{conn:prism:src-neutral}, if $Q = {\jet}$ and $\opA = \vee$, then the neutral element is $0$, so the behaviour of $t$ only matters when the other operand is $0$.
This means that we are coming from the source-side of $\dm i$, i.e.\ from $\Opcube_i V$.
This distinction leads to four different rules (\ruleref{conn:prism:src-neutral}, \ruleref{conn:prism:tgt-neutral}, \ruleref{conn:prism-inv:src-neutral}, \ruleref{conn:prism-inv:src-neutral}).

It is worth pointing out that if $a_i = \npolar$, then \ruleref{conn:degree-symmetric} specializes to the rule \ruleref{conn:sym} (\cref{fig:calculus:sym}) that is sufficiently general to also subsume the symmetric specializations of the other connection rules.

%\todoi{Old stuff}
%For rules allow us to substitute the last variable with a connection.
%The directions of the arrows in \ruleref{conj:fwd} and \ruleref{disj:fwd} can be understood by simply drawing jet squares and their images:
%\[
%	\xymatrix{
%		& {\mathclap{(\dm i : \rival{\jet_i}, \dm j : \rival{\jet_i})}}
%		\\
%		(0/\dm i, 0/\dm j)
%			\ar[rr]
%			\ar@{<-}[d]
%		&&
%		(0/\dm i, 1/\dm j)
%			\ar[d]
%		\\
%		(1/\dm i, 0/\dm j)
%			\ar[rr]
%		& \ar@{|=>}[d]^{(\dm i \wedge \dm j / \dm k) \circ \loch} &
%		(1/\dm i, 1/\dm j)
%		\\
%		(0/\dm k)
%			\ar@{=}[rr]
%			\ar@{=}[d]
%		&&
%		(0/\dm k)
%			\ar[d]
%		\\
%		(0/\dm k)
%			\ar[rr]
%		&&
%		(1/\dm k)
%	}
%	\qquad \qquad
%	\xymatrix{
%		& {\mathclap{(\dm i : \rival{\tej_i}, \dm j : \rival{\jet_i})}}
%		\\
%		(0/\dm i, 0/\dm j)
%			\ar[rr]
%			\ar[d]
%		&&
%		(0/\dm i, 1/\dm j)
%			\ar@{<-}[d]
%		\\
%		(1/\dm i, 0/\dm j)
%			\ar[rr]
%		& \ar@{|=>}[d]^{(\dm i \vee \dm j / \dm k) \circ \loch} &
%		(1/\dm i, 1/\dm j)
%		\\
%		(0/\dm k)
%			\ar[rr]
%			\ar[d]
%		&&
%		(1/\dm k)
%			\ar@{=}[d]
%		\\
%		(1/\dm k)
%			\ar@{=}[rr]
%		&&
%		(1/\dm k)
%	}
%\]
%The rules \ruleref{disj:bck} and \ruleref{conj:bck} then follow by conjugating with the involution.
%Again, caution is required.
%For example, in \ruleref{conj:fwd}, assume that $s = \dm i$ and $t = \dm j$ and consider what happens when we substitute $\dm i$ and $\dm j$ in \ruleref{conj:fwd} with different combinations that yield $0/\dm k$:
%\[
%	\xymatrix{
%		\Opcube_i(U)
%			\ar@/_/[dd]_{(0/\dm i, 1/\dm j)}
%			\ar@/^/[dd]^{(1/\dm i, 0/\dm j)}
%			\ar@{.>}[rr]^\vfi
%		&& \Opcube_i(W)
%			\ar[dd]^{(0/\dm k)}
%		\\
%		& U
%			\ar[ld]|{(0/\dm i, 0/\dm j)}
%			\ar@{.>}[ru]^\vfi
%		\\
%		(U, \dm i : \rival{\jet_i}, \dm j : \rival{\jet_i})
%		\ar[rr]_{(\vfi, \dm i \wedge \dm j / \dm k)}
%		&&
%		(W, \dm k : \rival{\jet_i})
%	}
%\]
%Again, we see that $\vfi : \erasejc U \to \erasejc W$ needs to be a morphism of jet cubes both from $\Opcube_i(U) \to \Opcube_i(W)$ (or equivalently from $U \to W$) and from $U \to \Opcube_i(W)$ (or equivalently from $\Opcube_i(U) \to W$). Again, we let $\vfi$ depart from their join $\UFsymcube_i(U)$.
%The cube $\erasejc U$ arose as the part of $\erasejc V$ not used by $s$ and $t$, so in the typing rule we can simply use $\UFsymcube_i(V)$ (this will be formalized in \cref{thm:calculus-sound,thm:calculus-complete}).

\subsubsection{Soundness} \label{sec:jetcubes:calculus:soundness}
\begin{theorem}[Soundness] \label{thm:calculus-sound}
	If a morphism $\vfi : \erasejc V \to \erasejc W$ satisfies the predicate $\sez \vfi : V \to W$ from \cref{def:calculus}, then it actually arises as the image $\vfi = \erasejc{\hat \vfi}$ of a morphism $\hat \vfi : V \to W$.
\end{theorem}
\begin{remark} \label{rem:calculus-natural}
	The derivation rules in our calculus are all natural w.r.t.\ $V$ and $W$.
	Indeed, since $\erasejc \loch$ is faithful, this is simply inherited from the underlying operations on cubes.
\end{remark}
\begin{proof}
	Note that what really needs to be proven is that $\sez \vfi : V \to W$ implies that $\EP(\vfi)$, which a priori is a function from the set $\EP(\erasejc V) = U(\JEP(V))$ to $\EP(\erasejc W) = U(\JEP(W))$, is in fact a morphism of jet sets $\JEP(V) \to \JEP(W)$.
	We prove this, of course, by induction on the derivation of the inductive predicate.
	
	\begin{itemize}
		\item For \ruleref{terminal}, note that $\JEP(())$ is the terminal jet set.
	
		\item For \ruleref{src:fwd}, \ruleref{src:bck}, \ruleref{tgt:fwd} and \ruleref{tgt:bck}, this follows immediately from \cref{def:prism}.
		
		\item For \ruleref{inv:fwd}, by postcomposition, it suffices to show that $\zeta : (\id_W, \lnot \dm i / \dm i) : \erasejc{(W, i : \rival{\tej_i})} \to \erasejc{(W, i : \rival{\jet_i})}$ is a morphism of jet cubes, i.e.\ that $\EP(\zeta) : (\vec w, u) \mapsto (\vec w, \lnot u)$ is a morphism of jet sets $\JEP(W) \multip \rival{\tej_i} \to \JEP(W) \multip \rival{\jet_i}$.
		
		Let $(\vec w, u) \jet_j (\vec w', u')$ in $\JEP(W) \multip \rival{\tej_i}$. Then by \cref{def:prism} of the opposite $i$-twisted prism, there are 3 possibilities:
		\begin{itemize}
			\item We have $u = u' = 0$ and $\vec w \jet_j \vec w'$ in $\JEP(W)$.
			In that case, we also have the required jet between the images $(\vec w, 1) \jet_j (\vec w', 1)$ in $\JEP(W) \multip \rival{\jet_i}$.
			\item We have $u = u' = 1$ and $\vec w \jet_j \vec w'$ in $\Op_i(\JEP(W))$.
			In that case, we also have the required jet between the images $(\vec w, 0) \jet_j (\vec w', 0)$ in $\JEP(W) \multip \rival{\jet_i}$.
			\item We have $j = i$, $u = 1$, $u' = 0$ and $\vec w = \vec w'$.
			In that case, we also have the required jet between the images $(\vec w, 0) \jet_i (\vec w, 1)$ in $\JEP(W) \multip \rival{\jet_i}$.
		\end{itemize}
		The proof of soundness of \ruleref{inv:bck} is analogous.
		
		\item Soundness of \ruleref{prism:fwd} and \ruleref{prism:bck} was already established by \cref{thm:lift-to-jet-cubes}.
		
		\item Soundness of \ruleref{symmetrize} follows from the adjunction established in \cref{thm:lift-to-jet-cubes}.
		
		\item We prove soundness of \ruleref{wkn} by precomposition with a jet cube morphism that erases to $(\id, \dm i / \novar) : \erasejc{(V, \dm i : \rival{R_i})} \to \UFsym_i \erasejc{V}$.
		Thus, we need to prove that $\EP(\id, \dm i / \novar) : (\vec v, w) \mapsto \vec v$ is a jet set morphism $\JEP(V, \dm i : \rival{R_i})
		%= \JEP(V) \multip \rival{\jet_i}
		\to \JEP(\UFsymcube_i(V))$.
		Let $(\vec v, w) \jet_j (\vec v', w')$ in $\JEP(V, \dm i : \rival{R_i})$.
		Then there are two possibilities:
		\begin{itemize}
			\item $w = w'$ and $(\vec v, w) \jet_j (\vec v', w)$. The latter implies $\vec v \jet_j \vec v'$ in $\JEP(V)$ if $j \neq i$ and $\vec v \infrajet_i \vec v'$ if $j = i$. Moving to $\JEP(\UFsymcube_i(V))$, we get $\vec v \jet_j \vec v'$ in all cases, as required.
			\item $j = i$, $\vec v = \vec v'$ and $w \jet_i w'$. In this case we have $\vec v \jet_j \vec v$ in $\JEP(\UFsymcube_i(V))$ by reflexivity.
		\end{itemize}
		
		\item Recalling \cref{def:jep}, soundness of \ruleref{exchange} follows from \cref{thm:cube-commute-symmetric}.
		(Note that, since we are dealing with conventional cubes, all variables in $U_1$ also have type $\rival{\equijet_i}$.)
		
		\item We prove soundness of \ruleref{concursor}.
		Assume that $\vfi$ is a jet cube morphism $\UFsymcube_i(\UFsymcube_j U, V) \to W$ and $j > i$.
		We prove that $(\vfi, \dm j / \dm i)$ is a jet cube morphism $(U, \dm j : \rival{P_j}, V) \to (W, \dm i : \rival{Q_i})$.
		Write $f = \EP(\vfi)$ and $g = \EP(\vfi, \dm j / \dm i)$.
		
		Pick a jet $(\vec u, t, \vec v) \jet_k (\vec u', t', \vec v')$ in $\JEP(U, \dm j : \rival{P_j}, V)$.
		We can assume that this jet is not reflexive.
		Let $\dm k$ be the variable where both hands differ.
		There are three possibilities:
		\begin{itemize}
			\item If $\dm k \in U$, then we have $t = t'$, $\vec v = \vec v'$ and $(\vec u, t, \vec v) \jet_k (\vec u', t, \vec v)$.
			\begin{itemize}
				\item If $k \neq j$ and $k \neq i$, this implies $(\vec u, \vec v) \jet_k (\vec u', \vec v)$ in $\JEP(U, V)$ and therefore also in $\JEP(\UFsymcube_i(\UFsymcube_j U, V))$, whence $f(\vec u, \vec v) \jet_k f(\vec u', \vec v)$, whence $g(\vec u, t, \vec v) = (f(\vec u, \vec v), t) \jet_k (f(\vec u', \vec v), t) = g(\vec u', t, \vec v)$.
				\item If $k = i$ or $k = j$, this implies $(\vec u, \vec v) \infrajet_k (\vec u', \vec v)$ in $\JEP(U, V)$ and therefore $(\vec u, \vec v) \equijet_k (\vec u', \vec v)$ in $\JEP(\UFsymcube_i(\UFsymcube_j U, V))$, whence $f(\vec u, \vec v) \equijet_k f(\vec u', \vec v)$, whence $g(\vec u, t, \vec v) = (f(\vec u, \vec v), t) \equijet_k (f(\vec u', \vec v), t) = g(\vec u', t, \vec v)$.
			\end{itemize}
			\item If $\dm k = \dm j$, then we have $k = j$, $\vec u = \vec u'$, $t \neq t'$ and $\vec v = \vec v'$. Then $g(\vec u, t, \vec v) = (f(\vec u, \vec v), t) \infrajet_i (f(\vec u, \vec v), t') = g(\vec u, t', \vec v)$ which implies $g(\vec u, t, \vec v) \jet_j g(\vec u, t', \vec v)$ since $j > i$.
			\item If $\dm k \in V$, then we have $t = t'$, $\vec u = \vec u'$ and $\vec v \jet_k \vec v'$ in $\JEP(V)$.
			\begin{itemize}
				\item If $k \neq i$, this implies $(\vec u, \vec v) \jet_k (\vec u, \vec v')$ in $\JEP(\UFsymcube_i(\UFsymcube_j U, V))$, whence $f(\vec u, \vec v) \jet_k f(\vec u, \vec v')$, whence $g(\vec u, t, \vec v) = (f(\vec u, \vec v), t) \jet_k (f(\vec u, \vec v'), t) = g(\vec u, t, \vec v')$.
				\item If $k = i$, this implies $(\vec u, \vec v) \equijet_i (\vec u, \vec v')$ in $\JEP(\UFsymcube_i(\UFsymcube_j U, V))$, whence $f(\vec u, \vec v) \equijet_i f(\vec u, \vec v')$, whence $g(\vec u, t, \vec v) = (f(\vec u, \vec v), t) \equijet_i (f(\vec u, \vec v'), t) = g(\vec u, t, \vec v')$.
			\end{itemize}
		\end{itemize}
		
		\item We prove soundness of \ruleref{conn:prism:src-neutral} for the case where $Q = {\jet}$ and $\opA = \vee$, the other case is proven analogously.
		Assume that $\vfi$ is a jet cube morphism $\UFsymcube_i V \to W$ and $(\vfi, t / \dm i)$ is a jet cube morphism $\Opcube_i V \to (W, \dm i : \rival{\jet_i})$.
		We prove that $(\vfi, t \vee \dm i / \dm i)$ is a jet cube morphism $(V, \dm i : \rival{\jet_i}) \to (W, \dm i : \rival{\jet_i})$.
		Write $f = \EP(\vfi)$ and $g = \EP(\vfi, t \vee \dm i / \dm i)$ and $h = \EP(\vfi, t / \dm i)$.
		
		Pick a non-reflexive jet $(\vec v, u) \jet_j (\vec v', u')$ in $\JEP(V, \dm i : \rival{\jet_i})$.
		Let $\dm k$ be the variable where both hands defer.
		There are two possibilities:
		\begin{itemize}
			\item If $\dm k = \dm i$, then $j = i$, $\vec v = \vec v'$, $u = 0$ and $u' = 1$.
			In this case, $(t \vee \dm i) \psub{\vec v, 1} = 1$, so that there is necessarily an $i$-jet $g(\vec v, 0) = (f(\vec v), (t \vee \dm i) \psub{\vec v, 0}) \jet_i (f(\vec v), 1) = g(\vec v, 1)$.
			\item If $\dm k \in V$, then $u = u'$ and $(\vec v, u) \jet_j (\vec v', u)$. Let $\dm l$ be the variable in $(W, \dm i : \rival{\jet_i})$ such that $\dm l \psub{\vfi, t \vee \dm i}$ depends on $\dm k$.
			If there is no such variable, then we are done.
			\begin{itemize}
				\item If $\dm l = \dm i$, then $\dm k$ occurs in $t$.
				\begin{itemize}
					\item If $u = 1$, then $g(\vec v, 1) = (f(\vec v), 1) \overset{=}{\jet}_j (f(\vec v'), 1) = g(\vec v', 1)$ as required.
					\item If $u = 0$, then we have $\vec v \jet_j \vec v'$ in $\JEP(\Opcube_i V)$.
					Because $(\vfi, t / \dm i)$ is a jet cube morphism $\Opcube_i V \to (W, \dm i : \rival{\jet_i})$, we get
					$g(\vec v, 0) = h(\vec v) \jet_j h(\vec v') = g(\vec v', 0)$ as required.
				\end{itemize}
				\item If $\dm l \in W$, then $\dm k$ occurs in $\vfi$.
				Define $z = (t \vee \dm i) \psub{\vec v, u} = (t \vee \dm i) \psub{\vec v', u}$.
				We have $g(\vec v, u) = (f(\vec v), z)$ and $g(\vec v', u) = (f(\vec v'), z)$.
				\begin{itemize}
					\item If $j = i$, then we have $\vec v \equijet_i \vec v'$ in $\JEP(\UFsymcube_i V)$, whence $f(\vec v) \equijet_i f(\vec v')$ in $\JEP(W)$, whence $g(\vec v, u) = (f(\vec v), z) \jet_i (f(\vec v'), z) = g(\vec v', u)$ in $\JEP(W, \dm i : \rival{\jet_i})$.
					\item If $j \neq i$, then we have $\vec v \jet_j \vec v'$ in $\JEP(\UFsymcube_i V)$, whence $f(\vec v) \jet_j f(\vec v')$ in $\JEP(W)$, whence $g(\vec v, u) = (f(\vec v), z) \jet_j (f(\vec v'), z) = g(\vec v', u)$ in $\JEP(W, \dm i : \rival{\jet_i})$.
				\end{itemize}
			\end{itemize}
%			\item $u = u'$ and $(\vec v, u) \jet_j (\vec v', u)$. The latter implies $\vec v \jet_j \vec v'$ in $\JEP(V)$ if $j \neq i$ and $\vec v \infrajet_i \vec v'$ if $j = i$.
%			Either way, we get $\vec v \jet_j \vec v'$ in $\JEP(\UFsymcube_i V)$ and therefore $f(\vec v) \jet_j f(\vec v')$ in $\JEP(W)$ where $f = \EP(\vfi)$.
		\end{itemize}
		
		\item Soundness of \ruleref{conn:prism:tgt-neutral} is proven analogously to that of \ruleref{conn:prism:src-neutral}.
		
		\item Soundness of \ruleref{conn:prism-inv:src-neutral} is proven from soundness of \allowbreak \ruleref{conn:prism:src-neutral} by precomposing the result with $(\id_V, \lnot \dm i / \dm i)$ which is a jet cube morphism $(V, \dm i : \rival{P_i}) \to (V, \dm i : \rival{Q_i})$.
		
		\item Soundness of \ruleref{conn:prism-inv:tgt-neutral} is similarly proven from soundness of \ruleref{conn:prism:tgt-neutral}.
		
		\item We prove soundness of \ruleref{conn:degree-symmetric}.
		Assume that
		\begin{itemize}
			\item $(\vfi, s / \dm i)$ is a jet cube morphism $\UFsymcube_i V \to (W, \dm i : \rival{Q_i})$,
			\item $(\vfi, t / \dm i)$ is a jet cube morphism $V \to (W, \dm i : \rival{Q_i})$.
		\end{itemize}
		We prove that $(\vfi, s \opA t / \dm i)$ is a jet cube morphism $V \to (W, \dm i : \rival{Q_i})$.
		Write
		\[
			f = \EP(\vfi), \qquad
			g = \EP(\vfi, s / \dm i), \qquad
			h = \EP(\vfi, t / \dm i), \qquad
			d = \EP(\vfi, s \opA t / \dm i).
		\]
		Pick a non-reflexive jet $\vec v \jet_j \vec v'$ in $\JEP(V)$; we prove that $d(\vec v) \jet d(\vec v')$ in $\JEP(W, \dm i : \rival{Q_i})$.
		Let $\dm k$ be the variable of $V$ where $\vec v$ and $\vec v'$ differ.
		There are four possible cases:
		\begin{itemize}
			\item If $\vfi$, $s$ and $t$ do not depend on $\dm k$ then the target jet is reflexive.
			\item If $\vfi$ or $s$ depends on $\dm k$, then we have $t \psub{\vec v} = t \psub{\vec v'} =: t_0$.
			\begin{itemize}
				\item If $j \neq i$, then we have $\vec v \jet_j \vec v'$ in $\JEP(\UFsymcube_i V)$, whence $(f(\vec v), s\psub{\vec v}) = g(\vec v) \jet_j g(\vec v') = (f(\vec v'), s\psub{\vec v'})$ in $\JEP(W, \dm i : \rival{Q_i})$.
				Taking a connection with $t_0$ does not influence the direction of the arrows to the left of $\dm i$, nor of the arrows at $\dm i$.
				Hence we get $d(\vec v) = (f(\vec v), s\psub{\vec v} \opA t_0) \jet_j (f(\vec v'), s\psub{\vec v'} \opA t_0) = d(\vec v')$.
				
				\item If $j = i$, then we have $\vec v \equijet_i \vec v'$ in $\JEP(\UFsymcube_i V)$, whence $(f(\vec v), s\psub{\vec v}) = g(\vec v) \equijet_i g(\vec v') = (f(\vec v'), s\psub{\vec v'})$ in $\JEP(W, \dm i : \rival{Q_i})$.
				Hence we get $d(\vec v) = (f(\vec v), s\psub{\vec v} \opA t_0) \equijet_i (f(\vec v'), s\psub{\vec v'} \opA t_0) = d(\vec v')$.
			\end{itemize}
			\item If $t$ depends on $\dm k$, then we have $f(\vec v) = f(\vec v') = : f_0$ and $s \psub{\vec v} = s \psub{\vec v'} =: s_0$.
			We get $(f_0, t \psub{\vec v}) = h(\vec v) \jet_j h(\vec v') = (f_0, t \psub{\vec v'})$.
			Taking a connection with $s_0$ yields $d(\vec v) = (f_0, s_0 \opA t \psub{\vec v}) \jet_j (f_0, s_0 \opA t \psub{\vec v'}) = d(\vec v')$. \qedhere
		\end{itemize}
		
%		\item \todoi{Find-replace companion/conjoint} For \ruleref{companion:fwd}, let $\hat \vfi : \UFsymcube_i(\UFsymcube_j U, V) \to W$ be a jet cube morphism.
%		Then $f := \JEP(\hat \vfi)$ is a jet set morphism $\JEP(\UFsymcube_i(\UFsymcube_j U, V)) \to \JEP(W)$.
%		We need to show that $g : (\vec u, w, \vec v) \mapsto (f(\vec u, \vec v), w)$ is a jet set morphism $\JEP(U, \dm j : \rival{\jet_j}, V) \to \JEP(W, \dm i : \rival{\jet_i}) = \JEP(W) \multip \rival{\jet_i}$.
%		
%		Assume we have $(\vec u, w, \vec v) \jet_k (\vec u', w', \vec v')$ in $\JEP(U, \dm j : \rival{\jet_j}, V)$.
%		By induction on $V$, one can show that we are in one of the following situations:
%		\begin{itemize}
%			\item $\vec u = \vec u'$, $w = w'$ and $(\vec u, \vec v) \jet_k (\vec u, \vec v')$ in $\JEP(U, V)$.
%			The fact that $f$ is a jet set morphism implies that $f(\vec u, \vec v) \jet_k f(\vec u, \vec v')$ and even $f(\vec u, \vec v) \equijet_i f(\vec u, \vec v')$ if $k = i$.
%			Then we have the required jet between the images $(f(\vec u, \vec v), w) \jet_k (f(\vec u, \vec v'), w)$ in $\JEP(W) \multip \rival{\jet_i}$, where if $k = i$ we use the forward part of the equijet if $w = 1$ and the backward part if $w = 0$.
%			
%			\item $k = j$, $\vec u = \vec u'$, $\vec v = \vec v'$ and $\accol{w, w'} = \accol{0, 1}$. In that case, we have the required jet between the images $(f(\vec u, \vec v), w) \jet_j (f(\vec u, \vec v), w')$ because we have $(f(\vec u, \vec v), w) \infrajet_i (f(\vec u, \vec v), w')$ and $i < j$.
%			
%			\item $w = w'$, $\vec v = \vec v'$ and $(\vec u, w, \vec v) \jet_k (\vec u', w, \vec v)$ in $\JEP(U, \dm j : \rival{\jet_j}, V)$.
%			The latter implies $(\vec u, \vec v) \jet_k (\vec u', \vec v)$ in $\JEP(U, V)$ if $k \neq j$ and $(\vec u, \vec v) \infrajet_j (\vec u', \vec v)$ if $k = j$.
%			Moving to \allowbreak $\JEP(\UFsymcube_i(\UFsymcube_j U, V))$, the $j$-infrajet for $k = j$ turns into a $j$-equijet and the $i$-jet for $k = i$ turns into an $i$-equijet.
%			Thus, we conclude, in any case, that $f(\vec u, \vec v) \jet_k f(\vec u', \vec v)$ in $\JEP(W)$, and even $f(\vec u, \vec v) \equijet_i f(\vec u', \vec v)$ if $k = i$.
%			Then we have the required jet between the images $(f(\vec u, \vec v), w) \jet_k (f(\vec u', \vec v), w)$.
%		\end{itemize}
%		Soundness of \ruleref{companion:bck}, \ruleref{conjoint:fwd},\ruleref{conjoint:bck}, \ruleref{equicompanion:fwd} and \ruleref{equicompanion:bck} is proven almost identically, where it may be enlightening to remark that in the equicompanion rules, we know that $\UFsymcube_j(U) = U$.
%		
%		\item For \ruleref{conj:fwd}, assume given a jet cube morphism $\hat \vfi : \UFsymcube_i V \to W$ (write $\vfi = \erasejc{\hat \vfi}$ and $\EP(\vfi) = f$) and boolean expressions $s$ and $t$ such that $\EP(\vfi, s/\dm i, t/\dm j)$ is a jet set morphism $\JEP(V) \to \JEP(W, \dm i : \rival{\jet_i}, \dm j : \rival{\jet_i}) = \JEP(W) \multip \rival{\jet_i} \multip \rival{\jet_i}$.
%		We show that $\EP(\vfi, s \wedge t / \dm k)$ is a jet set morphism $\JEP(V) \to \JEP(W, \dm k : \rival{\jet_i}) = \JEP(W) \multip \rival{\jet_i}$.
%		Assume we have $v \jet_k v'$ in $\JEP(V)$. Then because $\EP(\vfi, s/\dm i, t/\dm j)$ is a jet set morphism, we are in one of the following situations:
%		\begin{itemize}
%			\item $s(\vec v) = s(\vec v') =: s_0$ and $t(\vec v) = t(\vec v') =: t_0$ and $(f(\vec v), s_0, t_0) \jet_k (f(\vec v'), s_0, t_0)$.
%			The latter implies that $f(\vec v) \jet_k f(\vec v')$ if $k \neq i$.
%			On the other hand, if $k = i$ then because $\hat \vfi : \UFsymcube_i V \to W$ is a jet cube morphism, we know that $f(\vec v) \equijet_i f(\vec v')$.
%			In any case, we get the required jet between the images $(f(\vec v), s_0 \wedge t_0) \jet_k (f(\vec v'), s_0 \wedge t_0)$.
%			
%			\item $k = i$, $f(\vec v) = f(\vec v') = f_0$ and $(s(\vec v), t(\vec v)) \jet_i (s(\vec v'), t(\vec v'))$ in $\rival{\jet_i} \multip \rival{\jet_i}$.
%			The latter implies that exactly one row of the following table applies:
%			\[
%				\begin{array}{c | c | c c}
%					(s(\vec v), t(\vec v))
%					& (s(\vec v'), t(\vec v'))
%					& s(\vec v) \wedge t(\vec v)
%					& s(\vec v') \wedge t(\vec v')
%					\\ \hline
%					(1, 0) & (0, 0) & 0 & 0
%					\\
%					(0, 1) & (1, 1) & 0 & 1
%					\\
%					(0, 0) & (0, 1) & 0 & 0
%					\\
%					(1, 0) & (1, 1) & 0 & 1
%				\end{array}
%			\]
%			In each case, we get $s(\vec v) \wedge t(\vec v) \jet_i s(\vec v') \wedge t(\vec v')$ in $\rival{\jet_i}$, and thus the required jet between the images $(f_0, s(\vec v) \wedge t(\vec v)) \jet_i (f_0, s(\vec v') \wedge t(\vec v'))$.
%		\end{itemize}
%		Soundness of \ruleref{disj:bck}, \ruleref{disj:fwd} and \ruleref{conj:bck} is proven analogously, but with a different case analysis in the table. \qedhere
		
%		\item We prove soundness of \ruleref{truth-table} by postcomposition with a jet cube morphism that erases to $(\id, \vec t[\vec{\dm i}]/\vec{\dm j}) : (W, \dm i_1 : \rival{\edge_i}, \ldots, \dm i_n : \rival{\edge_i}) \to (W, \dm j_1 : \rival{\edge_i}, \ldots, \dm j_m : \rival{\edge_i})$, i.e. we prove that $\EP(\id, \vec t[\vec{\dm i}]/\vec{\dm j}) : (\vec w, \vec u) \mapsto (\vec w, \vec t(\vec u))$ is a jet set morphism $\JEP(W, \dm i_1 : \rival{\edge_i}, \ldots, \dm i_n : \rival{\edge_i}) \to \JEP(W, \dm j_1 : \rival{\edge_i}, \ldots, \dm j_m : \rival{\edge_i})$.
%		
%		Assume we have $(\vec w, \vec u) \jet_j (\vec w', \vec u')$ in the domain.
%		Then there are two possibilities:
%		\begin{itemize}
%			\item $\vec u = \vec u'$ and $(\vec w, \vec u) \jet_j (\vec w', \vec u)$.
%			The latter implies $\vec w \jet_j \vec w'$ in $\JEP(W)$ even if $j = i$ because $a_i = \npolar$.
%			In that case, we have $(\vec w, \vec t(\vec u)) \jet_j (\vec w', \vec t(\vec u))$.
%			\item $i = j$, $\vec w = \vec w'$ and $\vec u \edge_i \vec u'$ in $\JEP(U)$. The latter implies that the $\ell^1$-distance $d^1(\vec u, \vec u') \leq 1$, hence $d^1(\vec t(\vec u), \vec t(\vec u')) \leq 1$, hence $\vec t(\vec u) \edge_i \vec t(\vec u')$, so that $(\vec w, \vec t(\vec u)) \edge_i (\vec w, \vec t(\vec u'))$.
%		\end{itemize}
	\end{itemize}
\end{proof}

\subsubsection{Lemmas for Completeness} \label{sec:jetcubes:calculus:lemmas}
Proving completeness for the $\bipointedsym$ monad is fairly straightforward,
but for the cases involving connections (conjunctions and disjunctions), we need a couple of helper lemmas.

\paragraph{Boolean reduction}
In this section, we establish a normal form for affine boolean terms.
\begin{definition} \label{def:bool:reduction}
	Boolean \textbf{terms} $t \in \booleanalg(X)$ are equivalence classes $t = [e]$ of boolean \textbf{expressions} $e \in \booleanexpr(X)$, which are defined as abstract syntax trees made up of $0$, $1$, $\vee$, $\wedge$, $\lnot$ and elements of $X$. Thanks to commutativity and associativity, we regard $\vee$ and $\wedge$ as having a \emph{multiset} of operands with at least two elements. The other operations have the usual arities.
	
	We define a reduction algorithm that reduces an expression $e$ to $e'$ such that $[e] = [e']$:
	\begin{itemize}
		\item push all negations down to the leaves of the syntax tree,
    		\item eliminate negations of constants,
    		\item eliminate double negations,
    		\item eliminate conjunctions/disjunctions with constants,
    		\item remove parentheses of nested conjunctions / nested disjunctions.
	\end{itemize}
	We call an expression \textbf{normal} if it is its own reduction, i.e.\ if it is either a constant or a tree whose nodes are alternatingly (as we climb the tree) labeled with $\vee$ and $\wedge$ (the root can have either) and whose leaves are \textbf{literals}, where a literal is either a variable or its negation.
%	\begin{itemize}
%		\item By \textbf{(basic) reduction}, we mean the process of pushing all negations to the leaves, eliminating double negations, and simplifying conjunctions/disjunctions with the constants $0$ and $1$.
%		The outcome is either a constant, or a binary tree whose nodes are labelled with $\vee$ or $\wedge$ and whose leaves are (negations of) elements of $X$ (called \textbf{variables} in this setting).
%		\item For \textbf{associative reduction}, we first apply reduction and subsequently merge nodes with the same label.
%		The outcome is either a constant or a tree whose nodes are alternatingly (as we climb the tree) labeled with $\vee$ and $\wedge$ (the root can have either) and whose leaves are (negations of) variables.
%		Every node has finitely many children and at least 2.
%	\end{itemize}
%	We can also non-deterministically apply these algorithms to a term by first picking a representant and then reducing the representant.
\end{definition}
\begin{definition} \label{def:bool:pruning}
	Let $d$ and $e$ be normal expressions. We say that $d$ is a \textbf{pruning} of $e$ if any of the following conditions hold (inductively):
	\begin{itemize}
		\item $d$ is a literal occurring in $e$,
		\item $e$ has a subexpression $e'$ which has the same root label ${\opA} \in \accol{{\vee}, {\wedge}}$ as $d$ and such that there exists a partition of the multiset of operands of $d$, i.e.
		\[
			d = D_1 \opA \ldots \opA D_n
			\quad \text{where} \quad
			D_i = d_{i1} \opA \ldots \opA d_{ik_i}
		\]
		such that every $D_i$ is a pruning of a root operand in $e'$, and moreover a single operand of $e'$ cannot be used more often than its multiplicity in the multiset of root operands of $e'$.
	\end{itemize}
\end{definition}
\begin{proposition} \label{thm:bool:assign-pruning}
	Let $e$ be a normal expression with variables in $X$ and let $\sigma$ be a bit-assignment $\sigma : Y \to \accol{0, 1}$ of the variables in $Y \subseteq X$.
	Let $e[\sigma]$ reduce to $d$. Then $d$ is either a constant or a pruning of $e$.
\end{proposition}
\begin{proof}
	By induction on $e$. If $e$ is a constant or a literal, this is immediate.
	If $e$ is a conjunction or disjunction, then this follows from the induction hypothesis for the immediate children of $e$.
\end{proof}
\begin{lemma} \label{thm:boolexp-to-const-assignment}
	For every $t \in \booleanalg^\#(X)$ and $c \in \accol{0, 1}$, there exists a bit assignment $\sigma : X \to \accol{0, 1}$ such that $t[\sigma] = c$.
\end{lemma}
\begin{proof}
	Pick an affine representant $e \in [t]$ and assume it is normal (reduce if it is not).
	Then we can prove this by induction on the height of $e$.
\end{proof}
\begin{lemma} \label{thm:boolexp-to-pruning-assignment}
	For every normal affine expression $e \in \booleanexpr^\#(X)$ mentioning all and only the variables in $Z \subseteq X$, and for every $Y \subseteq X$, there exists a bit assignment $\sigma : X \setminus Y \to \accol{0, 1}$ such that $e[\sigma]$ reduces to a (necessarily normal affine) expression $d$ which mentions all and only the variables in $Y \cap Z$.
\end{lemma}
\begin{proof}
	By induction on $e$.
	If $e$ is a leaf (i.e.\ a constant or a literal), then this is trivial.
	If $e$ is a node with label $\opA \in \accol{{\vee}, {\wedge}}$, then we invoke the induction hypothesis for all immediate subtrees mentioning variables in $Y$, and find assignments for the variables mentioned in those immediate subtrees.
	For immediate subtrees not mentioning variables in $Y$, we use \cref{thm:boolexp-to-const-assignment} to find an assigment that reduces this subtree to the neutral element $\neutralA$ of $\opA$.
	Combining all assignments yields the required result.
\end{proof}
\begin{corollary} \label{thm:boolexp-to-var-assignment}
	For every normal affine expression $e \in \booleanexpr^\#(X)$ that has a leaf $\tilde y \in \accol{y,\lnot y}$ where $y \in X$, there exists a bit assignment $\sigma : X \setminus \accol y \to \accol{0, 1}$ such that $t[\sigma] = \tilde x$. \qed
\end{corollary}
\begin{corollary} \label{thm:bool:term-dependencies}
	If $e$ is a normal affine expression $e \in \booleanexpr^\#(X)$ depending on $y$, then every expression representing $[e]$ depends on $y$.
	We say that \textbf{an affine term $t \in \booleanalg^\#(X)$ depends on $y \in X$} if the following equivalent conditions hold:
	\begin{itemize}
		\item All representants of $t$ depend on $y$.
		\item All normal affine representants of $t$ depend on $y$.
		\item Some normal affine representant of $t$ depends on $y$. \qed
	\end{itemize}
\end{corollary}
\begin{definition} \label{def:bool:in-connection}
	If $e$ is a normal affine expression $e \in \booleanexpr^\#(X)$ depending on $x, y \in X$, then we say that $x$ and $y$ are \textbf{in $\opA$-connection} (where $\opA \in \accol{{\vee}, {\wedge}}$; concretely, we call this \textbf{in disjunction/conjunction}) \textbf{in $e$} if the closest common parent node of (the negation of) $x$ and (the negation of) $y$ is labelled with $\opA$.
	We also write this as $\getconn e x y = {\opA}$.
\end{definition}
\begin{lemma} \label{thm:bool:pruning-in-connection}
	Let $d, e \in \booleanexpr^\#(X)$ be normal affine expressions and $d$ a pruning of $e$.
	Let $d$ (hence $e$) depend on $x, y \in X$.
	Then $x$ and $y$ are in $\opA$-connection in $d$ if and only if they are in $\opA$-connection in $e$.
\end{lemma}
\begin{proof}
	Take the closest common ancestor of $x$ and $y$ in $d$.
	Proving that $d$ is a pruning of $e$ involves, at some point, that the operands of $d$ mentioning $x$ and $y$ are separated.
	At that point, a corresponding node in $e$ was chosen with the same label; call $e'$ the subtree rooted there.
	The immediate subtrees of $d'$ mentioning $x$ and $y$ are prunings of different immediate subtrees of $e'$, so that the root node of $e'$ is also the closest common ancestor of $x$ and $y$ in $e$.
\end{proof}
\begin{lemma} \label{thm:bool:twovar-normalization}
	An affine boolean expression $t \in \booleanalg^\#(X)$ mentioning exactly two variables $x$ and $y$, has only a single normal representant, which is of the form $\tilde x \opA \tilde y$ with $\tilde x$ and $\tilde y$ literals mentioning $x$ and $y$, and $\opA \in \accol{{\vee}, {\wedge}}$.
\end{lemma}
\begin{proof}
	Since every node has at least two children and there are exactly two leaves, there is exactly one node. This constrains the form of the normal representant.
	Next, each one of these forms produces a different truth table and the truth table is a property of $t$, so there can be only one normal representant.
\end{proof}
\begin{lemma} \label{thm:bool:term-in-connection}
	Let $t \in \booleanalg^\#(X)$ depend on $x, y \in X$, and let $\opA \in \accol{{\vee}, {\wedge}}$. The following conditions are equivalent:
	\begin{itemize}
		\item $x$ and $y$ are in $\opA$-connection in some normal affine representant of $t$,
		\item $x$ and $y$ are in $\opA$-connection in all normal affine representants of $t$,
		\item $x$ and $y$ are \textbf{in $\opA$-connection in $t$} (definition).
	\end{itemize}
	We also write this as $\getconn t x y = {\opA}$.
\end{lemma}
\begin{proof}
	Let $e$ and $e'$ be normal affine representants of $t$ and let $x$ and $y$ be in $\opA$-connection in $e$.
	Pick an assignment $\sigma$ such that $e[\sigma]$ reduces to $d$ which depends exactly on $\accol{x, y}$.
	By \cref{thm:bool:twovar-normalization}, $d$ is then the unique normal affine representant of $t[\sigma]$, so that $e'[\sigma]$ also reduces to $d$.
	Then $d$ is a pruning of both $e$ and $e'$, so by \cref{thm:bool:pruning-in-connection}, $x$ and $y$ are in $\opA$-connection in $e'$.
\end{proof}
\begin{lemma} \label{thm:bool:char-siblings} (Not used.)
	Let $e \in \booleanexpr^\#(X)$ be a normal affine expression depending on $x$ and $y$ where $x \neq y$.
	The following conditions are equivalent:
	\begin{itemize}
		\item $\getconn e x z = \getconn e y z$ for all $z \in X \setminus \accol{x, y}$,
		\item the literals $\tilde x$ and $\tilde y$ corresponding to $x$ and $y$ occurring in $e$ are immediate siblings.
	\end{itemize}
\end{lemma}
\begin{proof}
	It is clear that the second condition implies the first.
	To prove the other implication, assume that $\tilde x$ and $\tilde y$ are not immediate siblings. Let ${\opA} = \getconn e x y$. Then one of them, say $\tilde y$, has a closer relative $\tilde z$ such that $\getconn e y z = {\opB} \neq {\opA}$.
	This means that $e$ has a pruning of the form $d = \tilde x \opA (\tilde y \opB \tilde z)$.
	But then we have
	\[
		\getconn e x z = \getconn d x z = {\opA} \neq {\opB} = \getconn d y z = \getconn e y z,
	\]
	violating the assumption.
\end{proof}
\begin{lemma} \label{thm:bool:char-root-node}
	Let $X_1, X_2, \ldots, X_n \subseteq Z$ be disjoint and $n > 1$.
	Let $e \in \booleanexpr^\#(Z)$ be a normal affine expression depending on all and only on variables in $X = \bigcup_i X_i$.
	Let $\accol{{\opA}, {\opB}} \in \accol{{\vee}, {\wedge}}$.
	The following conditions are equivalent:
	\begin{itemize}
		\item both of the following conditions hold:
		\begin{itemize}
			\item $\getconn e x y = \opA$ for all $x \in X_i$, $y \in X_j$, $i \neq j$,
			\item each $X_i$ is $\opB$-connected meaning that no further partition of $X_i$ is possible maintaining the property above,
		\end{itemize}
		\item $e$ is of the form $e = d_1 \opA d_2 \opA \ldots \opA d_n$ with each $d_i$ depending on all and only on variables in $X_i$, and being either a leaf or a tree with root node labelled with $\opB$.
	\end{itemize}
\end{lemma}
\begin{proof}
	It is clear that the second condition implies the first.
	To prove the other implication, assume that $e$ is not of this form.
	There are two possibilities:
	\begin{itemize}
		\item $e$ is of the form $e = d_1 \opA d_2 \opA \ldots \opA d_m$ but the dependencies are not as expected.
		Then we get a different partition of $X$ by the upward implication which we already proved.
		But then we can intersect both partitions, yielding a finer one, which is in contradiction with the assumption that further partitioning was not possible.
		\item $e$ is of the form $e = d_1 \opB d_2 \opB \ldots \opB d_m$. Then $X$ is $\opB$-connected meaning that $n = 1$, violating the assumptions. \qedhere
	\end{itemize}
\end{proof}
\begin{lemma} \label{thm:bool:normal-from-graph}
	A non-constant normal affine boolean expression $e \in \booleanexpr^\#(X)$ is fully determined by the set of literals it mentions and $\getconn e \loch \loch$.
\end{lemma}
\begin{proof}
	Let $e, e' \in \booleanexpr^\#(X)$ be normal affine boolean expressions mentioning the same literals and such that $\getconn e \loch \loch = \getconn{e'} \loch \loch$.
	We prove that $e = e'$ by induction on $e$.
	If $e$ is a constant or a literal, the result is immediate.
	Otherwise, $e$ is of the form $e = d_1 \opA d_2 \opA \ldots \opA d_n$, where $\accol{{\opA}, {\opB}} \in \accol{{\vee}, {\wedge}}$.
	Then \cref{thm:bool:char-root-node} partitions $X$ in $\opB$-connected components.
	Then by the other implication of \cref{thm:bool:char-root-node}, $e'$ is of the form $e' = d_1' \opA d_2' \opA \ldots \opA d_n'$, where $d_i$ and $d_i'$ have the same dependencies $X_i$.
	Thus, they must also depend on the same set of literals.
	Since $d_i$ is a pruning of $e$ and $d_i'$ is a pruning of $e'$, we have $\getconn{d_i} \loch \loch = \getconn e \loch \loch = \getconn{e'} \loch \loch = \getconn{d_i'} \loch \loch$ when considered on pairs of distinct variables in $X_i$.
	From the induction hypothesis, we conclude that $d_i = d_i'$, for all $i$, and hence $e = e'$.
\end{proof}
\begin{theorem} \label{thm:bool:normalization}
	Every affine boolean term $t \in \booleanalg^\#(Z)$ has exactly one normal affine representant.
\end{theorem}
\begin{proof}
	Let $e, e' \in \booleanexpr^\#(X)$ be normal affine representants of $t$.
	By \cref{thm:bool:term-dependencies}, we know that $e$ and $e'$ depend on the same set of variables $X$.
	By \cref{thm:boolexp-to-var-assignment}, we know moreover that they mention the same literals.
	By \cref{thm:bool:term-in-connection}, we know that $\getconn e \loch \loch = \getconn{e'} \loch \loch = \getconn t \loch \loch$.
	Thus, by \cref{thm:bool:normal-from-graph}, we conclude that $e = e'$.
\end{proof}

\paragraph{Understanding jet cube morphisms}
\begin{lemma} \label{thm:left-of-concursor}
	In $\jetcubetri \affine M {\vec a}$ with $M \in \accol{\bipointedsym, \booleanalg}$,
	%assuming \cref{conv:sort-cubes},
	the following holds:
	If a cube morphism $\vfi$ is a jet cube morphism $V = (V_0, \dm j : \rival{P_j}, V_1) \to W = (W_0, \dm i : \rival{Q_i}, W_1)$ with $P, Q \in \accol{\jet, \tej, \equijet}$ and $j > i$,
	and if either of the following conditions hold:
	\begin{itemize}
		\item $\dm j$ appears in $\dm i \psub \vfi$,
		\item $\dm j$ does not appear in $\vfi$ at all,
	\end{itemize}
	then $\vfi$ is also a jet cube morphism
	$\tilde V := (\UFsymcube_j(V_0), \dm j : \rival{\equijet_j}, V_1) \to W$.
\end{lemma}
We remark that this lemma is vacuous if $a_i = \npolar$ or $P = {\equijet}$.

In words, the lemma says: When a variable of the domain of a jet cube morphism is used at a lower degree in the codomain, or not at all, then that variable and all variables of the same degree to its left can be promoted to equijet variables.

%In practice, we will only use this lemma for $M = \booleanalg$.
\begin{proof}
	Let $W'$ be the cube obtained from $W$ by simply deleting all variables of degree $i$ or lower.
	Then the weakening morphism $\pi : W \to W'$ is a jet cube morphism.
	Thanks to affineness, $\pi \circ \vfi : V \to W'$ does not depend on $\dm j$.
	Hence, $\pi \circ \vfi \circ (0/\dm j) = \pi \circ \vfi \circ (1/\dm j) =: \rho : (\erasejc{V_0}, \erasejc{V_1}) \to \erasejc{W'}$.
	In the category of \emph{jet cubes} and \emph{cube morphisms between their erasures}, we have a commutative diagram
	\[
		\xymatrix{
			(\Opcube_j V_0, V_1)
				\ar@{.>}@/_/[rrdd]_{\rho}
				\ar[rr]^{(0/\dm j)}
			&&
			V
				\ar[d]^\vfi
			&&
			(V_0, V_1)
				\ar@{.>}@/^/[lldd]^{\rho}
				\ar[ll]_{(1/\dm j)}
			\\
			&& W
				\ar[d]^\pi
			\\
			&& W'
		}
	\]
	where the black arrows are known to be jet cube morphisms, and hence the dotted arrows are also jet cube morphisms as jet cube morphisms compose.
	Thus, $\rho$ is both a jet cube morphism $(\Opcube_j V_0, V_1) \to W'$ and $(V_0, V_1) \to W'$, hence it is a jet cube morphism $(\UFsymcube_j V_0, V_1) \to W'$.
	
	We now show that $\vfi$ is a jet cube morphism $\tilde V \to W$, i.e.\ that $f := \EP(\vfi)$ is a jet set morphism $\JEP(\tilde V) \to \JEP(W)$.
	Pick a non-reflexive jet $\vec v = (\vec v_0, u, \vec v_1) \jet_k \vec v' = (\vec v_0', u', \vec v_1')$ in $\tilde V$; we show that $f(\vec v) \jet_k f(\vec v')$.
	If $k \neq j$, then $\vec v \jet_k \vec v'$ is also a jet in $V$ and therefore preserved by $f$.
	Thus, we can assume that $k = j$.
	%If $\vec v = \vec v'$, then preservation is trivial, so we assume $\vec v \neq \vec v'$.
	Let $\dm k$ be the unique variable where $\vec v$ and $\vec v'$ differ.
	There are three possibilities
	\begin{description}
		\item[\framebox{$\dm k \in V_0$}]
		In this case, we have $\vec v_0 \infrajet_j \vec v_0'$ in $V_0$, $u = u'$, $\vec v_1 = \vec v_1'$, $\vec v \infrajet_j \vec v'$ in $V$ and $f(\vec v) \infrajet_j f(\vec v')$ in $W$.
		If $\vfi$ does not depend on $\dm k$, then $f(\vec v) = f(\vec v')$ and therefore $f(\vec v) \jet_j f(\vec v')$.
		So we assume that $\vfi$ depends on $\dm k$; let $\dm l$ be the variable such that $\dm l \psub \vfi$ depends on $\dm k$.
		\begin{itemize}
			\item If $\dm l$ is of degree $\ell \leq i < j$, then $f(\vec v) \infrajet_j f(\vec v')$ is only possible if $f(\vec v) \infrajet_\ell f(\vec v')$ which implies $f(\vec v) \equijet_j f(\vec v')$.
			\item If $\dm l$ is of degree $\ell > i$, then we have $\EP(\rho)(\vec v_0, \vec v_1) \overset{\neq}{\equijet}_j \EP(\rho)(\vec v_0', \vec v_1)$ because $\rho$ is a jet cube morphism $(\UFsymcube_j V_0, V_1) \to W'$.
			Since $\EP(\rho) = \EP(\pi) \circ \EP(\vfi) \circ \EP(c/\dm j)$ for any $c \in \accol{0, 1}$ and the components forgotten by $\EP(\pi)$ are identical,
			%and include any dependency on $\dm j$,
			we have $f(\vec v) \equijet_j f(\vec v')$.
		\end{itemize}
		
		\item[\framebox{$\dm k = \dm j$}] In this case, we have $\vec v_0 = \vec v_0'$, $\vec v_1 = \vec v_1'$, and $\vec v \infrajet_j \vec v'$ in $V$.
		Therefore we get $f(\vec v) \infrajet_j f(\vec v')$ and these vectors differ at their value for $\dm i$, which has degree $i$, so this is only possible if $f(\vec v) \infrajet_i f(\vec v')$, which implies $f(\vec v) \equijet_j f(\vec v')$.
		
		\item[\framebox{$\dm k \in V_1$}] Then $\vec v \jet_j \vec v'$ holds in $V$ and is therefore preserved by $f = \EP(\vfi)$. \qedhere
	\end{description}
\end{proof}
\begin{lemma} \label{thm:char-twisted-cube-to-line}
	In $\jetcubetri \mycubex \booleanalg {\vec a}$ with $\mycubex \in \accol{\affine, \cartes}$, let $V$ be a jet cube with only $i$-directed variables called (from left to right) $\dm j_1, \ldots, \dm j_n$, and consider $\vfi : V \to (\dm i : \rival{P_i})$ with $P \in \accol{\jet, \tej}$.
	Then $\dm i \psub{\vfi}$ is either a constant or of the (obviously affine) form
	\[
		\dm i \psub{\vfi} = (\ldots((\lnot^{p_1} \dm j_1 \opA_1 \lnot^{p_2} \dm j_2) \opA_2 \lnot^{p_3} \dm j_3) \ldots) \opA_{n-1} \lnot^{p_n} \dm j_n
	\]
	with $p_k \in \accol{0, 1}$ and $\opA_k \in \accol{{\vee}, {\wedge}, {\opK}}$ where we define $x \opK y := y$.
\end{lemma}
We will only use this lemma when $\mycubex = \affine$.
\begin{proof}
	%It is sufficient to prove this for $\mycubex = \cartes$ as the category of affine jet cubes is a subcategory of the category of cartesian jet cubes.
%
	We assume $P = {\jet}$, the proof for $P = {\tej}$ is analogous.

	We prove this by induction on $n$.
	% (and we don't have to worry about calling the induction hypothesis only on affine morphisms).
	If $n = 0$ then $\dm i \psub \vfi$ is necessarily a constant.
	Assume $n > 0$, implying that $a_i = \ypolar$.
	The jet set $\JEP(V)$ has $2^n$ elements and a unique Hamiltonian path of $i$-jets.
	The function $f := \JEP(\vfi)$ sends this Hamiltonian path to a path in $\JEP(\dm i : \rival{\jet_i}) = \accol{0 \jet_i 1}$.
	Thus, $f$ is entirely determined by the step in the Hamiltonian path where the image of $f$ flips from $0$ to $1$.
	Write $\dm j_k'$ to mean $\dm j_k$ if $\dm j_k : \rival{\jet_i}$ and to mean $\lnot \dm j_k$ if $\dm j_k : \rival{\tej_i}$.
	There are 5 possible scenarios:
	\begin{itemize}
		\item The entire path is sent to $0$. Then $\dm i \psub \vfi = 1 = \_ \opK 0$.
		\item The entire path is sent to $1$. Then $\dm i \psub \vfi = 1 = \_ \opK 1$.
		\item The first half of the path is sent to $0$, the second half is sent to $1$. Then $\dm i \psub \vfi = \dm j_n' = \_ \opK \dm j_n'$.
		\item The output of $f$ flips somewhere in the first half of the path.
		Then $\dm i \psub \vfi = s \vee \dm j_n'$ for some boolean expression $s$ depending on $\dm j_1, \ldots, \dm j_{n-1}$.
		Write $V = (U, \dm j_n : \_)$.
		Then we have $(s/\dm i) : \Opcube_i U \to (\dm i : \rival{\jet_i})$, such that $\JEP(s/\dm i)$ is essentially the restriction of $f$ to the first half of the Hamiltonian path as is evident from the following commutative diagram:
		\[
			\xymatrix{
				\Opcube_i U
					\ar[rr]^{(s/\dm i)}
					\ar[rd]_{(0/\dm j_n)}
				&&
				(\dm i : \rival{\jet_i}).
				\\
				& V = (U, \dm j_n : \_)
					\ar[ru]_{(s \vee \dm j_n / \dm i)}
			}
		\]
		By the induction hypothesis, $s$ is of the prescribed form, and therefore so is $\dm i \psub \vfi$.
		\item The output of $f$ flips somewhere in the second half of the path.
		Then $\dm i \psub \vfi = s \wedge \dm j_n'$ for some boolean expression $s$ depending on $\dm j_1, \ldots, \dm j_{n-1}$.
		Write $V = (U, \dm j_n : \_)$.
		Then we have $(s/\dm i) : U \to (\dm i : \rival{\jet_i})$, such that $\JEP(s/\dm i)$ is essentially the restriction of $f$ to the second half of the Hamiltonian path as is evident from the following commutative diagram:
		\[
			\xymatrix{
				U
					\ar[rr]^{(s/\dm i)}
					\ar[rd]_{(1/\dm j_n)}
				&&
				(\dm i : \rival{\jet_i}).
				\\
				& V = (U, \dm j_n : \_)
					\ar[ru]_{(s \wedge \dm j_n / \dm i)}
			}
		\]
		By the induction hypothesis, $s$ is of the prescribed form, and therefore so is $\dm i \psub \vfi$. \qedhere
	\end{itemize}
\end{proof}
\begin{lemma} \label{thm:char-jet-cube-to-line}
	In $\jetcubetri \affine \booleanalg {\vec a}$ where $a_i = \ypolar$, consider $\vfi : V \to (\dm i : \rival{P_i})$ with $P \in \accol{\jet, \tej}$.
	Write $\dm j_1, \ldots, \dm j_n$ for the $i$-directed variables of $V$.
	Then $\vfi$ does not depend on variables of degree lower (stronger) than $i$, nor on $i$-equijet variables of $V$.
	Moreover, $\dm i \psub{\vfi}$ is of the form
	\[
		\dm i \psub{\vfi} = h_n(h_{n-1}(\ldots h_3(h_2(h_1(\lnot^{p_1} \dm j_1) \opA_1 \lnot^{p_2} \dm j_2) \opA_2 \lnot^{p_3} \dm j_3) \ldots ) \opA_{n-1} \lnot^{p_n} \dm j_n)
	\]
	with $p_k \in \accol{0, 1}$ and $\opA_k \in \accol{{\vee}, {\wedge}, {\opK}}$ where we define $x \opK y := y$, and every $h_k$ is a composition of functions of the form $\loch \opB t$ with $t$ any affine boolean expression mentioning only $i$-symmetric variables and ${\opB} \in \accol{{\vee}, {\wedge}, {\opK}}$.
\end{lemma}
\begin{proof}
	We assume $P = {\jet}$, the proof for $P = {\tej}$ is analogous.

	First of all, the $i$-equijet relation as well as all $\ell$-jet relations for $\ell < i$ are reflexive in $\JEP(\dm i : \rival{\jet_i}) = \accol{0 \jet_i 1}$, so that $\JEP(\vfi)$ must be constant on $i$-equijet- or $\ell$-jet-connected components, implying that $\vfi$ cannot depend on those variables.
	Then $\vfi$ factors over the map $\chi : V \to W$ that weakens over all those variables.
	($\JEP(\chi)$ is the map that quotients out the $i$-equijet relation and therefore also the $\ell$-jet relations for $\ell < i$.)
	Thus, without loss of generality, we can assume that $V = W$ contains no variables of degree lower than $i$, and no $i$-equijet variables.
	Moreover, applying \cref{thm:conv-jet-cube-cat}, we can assume without loss of generality that $V$ is conventional so that the $i$-directed variables in $V$ are the last ones.
	
	Write $U$ for the $i$-directed part of $V$ and note that any assignment of bits to all $i$-symmetric variables yields a jet cube morphism $\sigma : U \to V$ whose composite with $\vfi$ necessarily satisfies \cref{thm:char-twisted-cube-to-line}.
	By \cref{thm:boolexp-to-pruning-assignment}, there exists a particular assignment $\sigma_0 : U \to V$ such that $\dm i \psub{\vfi \circ \sigma_0}$ depends on all $i$-directed variables that $\dm i \psub \vfi$ depends on.
	The form of \cref{thm:char-twisted-cube-to-line} then dictates that $\dm i \psub \vfi$ depends on a final segment of the $i$-directed variables in $V$.
	Then $\vfi$ factors over the map $\chi : V \to W$ that weakens over the initial segment of $i$-directed variables that $\vfi$ does not depend on, and again, without loss of generality, we assume that $V = W$, i.e.\ that $\vfi$ uses \emph{all} $i$-directed variables in $V$.
	
	The fact that $\dm i \psub{\vfi \circ \sigma_0}$ satisfies \cref{thm:char-twisted-cube-to-line} and is a pruning of $\dm i \psub{\vfi}$ (by \cref{thm:bool:assign-pruning}), severely constrains the possible forms that $\dm i \psub{\vfi}$ may take.
	However, \cref{thm:char-twisted-cube-to-line} does not require that conjunction and disjunction appear in alternation, and thus, a priori, by associativity, parentheses could be moved around before unpruning.
	Thus, we need to constrain further to obtain the form in the current lemma.
	
	%Write $\dm j_k'$ to mean $\dm j_k$ if $\dm j_k : \rival{\jet_i}$ and to mean $\lnot \dm j_k$ if $\dm j_k : \rival{\tej_i}$.
	
	Let $e$ be the unique normal affine representant of $\dm i \psub \vfi$ (\cref{thm:bool:normalization}).
	We proceed by induction on $e$.
	If $e$ is a constant or $i$-symmetric literal, then it is of the required form.
	If it is an $i$-directed literal, then it is the only one it depends on, hence $\lnot^{p_n} \dm j_n'$ with $n=1$, and thus of the required form.
	
	If $e$ is of the form $e = d_1 \opA \ldots \opA d_m$, then we need to prove that either $\lnot^{p_n} \dm j_n$ is a direct operand of $e$, or all $i$-directed variables occur in the same direct operand of $e$.
	Suppose that neither is the case. Then we can assume that $d_1$ depends \emph{indirectly} on $\dm j_n$ and $d_2$ depends on $\dm j_k$.
	Say $d_1 = c_1 \opZ \ldots \opZ c_\ell$ with $\accol{{\opA}, {\opZ}} = \accol{{\vee}, {\wedge}}$ and $c_1$ depends on $\dm j_n$.
	There is an assignment $\sigma_1$ of the $i$-symmetric dependencies of $d_1$ that reduces all $c_{i > 2}$ to the absorbing element $\absorbZ$ of $\opZ$, and thus reduces $d_1$ to $\absorbZ = \neutralA$, the neutral element of $\opA$.
	For $i > 2$, there is an assignment $\sigma_i$ of the $i$-symmetric dependencies of $d_i$ that preserves all $i$-directed dependencies.
	We combine all these assignments to a single assignment $\sigma : U \to V$. Then $e[\sigma]$ reduces to a normal expression that depends on $\dm j_k$ but not $\dm j_n$, which is then a representant of $\dm i \psub{\vfi \circ \sigma}$, which we know must satisfy \cref{thm:char-twisted-cube-to-line} and thus cannot depend on $\dm j_k$ without also depending on $\dm j_n$.
%	
%	\todoi{Old version}
%	
%	We prove the rest of the theorem by induction on $n$, the number of $i$-directed variables in $V$.
%	If $n = 0$, then $\dm i \psub \vfi = t = \_ \opK t$ where $t$ does not mention any $i$-directed variables.
%	
%	Let $n > 0$.
%	Let $e$ be the unique normal affine representant of $\dm i \psub \vfi$ (\cref{thm:bool:normalization}).
%	Write $\dm j_k'$ to mean $\dm j_k$ if $\dm j_k : \rival{\jet_i}$ and to mean $\lnot \dm j_k$ if $\dm j_k : \rival{\tej_i}$.
%	Write $U$ for the $i$-directed part of $V$ and note that any assignment of bits to all $i$-symmetric variables yields a jet cube morphism $\sigma : U \to V$ whose composite with $\vfi$ necessarily satisfies \cref{thm:char-twisted-cube-to-line}.
%	
%	We prove the induction step again by induction, now on the height of the syntax tree of $e$. \todoi{Are we though?}
%	
%	\begin{itemize}
%		\item We claim that if $\dm j_n$ and $\dm j_{k}$ occur in different children of the root node of $e$, then $\dm j'_n$ is a direct child of $e$.
%		
%		Let the root node of $e$ be labelled with $\opA$, where $\accol{(\opA, \absorbA), (\opZ, \absorbZ)} = \accol{(\vee, 1), (\wedge, 0)}$, and let $t$ be the child of $e$ mentioning $\dm j_n$.
%		
%		First of all, note that there exists an assignment of all $i$-symmetric variables in $t$ that makes none of the $i$-directed variables disappear.
%		The result should reduce to something satisfying \cref{thm:char-twisted-cube-to-line}.
%		Then this is only possible if any two $i$-directed variables in $t$ are also in $\opA$-connection (\cref{def:bool:in-connection}), so that the parentheses can be moved around. \todoi{Also in $\opA$-connection with $\dm j_n$?}
%		
%		We know that if $\dm j'_n$ is not a direct child of $e$, then it must depend on other variables and the root node of $t$ is labelled with $\opZ$.
%		If one of the immediate operands $s$ of $t$ depends on $\dm j_n$,
%		then any other operand $r$ of $t$ can only depend on $i$-symmetric variables, as $\dm j_n$ is in $\opA$-connection with all $i$-directed variables in $t$.
%		Then for every $r$ (and in particular for some $r$) there exists a bit assignment of its dependencies that makes $r$ reduce to $\absorbZ$, such that all of $t$ reduces to $\absorbZ$, and gets ignored as an operand of $e$.
%		In all other direct operands of $e$, we can choose bit assignments of $i$-symmetric variables that make no $i$-directed variables disappear.
%		Then $e$ will reduce to an expression containing $\dm j_k$ but not $\dm j_n$, in violation of \cref{thm:char-twisted-cube-to-line}.
%		\todoi{This is incomprehensible, prove this again!}
%		
%%		\todoi{The reasoning below is not good enough.}
%%		
%%		Assume $t$ mentions an $i$-symmetric variable.
%%		Then we can choose a bit-assignment of all $i$-symmetric variables that makes $\dm j_n$ disappear in $t$, but does not make any of the other $i$-directed variables appearing in other children of $e$ disappear.
%%		It is clear that we can accomplish this on a per-child-of-$e$ basis.
%%		Of course $t$ will reduce to a constant, so we need to make sure that this constant is not $0$ if $e$ is a conjunction, or $1$ if it is a disjunction.
%%		However, if $e$ is a conjunction, then $t$ is a disjunction, and we can set an operand that does not contain $\dm j_n$ to 1. The dual holds if $e$ is a disjunction.
%%		We now obtain a boolean expression that is not of the form described in \cref{thm:char-twisted-cube-to-line}, which is a contradiction.
%%		
%%		Assume $t$ mentions another $i$-directed variable.
%%		Thanks to affineness, we can choose a bit-assignment of all $i$-symmetric variables such that no $i$-directed variable disappears (set them to 1 in conjunctions and to 0 in disjunctions).
%%		This yields a boolean expression that is not of the form described in \cref{thm:char-twisted-cube-to-line}, which is a contradiction.
%%		\todoi{Not necessarily!}
%		
%		\item In the case described in the previous bullet point, we conclude that $e$ is of the form $s \opA \dm j_n'$ with ${\opA} \in \accol{{\vee}, {\wedge}}$ (and $s$ may further use the same symbol $R$ in its root node).
%		Write $V = (V', \dm j_n : \_)$.
%		\begin{itemize}
%			\item If $\opA = \vee$, then we know that $\vfi \circ (0/\dm j_n) = (s/\dm i)$ is a jet cube morphism $\Opcube_i V' \to (\dm i : \rival{\jet_i})$.
%			Then by the outer induction hypothesis, $s$ is of the required form, and therefore so is $e$.
%			\item If $\opA = \wedge$, then we know that $\vfi \circ (1/\dm j_n) = (s/\dm i)$ is a jet cube morphism $V' \to (\dm i : \rival{\jet_i})$.
%			Then by the outer induction hypothesis, $s$ is of the required form, and therefore so is $e$.
%		\end{itemize}
%		
%		\item In the remaining case, all $i$-directed variables occur in the same child $t$ of $e$, if at all.
%		Thus, $e$ is of the form $t \opA s$ with $\opA \in \accol{{\vee}, {\wedge}, {\opK}}$ and $s$ depending only on $i$-symmetric variables and possibly using $\opA$ again in its root node.
%		By the inner induction hypothesis, $t$ is of the required form, and therefore so is $e$. \qedhere
%	\end{itemize}
\end{proof}
\begin{lemma} \label{thm:left-of-connection}
	In $\convjetcubetri \affine \booleanalg {\vec a}$, let $\hat \vfi : V \to W$ be a jet cube morphism and write $\vfi = \erasejc{\hat \vfi}$.
	Let $W = (W_0, \dm i : \rival{Q_i})$ with $Q \in \accol{\jet, \tej}$ and $a_i = \ypolar$.
	Let $e$ be the normal affine representant of $\dm i \psub \vfi$ and let $\dm j_1, \ldots, \dm j_n$ ($n \geq 0$) be all the variables of degree $i$ that $e$ depends on, and $\dm k_1, \ldots, \dm k_m$ ($m \geq 0$) all the other variables that $e$ depends on.
	Assume $m+n \geq 2$, so that $e$ necessarily contains a conjunction or disjunction.
	By \cref{thm:char-jet-cube-to-line}, we know that $\dm j_1, \ldots, \dm j_n$ are the \emph{last} $n$ variables of degree $i$ in $V$.
	%Order $V$ by \cref{conv:sort-cubes}, and
	Write $V = (V_0, \dm j_1 : \rival{P^1_i}, \ldots, \dm j_n : \rival{P^n_i}, V_1)$ so that (even if $n = 0$) all variables in $V_0$ have degree at least (at the strongest) $i$ and all variables in $V_1$ have degree strictly less (stronger) than $i$.
	Here, each $P^1, \ldots, P^n \in \accol{\jet, \tej}$.%
	\footnote{We could in principle allow $\equijet$ but it is easy to see that $\vfi$ being a jet cube morphism (equivalently, $\EP(\vfi)$ being a jet set) implies $P^1, \ldots, P^n \in \accol{\jet, \tej}$.}
	Define $\tilde V = (\UFsymcube_i V_0, \dm j_1 : \rival{P^1_i}, \ldots, \dm j_n : \rival{P^n_i}, V_n)$, i.e.\ every variable of degree $i$ to the left of $\dm j_1$ gets promoted to an equijet variable.
	Then $\vfi$ is a jet cube morphism $\tilde V \to W$.
\end{lemma}
%The lemma allows $P^1, \ldots, P^n \in \accol{\jet, \tej, \equijet}$, but it is easy to see that $\vfi$ being a jet cube morphism (equivalently, $\EP(\vfi)$ being a jet set) implies $P^1, \ldots, P^n \in \accol{\jet, \tej}$.
It is clear that $\dm k_1, \ldots, \dm k_m$ all occur in $V_0$ as they cannot have degree less (stronger) than $i$.

In words, this lemma says that if the last variable $\dm i$ of $W$ is substituted with an expression $e$ depending on at least two variables, then all variables in $V$ of same degree as $\dm i$ that $e$ does \emph{not} depend on, can be promoted to equijet variables.
\begin{proof}
	%Let $\dm k_1, \ldots, \dm k_m$ be all \emph{other} variables that $e$ depends on.
	For $c \in \accol{0, 1}$, let $A_c$ be the set of all $(\vec \kappa, \vec \zeta) \in \accol{0, 1}^{m+n}$ such that $\dm i \psub{\vfi} \psub{\vec \kappa / \vec{\dm k}, \vec \zeta / \vec{\dm j}} = c$.
	Let $U$ be the (ordinary) cube obtained from $\erasejc{V}$ by removing all dependencies of $e$.
	Then for any $(\vec \kappa, \vec \zeta) \in \accol{0, 1}^{m+n}$, by applying cube opposite functors in all the right places, there is a jet cube $U_{(\vec \kappa, \vec \zeta)}$ such that $\erasejc{U_{(\vec \kappa, \vec \zeta)}} = U$ and $(\vec \kappa / \vec{\dm k}, \vec \zeta / \vec{\dm j}) : U_{(\vec \kappa, \vec \zeta)} \to V$ is a jet cube morphism.
	
	Then in the category of \emph{jet cubes} and \emph{cube morphisms between their erasures}, for any $(\vec \kappa, \vec \zeta) \in A_c$, we obtain a commutative diagram
	\[
		\xymatrix{
			U_{(\vec \kappa, \vec \zeta)}
				\ar[d]_{(\vec \kappa / \vec{\dm k}, \vec \zeta / \vec{\dm j})}
				\ar@{.>}[rr]^\chi
			&&
			(\Opcube_i)^{1-c}(W_0)
				\ar[d]^{(c/\dm i)}
			\\
			V
				\ar[rr]_{\vfi}
			&&
			W
		}
	\]
	where all the black lines are jet cube morphisms and the cube morphism $\chi$ is defined as $(\dm i / \novar) \circ \vfi \circ (\vec \kappa / \vec{\dm k}, \vec \zeta / \vec{\dm j})$, which thanks to afineness does not depend on our choice of $(\vec \kappa, \vec \zeta)$, nor even on $c$.
	Commutativity of the diagram and the fact that $\JEP(c/\dm i)$ is a full jet set morphism, imply that $\chi$, too, is a jet cube morphism.
	
	We now show that $\vfi$ is a jet cube morphsim $\tilde V \to W$.
	Let $\vec v \jet_k \vec v'$ in $\tilde V$.
	We prove that $f(\vec v) \jet_k f(\vec v')$ where $f = \EP(\vfi)$.
	If $\vec v = \vec v'$ then this is trivial, so let $\dm l$ be the variable where they differ.
	If $k \neq i$ or $\dm l \not\in V_0$ then we have $\vec v \jet_k \vec v'$ in $V$ so this is preserved by $f$.
	
	Assume $k = i$ and $\dm l \in V_0$, which implies that $\dm l$ is not a dependency of $e$.
	This implies that $e \psub{\vec v} = e \psub{\vec v'} =: c$, or differently put $\dm i \psub{f(\vec v)} = \dm i \psub{f(\vec v')} = c$.
	We have $\vec v \infrajet_i \vec v'$ in $V$, say $\vec v \mathrel{S}_i \vec v'$ where $S \in \accol{\jet, \tej}$.
	This is preserved by $f$, so $f(\vec v) \mathrel{S}_i f(\vec v')$.
	Because $(c/\dm i)$ is a full jet set morphism, writing $p = \EP(\dm i / \novar)$, we can conclude that $p(f(\vec v)) \mathrel{S}_i p(f(\vec v'))$ in $(\Opcube_i)^{1-c}(W_0)$.
	
	Let $\vec u$ and $\vec u'$ be bit-assignments to the variables in $U$ obtained by projecting out all bits assigned to the dependencies of $e$ in the vectors $\vec v$ and $\vec v'$, and let $\vec \zeta$ and $\vec \kappa$ be the bits thus forgotten (which are the same for $\vec v$ and $\vec v'$).
	Thus, $\vec v = \EP(\vec \zeta/\vec{\dm j}, \vec \kappa/\vec{\dm k})(\vec u)$ and similar for $\vec v'$.
	Writing $g = \EP(\chi)$, this implies that $p(f(\vec v)) = g(\vec u)$ and $p(f(\vec v')) = g(\vec u')$.
	Thus, we have $g(\vec u) \mathrel S_i g(\vec u')$ in $(\Opcube_i)^{1-c}(W_0)$.
	
	If $\vfi$ does not depend on $\dm l$, then we have nothing to prove,
	so let $\dm h$ be the variable of $W$ such that $\dm h \psub \vfi$ depends on $\dm l$. Note that $\dm h \neq \dm i$.
%	\begin{itemize}
%		\item If $\dm h \in W_1$, then we have $g(\vec w) \mathrel S_i g(\vec w')$ in $(W_0, W_1)$.
%		\item If $\dm h \in W_0$, then the direction of the jet between $g(\vec w)$ and $g(\vec w')$ in $(W_0, W_1)$ flips with $c = e \psub{\vec v}$, which is a function of $(\vec \kappa, \vec \zeta)$.
%	\end{itemize}
	We remark that the direction of the jet between $g(\vec u)$ and $g(\vec u')$ in $(\Opcube_i)^{1-c}(W_0)$ flips with $c = e \psub{\vec v}$, which is a function of $(\vec \kappa, \vec \zeta)$.
	
	On the other hand, looking at the direction of the jet between $\vec u$ and $\vec u'$ in $U_{(\vec \kappa, \vec \zeta)}$, we see that this flips with the $\dm j_1 \veebar \ldots \veebar \dm j_n$, the exclusive disjunction of all dependencies of $e$ of degree $i$, which all appear to the right of $\dm l$.
	Now if $m+n \geq 2$, then it is impossible that the affine boolean expression $e \in \booleanalg^\#(\accol{\dm k_1, \ldots, \dm k_m, \dm j_1, \ldots, \dm j_n})$ which is in a reduced state and therefore truly depends on each of the mentioned variables, yields the exact same (or opposite) truth table as $\dm j_1 \veebar \ldots \veebar \dm j_n$.
	
	Thus, fixing $\vec u$ and $\vec u'$ and varying $(\vec \kappa, \vec \zeta)$, we see that there are assignments $(\vec \kappa, \vec \zeta)$ for which the jets between $\vec u$ and $\vec u'$ in $U_{(\vec \kappa, \vec \zeta)}$ on one hand, and between $g(\vec u)$ and $g(\vec u')$ in $(\Opcube_i)^{1-c}(W_0)$ are aligned, and others for which they are opposed.
	Pick an assignment $(\vec \kappa', \vec \zeta')$ for which they are opposed.
	We also know that $\chi$ is a jet cube morphism for any assignment $(\vec \kappa, \vec \zeta)$, and in particular for $(\vec \kappa', \vec \zeta')$.
	Thus, $\chi$ provides us the jet pointing the other way, and we can conclude that $g(\vec u) \equijet_i g(\vec u')$.
	Composing with $\EP(c/\dm i)$ for our original $c$ yields $f(\vec v) \equijet_i f(\vec v')$.
\end{proof}
\begin{corollary} \label{thm:weaken-connection}
	In $\jetcubetri \affine \booleanalg {\vec a}$, let $\hat \vfi : V \to W$ be a jet cube morphism and write $\vfi = \erasejc{\hat \vfi}$.
	Let $W = (W_0, \dm i : \rival{Q_i})$ with $Q \in \accol{\jet, \tej}$ and $a_i = \ypolar$.
	Let $e$ be the reduction of $\dm i \psub \vfi$ and assume $e$ depends on at least two variables.
	Then $(\novar/\dm i) \circ \vfi$ is a jet cube morphism $\UFsymcube_i V \to W_0$.
\end{corollary}
\begin{proof}
	We know from \cref{thm:left-of-connection} that $\vfi$ is a jet cube morphism $\tilde V \to W$.
	We first show that $(\novar / \dm i) \circ \vfi$ is a jet cube morphism $\tilde V \to W_0$.
	Write $f = \EP(\vfi)$ and $p = \EP(\novar / \dm i)$.
	Pick a non-reflexive jet $\vec v \jet_j \vec v'$ in $\tilde{V}$.
	We show that $p(f(\vec v)) \jet_j p(f(\vec v'))$ in $W_0$.
	We know that $f(\vec v) \jet_j f(\vec v')$ in $W$.
	If $j \neq i$, it follows that $p(f(\vec v)) \jet_j p(f(\vec v'))$ in $W_0$.
	If $j = i$, it follows that $p(f(\vec v)) \infrajet_i p(f(\vec v'))$ in $W_0$.
	But because $(\novar/\dm i) \circ \vfi$ only depends on $i$-symmetric variables in $\tilde{V}$, we can conclude that $p(f(\vec v)) \equijet_i p(f(\vec v'))$.
	%Hence we also have the other arrow.
	
	We conclude that $(\novar/\dm i) \circ \vfi$ is a jet cube morphism $\tilde V \to W$.
	Since it only depends on $i$-symmetric variables, there is no harm in promoting the ignored variables of degree $i$ to equijet variables, and that is all that $\UFsymcube_i V$ does.
\end{proof}

\subsubsection{Completeness} \label{sec:jetcubes:calculus:completeness}
\begin{theorem}[Completeness] \label{thm:calculus-complete}
	For $M \in \accol{\bipointedsym, \booleanalg}$ and any morphism $\hat \vfi : V \to W$ in $\convjetcubetri \affine M {\vec a}$, writing $\vfi = \erasejc{\hat \vfi}$, we have $\sez \vfi : V \to W$.
\end{theorem}
\begin{proof}
	For each variable $\dm k$ in $W$, let $e_{\dm k}$ be the normal affine representant of $\dm k \psub{\vfi}$.

	We prove completeness by induction on the number of nodes and leaves (added up) in the tuple $(e_{\dm k})_{\dm k \in W}$, plus the number of directed degrees in the mask.
	
	If $W = ()$, then use \ruleref{terminal}.
	
	If $a_i = \ypolar$ and the last variable in $W$ is $\dm i : \rival{\equijet_i}$, then $W$ is of the form $\Usymcube_i(U)$ and we can use the induction hypothesis for the corresponding morphism $\Fsymcube_i(V) \to U$ and we can use the rule \ruleref{symmetrize}.
	
	In the remaining case, the last variable in $W$ is not an equijet dimension at a directed degree, i.e.\ it is of the form $\dm i : \rival{\jet_i}$ or $\dm i : \rival{\tej_i}$.
	
	If the last variable in $V$ is of degree strictly lower (stronger) than the degree of $\dm i$, then in order to be a jet set morphism, $\JEP(\hat \vfi)$ cannot depend on that variable, so we can invoke \ruleref{wkn} until the last variable in $V$ is of degree at least $i$. We do not resort to the induction hypothesis but proceed below.
	
%	If $a_i = \npolar$, then we use \ruleref{exchange} (which is sound by \cref{thm:calculus-sound}) to reorder the variables of degree $i$ in $W$, and immediately proceed with the algorithm below.
%	We put constants last. Before that, if existent, we put the sole variable $\dm k_1$ such that $e_{\dm k_1}$ mentions the last variable of degree $i$ in $V$.
%	Before that, we put, if existent, the sole variable $\dm k_2$ such that $e_{\dm k_2}$ mentions the second to last variable of degree $i$ in $V$. Etc.
	
	We proceed by inspecting $e_{\dm i}$.
	
	\begin{itemize}
		\item If [$\dm i : \rival{\jet_i}$ and $e_{\dm i} = 0$] or [$\dm i : \rival{\tej_i}$ and $e_{\dm i} = 1$], then $\vfi$ being a jet cube morphism $V \to W = (U, \dm i : \_)$ (equivalently: $\EP(\vfi)$ being a jet set morphism $\JEP(V) \to \JEP(W)$) is equivalent to $(\novar / \dm i) \circ \vfi$ being a jet cube morphism $V \to \Opcube_i(U)$, so we can apply \ruleref{src:fwd} or \ruleref{src:bck}.
		
		\item If [$\dm i : \rival{\jet_i}$ and $e_{\dm i} = 1$] or [$\dm i : \rival{\tej_i}$ and $e_{\dm i} = 0$], then $\vfi$ being a jet cube morphism $V \to W = (U, \dm i : \_)$ (equivalently: $\EP(\vfi)$ being a jet set morphism $\JEP(V) \to \JEP(W)$) is equivalent to $(\novar / \dm i) \circ \vfi$ being a jet cube morphism $V \to U$, so we can apply \ruleref{tgt:fwd} or \ruleref{tgt:bck}.
		
		\item If $\dm i : \rival{\jet_i}$ and $e_{\dm i} = \lnot \dm j$, then $\vfi$ being a jet cube morphism $V \to W = (U, \dm i : \rival{\jet_i})$ is equivalent to $(\lnot \dm i / \dm i) \circ \vfi$ being a jet cube morphism $V \to (U, \dm i : \rival{\tej_i})$, so we can apply \ruleref{inv:fwd}.
		Similarly, if $\dm i : \rival{\tej_i}$ and $e_{\dm i} = \lnot \dm j$, we can apply \ruleref{inv:bck}.
		
		\item If $\dm i : \rival{\jet_i}$ ($\dm i : \rival{\tej_i}$ is handled analogously) and $e_{\dm i} = \dm j$ where $V$ specifies that $\dm j$ has degree $j$, then we know that $\vfi = (\chi, \dm j / \dm i)$ is a jet cube morphism $V = (V_0, \dm j : \rival{R_j}, V_1) \to W = (U, \dm i : \rival{\jet_i})$ for some $R \in \accol{\jet, \tej, \equijet}$.
		We have the following commutative diagram in the category of \emph{jet cubes} and \emph{cube morphisms between erased jet cubes}:
		\[
			\xymatrix{
				(\Opcube_j(V_0), V_1)
					\ar[d]_{(0/\dm j)}
					\ar@{.>}[rr]^\chi
				&&
				\Opcube_i(U)
					\ar[d]^{(0/\dm i)}
				\\
				(V_0, \dm j : \rival{R_j}, V_1)
					\ar[rr]_{\vfi = (\chi, \dm j / \dm i)}
				&& (U, \dm i : \rival{\jet_i})
				\\
				(V_0, V_1)
					\ar[u]^{(1/\dm j)}
					\ar@{.>}[rr]_\chi
				&&
				U
					\ar[u]_{(1/\dm i)}
			}
		\]
		We know that the black arrows are all jet cube morphisms, and the vertical arrows all yield full jet set morphisms (\cref{def:full-jetsethom}).
		This implies that the dashed arrows also lift to jet set morphisms, i.e.\ are jet cube morphisms.
		Then $\chi$ is both a jet cube morphism $(V_0, V_1) \to U$ and $\Opcube_i(\Opcube_j(V_0), V_1) \to U$.
		\begin{itemize}
			\item If $j = i$, then all variables in $V_1$ have degree $i$ and $\chi$ is both a jet cube morphism $(V_0, V_1) \to U$ and $\Opcube_i(\Opcube_i V_0, V_1) \to U$.
			This implies that $\EP(\vfi)$ sends every $i$-jet of the form $(\vec v_0, r, \vec v_1) \jet_i (\vec v_0, r, \vec v_1')$ in $\JEP(V_0, V_1)$ -- which points the other way in $\JEP(\Opcube_i(\Opcube_i V_0, V_1))$ -- to an $i$-equijet $(\EP(\chi)(\vec v_0, \vec v_1), r) \equijet_i (\EP(\chi)(\vec v_0, \vec v'_1), r)$ in $\JEP(U, \dm i : \rival{\jet_i})$.
			\begin{itemize}
				\item If $a_i = \ypolar$, then for any bit-assignment $\vec v_1$ of the variables in $V_1$, we get a jet cube morphism $(\chi \circ (\vec v_1/V_1), \dm j / \dm i) : (\Opcube_i)^p(V_0, \dm j : \rival{R_i}) \to (U, \dm i : \rival{\jet_i})$, where $p$ is the number of source constants in $\vec v$ (i.e.\ $0$ for $\rival{\jet_i}$ and $1$ for $\rival{\tej_i}$).
				This implies that $p$ is the same for all assignments $\vec v$, which is only possible if $V_1 = ()$.
				In that case, it is easy to see that $R = {\jet}$.
				Thus, we can apply \ruleref{prism:fwd}.
				
%				\todoi{Old}
%				then all $i$-equijets in $\JEP(U, \dm i : \rival{\jet_i})$ are reflexive and all elements of the form $(\vec v_0, r, \vec v_1)$ for fixed $\vec v_0$ and $r$ but variable $\vec v_1$ are $i$-infrajet-connected, so this means that $\EP(\chi)(\vec v_0, \vec v_1)$ is independent of $V_1$.
%				Then $\chi$ cannot mention any variables from $V_1$.
%				\begin{itemize}
%					\item If $V_1$ contains any variables, then we can apply \ruleref{wkn}.
%					\item Otherwise, we can apply \ruleref{prism:fwd}.
%				\end{itemize}
				
				\item If $a_i = \npolar$, then we can use \ruleref{exchange} to create a morphism from $(V_0, V_1, \dm j : \rival{\edge_i})$ instead, which can be done using \ruleref{prism:fwd} (or equivalently \ruleref{prism:bck}).
			\end{itemize}
			
			If $j > i$, then $\chi$ is necessarily a jet cube morphism $\UFsymcube_i(\UFsymcube_j(V_0), V_1) \to U$, so we can apply \ruleref{concursor}.
		\end{itemize}
		
		\item We have now covered all cases for the monad $\bipointedsym$.
		In the remaining cases, $e_{\dm i}$ contains connection (conjunction or disjunction) symbols.
		If $\dm i : \rival{\tej_i}$, we apply \ruleref{inv:fwd} and push down the introduced negation, after which we do not resort to the induction hypothesis but proceed below.\footnote{Alternatively, we could duplicate and adapt the proof below to the case where $\dm i : \rival{\tej_i}$.}
		We now assume that $\dm i : \rival{\jet_i}$.
		
		\begin{itemize}
			\item We first treat the case where $a_i = \npolar$.
			Let $\vfi = (\chi, s \opA t/\dm i)$ where $\opA \in \accol{{\vee}, {\wedge}}$ and $W = (U, \dm i : \rival{\jet_i})$.
			We claim that if $\vfi$ is a jet cube morphism $V \to W = (U, \dm i : \rival{\edge_i})$, then so are $(\chi, s/\dm i)$ and $(\chi, t/\dm i)$, so that we can invoke \ruleref{conn:sym}.
			Write
			\[
				f = \EP(\vfi), \qquad
				g = \EP(\chi), \qquad
				p = \EP(\chi, s/\dm i), \qquad
				q = \EP(\chi, t/\dm i).
			\]
			Pick a non-reflexive jet $\vec v \jet_j \vec v'$.
			We prove $p(\vec v) \jet_j p(\vec v')$; by symmetry of the situation we do not have to prove the same for $q$.
			Let $\dm k$ be the variable of $V$ where $\vec v$ and $\vec v'$ differ.
			There are four possible situations:
			\begin{itemize}
				\item If $\vfi$ does not depend on $\dm k$, then we are done.
				\item If $\chi$ depends on $\dm k$, then we have $s \psub{\vec v} = s \psub{\vec v'} =: s_0$ and $t \psub{\vec v} = t \psub{\vec v'} =: t_0$.
				\begin{itemize}
					\item If $j \neq i$, then from $(g(\vec v), s_0 \opA t_0) = f(\vec v) \jet_j f(\vec v') = (g(\vec v'), s_0 \opA t_0)$, it follows that $g(\vec v) \jet_j g(\vec v')$ in $\JEP(U)$, whence $p(\vec v) = (g(\vec v), s_0) \jet_j (g(\vec v'), s_0) = p(\vec v')$.
					\item If $j = i$, then from $(g(\vec v), s_0 \opA t_0) = f(\vec v) \edge_i f(\vec v') = (g(\vec v'), s_0 \opA t_0)$ it follows that $g(\vec v) \edge_i g(\vec v')$ in $\JEP(U)$, whence $p(\vec v) = (g(\vec v), s_0) \edge_i (g(\vec v'), s_0) = p(\vec v')$.
				\end{itemize}
				\item If $s$ depends on $\dm k$, then we have $g(\vec v) = g(\vec v') =: g_0$ and $t \psub{\vec v} = t \psub{\vec v'} =: t_0$.
				Pick a bit-assignment $\tau$ of the dependencies of $t$ such that $t \psub \tau$ reduces to the neutral element $\neutralA$ of $\opA$.\footnote{If this were not possible, then $t$ would be a constant, which is in contradiction with the assumption that $e_{\dm i}$ was normal.}
				Define $\vec x$ and $\vec x'$ by overwriting $\vec v$ and $\vec v'$ with $\tau$. Then $g(\vec x) = g(\vec x') = g_0$ and $t \psub{\vec x} = t \psub{\vec x'} = \neutralA$ and $s \psub{\vec x} = s \psub{\vec v}$ and $s \psub{\vec x'} = s \psub{\vec v'}$.
				We have $\vec x \infrajet_j \vec x'$, whence
				\[
					\begin{array}{c c c c c c c c c}
					p(\vec v)
					&=& (g_0, s \psub{\vec v})
					&=& (g_0, s \psub{\vec v} \opA \neutralA)
					&=& (g_0, s \psub{\vec x} \opA t \psub{\vec x})
					&=& f(\vec x)
					\\
					&&&&&&&& \infrajet_j
					\\
					p(\vec v')
					&=& (g_0, s \psub{\vec v'})
					&=& (g_0, s \psub{\vec v'} \opA \neutralA)
					&=& (g_0, s \psub{\vec x'} \opA t \psub{\vec x'})
					&=& f(\vec x')
					\end{array}
				\]
				in $\JEP(W, \dm i : \rival{\jet_i})$.
				Now, since these vectors only differ at $\dm i$, we can deduce equality if $j < i$ ($j$ is stronger than $i$) and otherwise that $p(\vec v) \edge_i p(\vec v')$, which implies $p(\vec v) \jet_j p(\vec v')$ since $j \geq i$ ($j$ is weaker than or equal to $i$).
				
				\item If $t$ depends on $\dm k$, then $\chi$ and $s$ do not so $p(\vec v) = p(\vec v')$ and we are done.
			\end{itemize}
			
			\item Now assume that $a_i = \ypolar$.
			Let $\vfi = (\chi, t \opA s/\dm i)$ where $\opA \in \accol{{\vee}, {\wedge}}$ and $W = (U, \dm i : \rival{\jet_i})$.
			\Cref{thm:weaken-connection} immediately tells us that $\chi$ is a jet cube morphism $\UFsymcube V \to U$.
			By \cref{thm:char-jet-cube-to-line}, we can assume that $s$ is either (the negation of) the last variable of degree $i$ in $V = (V_0, \dm i : \rival{P_i})$ with $P \in \accol{\jet, \tej}$ or a boolean expression only depending on $i$-symmetric variables.
			\begin{itemize}
				\item If $s = \dm i' \in \accol{\dm i, \lnot \dm i}$, then depending on $\opA$ we have one of the following commutative diagrams, where each arrow is a jet cube morphism but labelled with its erasure:
				\[
					\xymatrix{
						&&\Opcube_i V
							\ar[d]_{(0/\dm i)}
							\ar@/^/[rrd]^{(\chi, t/\dm i)}
						\\
						(V, \dm i : \rival{\tej_i})
							\ar@{<->}[rr]^{\cong}_{(\chi, \lnot \dm i/\dm i)}
						&&
						(V, \dm i : \rival{\jet_i})
							\ar[rr]_{(\chi, t \vee \dm i/\dm i)}
						&&
						(W, \dm i : \rival{\jet_i})
						\\
						&& V
							\ar[d]_{(1/\dm i)}
							\ar@/^/[rrd]^{(\chi, t/\dm i)}
						\\
						(V, \dm i : \rival{\tej_i})
							\ar@{<->}[rr]^{\cong}_{(\chi, \lnot \dm i/\dm i)}
						&&
						(V, \dm i : \rival{\jet_i})
							\ar[rr]_{(\chi, t \wedge \dm i/\dm i)}
						&&
						(W, \dm i : \rival{\jet_i})
					}
				\]
				Thus, we can invoke one of the rules \ruleref{conn:prism:src-neutral}, \allowbreak \ruleref{conn:prism:tgt-neutral}, \ruleref{conn:prism-inv:src-neutral}, \ruleref{conn:prism-inv:tgt-neutral}.
				
				\item If $s$ depends only on $i$-symmetric variables, then the same holds for $(\chi, s / \dm i)$. Write
				\[
					f = \EP(\vfi), \qquad
					g = \EP(\chi), \qquad
					p = \EP(\chi, s/\dm i), \qquad
					q = \EP(\chi, t/\dm i).
				\]
				We show that
				\begin{itemize}
					\item $(\chi, s / \dm i)$ is a jet cube morphism $\UFsymcube_i V \to (W, \dm i : \rival{\jet_i})$,
					\item $(\chi, t / \dm i)$ is a jet cube morphism $V \to (W, \dm i : \rival{\jet_i})$,
				\end{itemize}
				so that we can invoke \ruleref{conn:degree-symmetric}.
				
				Pick a non-reflexive jet $\vec v \jet_j \vec v'$ in $\JEP(V)$.
				We will prove $p(\vec v) \jet_j p(\vec v')$ and $q(\vec v) \jet_j q(\vec v')$ and, if $j = i$, even $p(\vec v) \equijet_j p(\vec v')$, all the time in $\JEP(W, \dm i : \rival{\jet_i})$.
				Let $\dm k$ be the variable where $\vec v$ and $\vec v'$ differ.
				There are four possibilities:
				\begin{itemize}
					\item If $\vfi$ does not depend on $\dm k$, then we are done.
					\item If $\chi$ depends on $\dm k$, then $s \psub{\vec v} = s \psub{\vec v'} =: s_0$ and $t \psub{\vec v} = t \psub{\vec v'} =: t_0$.
					\begin{description}
						\item[$\cdot$] If $j = i$, then $g(\vec v) \equijet_i g(\vec v')$ and hence $p(\vec v) = (g(\vec v), s_0) \equijet_i (g(\vec v'), s_0) = p(\vec v')$ and $q(\vec v) = (g(\vec v), t_0) \equijet_i (g(\vec v'), t_0) = q(\vec v')$ as required.
						\item[$\cdot$] If $j \neq i$, then $g(\vec v) \jet_j g(\vec v')$ and hence $p(\vec v) = (g(\vec v), s_0) \jet_j (g(\vec v'), s_0) = p(\vec v')$ and $q(\vec v) = (g(\vec v), t_0) \jet_j (g(\vec v'), t_0) = q(\vec v')$ as required.
					\end{description}
					\item If $s$ depends on $\dm k$, then $g(\vec v) = g(\vec v') =: g_0$ and $t \psub{\vec v} = t \psub{\vec v'} =: t_0$, so $q(\vec v) = q(\vec v')$.
					We pick $\tau$ and define $\vec x$ and $\vec x'$ in the same way as we did when $a_i = \npolar$ and all other circumstances were the same.
					Then we have $\vec x \infrajet_j \vec x'$ in $\JEP(V)$, whence $p(\vec v) = f(\vec x) \infrajet_j f(\vec x') = p(\vec v')$.
					Now, since these vectors only differ at $\dm i$, we can deduce equality if $j < i$ ($j$ is stronger than $i$) and otherwise that $p(\vec v) \infrajet_i p(\vec v')$.
					But since $s$ and $\chi$ only depend on $i$-symmetric variables, it must be the case that $p(\vec v) \equijet_i p(\vec v')$, as required if $i = j$, and implying $p(\vec v) \jet_j p(\vec v')$ if $j > i$.
					
					\item If $t$ depends on $\dm k$, then $g(\vec v) = g(\vec v') =: g_0$ and $s \psub{\vec v} = s \psub{\vec v'} =: s_0$, so $p(\vec v) = p(\vec v')$.
					Pick an assignment $\sigma$ of the dependencies of $s$ such that $s \psub \sigma$ reduces to the neutral element $\neutralA$ of $\opA$.
					Define $\vec y$ and $\vec y'$ by overwriting $\vec v$ and $\vec v'$ with $\sigma$.
					Then $g(\vec y) = g(\vec y') = g_0$ and $s \psub{\vec y} = s \psub{\vec y'} = \neutralA$ and $t \psub{\vec y} = t \psub{\vec v}$ and $t \psub{\vec y'} = t \psub{\vec v'}$.
					We have $\vec y \infrajet_j \vec y'$ but, since all dependencies of $s$ are $i$-symmetric, they come to the left of all $i$-directed variables, so if $i = j$ we actually still have $\vec y \jet_i \vec y'$.
					Now we have
					\[
						\begin{array}{c c c c c c c c c}
						q(\vec v)
						&=& (g_0, t \psub{\vec v})
						&=& (g_0, \neutralA \opA t \psub{\vec v})
						&=& (g_0, s \psub{\vec y} \opA t \psub{\vec y})
						&=& f(\vec y)
						\\
						&&&&&&&& \infrajet_j
						\\
						q(\vec v')
						&=& (g_0, t \psub{\vec v'})
						&=& (g_0, \neutralA \opA t \psub{\vec v'})
						&=& (g_0, s \psub{\vec y'} \opA t \psub{\vec y'})
						&=& f(\vec y')
						\end{array}
					\]
					and $q(\vec v) \jet_i q(\vec v')$ if $j = i$.
					Thus, the case $j = i$ has been handled.
					Since $q(\vec v)$ and $q(\vec v')$ can only differ at $\dm i$ which has degree $i$, we can deduce equality if $j < i$ ($j$ is stronger than $i$) and otherwise that $q(\vec v) \infrajet_i q(\vec v')$ which implies $q(\vec v) \jet_j q(\vec v')$ as required. \qedhere
				\end{itemize}
			\end{itemize}
		\end{itemize}
	\end{itemize}
\end{proof}

\subsection{The Semisymmetric Separated Product} \label{sec:jetcubes:sss}
\begin{definition} \label{def:separated-product}
	We define the \textbf{separated product} functor
	\[
		\loch * \loch : \jetset{\vec a} \times \jetset{\vec a} \to \jetset{\vec a}
	\]
	by letting $X * Y$ be the jet set with carrier $UX \times UY$ such that $(x, y) \jet_j (x', y')$ if either
	\begin{itemize}
		\item $x \jet_j x'$ and $y = y'$,
		\item $x = x'$ and $y \jet_j y'$.
	\end{itemize}
	The action on morphisms is of course faithfully inherited from the cartesian product functor on $\Set$, which indeed produces jet set morphisms between separated products.
\end{definition}
\begin{definition} \label{def:sssprod}
	Given masks $\vec a$ and $\vec b$ of equal length, if $\vec a \sqcap \vec b = \vec \npolar$, i.e. if for every $i$ we have $a_i = \npolar$ and/or $b_i = \npolar$, then we define the \textbf{semisymmetric separated product (SSS-product)} functor
	\[
		\loch \sss \loch : \convjetcubetri \mycubex M {\vec a} \times \convjetcubetri \mycubex M {\vec b} \to \convjetcubetri \mycubex M {\vec a \sqcup \vec b}
	\]
	as follows:
	\begin{itemize}
		\item %We rewrite input objects according to \cref{conv:sort-cubes}.
		The variables of a pair of objects $(V, W)$ are zipped on a per-degree basis:
		\begin{itemize}
			\item If $a_i = b_i = \npolar$, then we list all variables of degree $i$ of $V$, followed by all variables of degree $i$ of $W$, all of them typed as $\rival{\edge_i}$,
			\item If $a_i = \ypolar$ and $b_i = \npolar$, then we list all variables of degree $i$ of $W$, retyped as $\rival{\equijet_i}$, followed by all variables of degree $i$ of $V$ with their original types,
			\item If $a_i = \npolar$ and $b_i = \ypolar$, then we list all variables of degree $i$ of $V$, retyped as $\rival{\equijet_i}$, followed by all variables of degree $i$ of $W$ with their original types.
		\end{itemize}
		\begin{corollary} \label{thm:erase-sssprod}
			In $\cubecat_M^\mycubex$, we have
			\begin{align*}
				\erasejc{V \sss W} &\cong \erasejc V * \erasejc W &\text{if $\mycubex = \affine$,} \\
				\erasejc{V \sss W} &\cong \erasejc V \times \erasejc W &\text{if $\mycubex = \cartes$.}
			\end{align*}
		\end{corollary}
		\begin{corollary}
			In $\jetset{\vec a \sqcup \vec b}$, we have
			\[
				\JEP(V \sss W) \cong \Usym_{\vec a \sqsubseteq \vec a \sqcup \vec b}(V) * \Usym_{\vec b \sqsubseteq \vec a \sqcup \vec b}(W),
			\]
			where $\Usym_{\vec x \sqsubseteq \vec y} : \jetset{\vec x} \to \jetset{\vec y}$ is the forgetful functor.
		\end{corollary}
		\item Recalling \cref{def:jet-cube-cat}, the action of morphisms is established as follows:
		\begin{itemize}
			\item At the level of $\cubecat_M^\mycubex$, by relying on functoriality of the separated/cartesian product,
			\item At the level of $\jetset{\vec a \sqcup \vec b}$, by relying on functoriality of the separated product,
			\item At the level of $\Set$, both of these approaches reduce to functoriality of the cartesian product.
		\end{itemize}
	\end{itemize}
	By \cref{thm:conv-jet-cube-cat}, the SSS-product extends to non-conventional jet cubes.
\end{definition}
\begin{definition}
	Given a fixed length $\ell$, which we assume clear from the context, and a degree $0 \leq i < \ell$, we define the \textbf{punch mask} $\vec \delta^i$ by $\vec \delta^i_j = \npolar$ if $i \neq j$ and $\vec \delta^i_i = \ypolar$.
\end{definition}
Thus, $\bigsqcup_i \vec \delta^i = \vec{\ypolar}$, and more generally $\vec a = \bigsqcup_i (\vec \delta^i \sqcap \vec a)$.
\begin{theorem}[SSS-factorization] \label{sssfactorization}
	Let $\vec a$ be a mask of length $\ell$.
	For any jet cube morphism $\hat \vfi : V \to W$ in $\convjetcubetri \affine M {\vec a}$, define jet cubes $(V_i)_{0 \leq i < \ell}$ and $(W_i)_{0 \leq i < \ell}$ of mask $\vec a \sqcap \vec \delta^i$ by
	\begin{itemize}
		\item $W_i$ consists of all variables of $W$ of degree $i$, with their original typing,
		\item $V_i$ as the jet cube consisting of all variables $\dm j$ of $V_i$ such that there is a variable $\dm i \in W_i$ such that $\dm i \psub \vfi$ depends on $\dm j$. Variables of degree $i$ are kept with their original typing, unless a variable of the same degree to their right has been used at a lower (stronger) degree or is not used at all, in which case they are retyped as $\rival{\equijet_i}$. Variables of higher (weaker) degree $j>i$ are retyped as $\rival{\edge_j}$. Variables of lower degree cannot occur.
	\end{itemize}
	Then there are jet cube morphisms $\vfi_i : V_i \to W_i$ and jet cube morphisms $\rho_0$ and $\rho_1$ that erase to cube renamings\footnote{Morphisms in $\Kleisli(M)$ that come from $\Set$, i.e.\ are not effectful or do not use the constants and operators provided by $M$.}, such that $\vfi$ factorizes as:
	\[
		\xymatrix{
			V
				\ar[rr]^{\rho_0}
			&& {\bigsss_i V_i}
				\ar[rr]^{\bigsss_i \vfi_i}
			&& {\bigsss_i W_i}
				\ar[rr]^{\rho_1}_\cong
			&& W,
		}
	\]
	where $\bigsss$ denotes a semisymmetric separated product.
\end{theorem}
\begin{proof}
	%Assume $V$ and $W$ adhere to \cref{conv:sort-cubes}.

	It is immediately clear that $\bigsss_i W_i \cong W$ by an isomorphism $\rho_1$ that erases to a renaming.\footnote{In fact $\rho_1$ is the identity because we are working with conventional cubes.}
	
	We then define $\rho_0$ as the cube morphism that discards all variables unused by $\vfi$, and $\vfi_i$ as the cube morphism such that $\dm i \psub{\vfi_i \circ \rho_0} = \dm i \psub{\vfi}$ for every variable $\dm i$ in $W_i$.
	It is then immediately clear that $\vfi = \rho_1 \circ \paren{\bigsss_i \vfi_i} \circ \rho_0$.
	What remains to be proven is that $\rho_0$ and $\vfi_i$ are jet cube morphisms.
	
	In the case of $\rho_0$, this is relatively trivial: we are promoting an initial segment of the variables of every degree to equijet variables of the same degree, and then projecting away some of these.
	
	In the case of $\vfi_i$, this follows essentially from \cref{thm:left-of-concursor}.
%	
%	By \cref{thm:left-of-concursor}, any variable that is either unused, or used at a strictly lower (stronger) degree, or to the left of such a variable of the same degree, can be promoted to an equijet variable, and $\vfi$ will still be a jet cube morphism.
%	The result of these promotions, and of discarding unused variables, is exactly (up to renaming isomorphism) $\bigsss_i V_i$.
%	As only an initial segment of the variables of any given degree gets promoted to equijet variables, the renaming $\rho_0 : V \to \bigsss_i V_i$ is a jet cube morphism.
%	
%	For $\vfi_i$, first note that the weakening morphism $\pi_i$ is a jet cube morphism $W \to \Usymcube_{\vec a \sqcap \vec \delta^i \sqsubseteq \vec a} W_i$, and hence so is $\pi_i \circ \vfi$.
%	By transposition, we see that $\pi_i \circ \vfi$ is also a jet cube morphism $\Fsymcube_{\vec a \sqcap \vec \delta^i \sqsubseteq \vec a} V \to W_i$.
%	As a cube morphism, $\pi_i \circ \vfi$ factors over the weakening morphism $\xi_i : \erasejc V \to \erasejc{V_i}$ as $\pi_i \circ \vfi = \vfi_i \circ \xi_i$.
%	Now $\xi_i$ only projects out symmetric variables therefore is a jet cube morphism $\Fsymcube_{\vec a \sqcap \vec \delta^i \sqsubseteq \vec a} V \to V_i$. Moreover, $\JEP(\xi_i)$ is jet-surjective (\cref{def:jet-surjective}), so we conclude that $\vfi_i$ too must be a jet cube morphism.
\end{proof}

\subsection{Comparison to the Literature} \label{sec:jetcubes:comparison}
\subsubsection{Point category}
\begin{proposition}
	The point category (terminal category) is isomorphic to $\jetcube{\myorix}{\mycubex}{M}{[]}$.
\end{proposition}
\begin{proof}
	It is clear that $()$ is the only object.
	The only endomorphism of $()$ in $\cubecat^\mycubex_M$ is the identity, and $\erasejc \loch$ is faithful, so there is only one morphism.
\end{proof}

\subsubsection{Affine Symmetric Cubes}
I am unsure whether the category of affine symmetric cubes $\cubecat_\bipointedsym^\affine$ appears anywhere.
\begin{proposition} \label{thm:jetcubes:comparison:bipointedsym}
	The category $\cubecat_\bipointedsym^\affine$ is isomorphic to $\jetcube{\myorix}{\affine}{\bipointedsym}{[\npolar]}$ and $\jetcube{\myorix}{\cartes}{\bipointedsym}{[\npolar]}$.
\end{proposition}
\begin{proof}
	The orientation kit $\omega$ does not matter as all degrees are symmetric.
	The latter two categories are isomorphic by \cref{thm:affine-automatic}.
	It is clear that $\erasejc{\loch} : \jetcube{\myorix}{\affine}{\bipointedsym}{[\npolar]} \to \cubecat_\bipointedsym^\affine$ is bijective on objects.
	It is faithful, because $U : \jetset{[\npolar]} \to \Set$ is faithful.
	It is full, because any morphism can be derived in the calculus (\cref{fig:calculus}), as can be shown by induction on the length of the codomain.
\end{proof}

\subsubsection{Affine Cubes}
The category of affine cubes $\cubecat_\bipointed^\affine$ appears in a cubical model of HoTT \cite{bch} and its unary analogue in a cubical model of parametricity \cite{bcm}.
\begin{proposition} \label{thm:jetcubes:comparison:bipointed}
	The category $\cubecat_\bipointed^\affine$ is isomorphic to $\jetcube{\myorix}{\affine}{\bipointed}{[\npolar]}$ and $\jetcube{\myorix}{\cartes}{\bipointed}{[\npolar]}$.
\end{proposition}
\begin{proof}
	Each time, the category for $\bipointed$ is the wide\footnote{Containing all objects.} subcategory of the corresponding one for $\bipointedsym$ on morphisms that do not mention $\lnot$, so the result follows from \cref{thm:jetcubes:comparison:bipointedsym}.
\end{proof}

\subsubsection{Cartesian Cubes}
One might hope to retrieve other existing categories as follows:
\begin{itemize}
	\item De Morgan cubes $\cubecat^\cartes_\demorgan$ \cite{cubical} as $\jetcubefwd{\cartes}{\demorgan}{[\npolar]}$,
	\item Cartesian cubes $\cubecat^\cartes_\bipointed$ as $\jetcubefwd{\cartes}{\demorgan}{[\npolar]}$,
	\item Depth $n$ cubes \cite{reldtt,reldtt-techreport} as $\jetcubefwd{\cartes}{\bipointed}{[\npolar]^n}$, where $\vec x^n$ denotes the $n$-fold repetition of the list $\vec x$,
	\item \ldots
\end{itemize}
However, one cannot:
\begin{proposition}
	The morphism $(\dm i / \dm j, \dm i / \dm k) : (\dm i : \IX) \to (\dm j : \IX, \dm k : \IX)$ in $\cubecat^\cartes_M$ is not the erasure of any jet cube morphism.
\end{proposition}
\begin{proof}
	Jet sets obtained from $\JEP$ do not have diagonals.
\end{proof}

\subsubsection{Affine Depth $n$ Cubes}
\begin{definition}
	The category $\dcubeopt \mycubex M n$ has:
	\begin{itemize}
		\item As objects lists of the form $W = (\dm i_1 : \rival{k_1}, \ldots, \dm i_m : \rival{k_m})$ where the $\dm i_i$ are regarded as bound de Bruijn indices and the $k_i$ are in $\accol{0, \ldots, n-1}$.
		We define its erasure as $\erasejc W = (\dm i_1 : \IX, \ldots, \dm i_m : \IX)$.
		\item As morphisms $\hat\vfi : V \to W$, morphisms $\vfi : \erasejc V \to \erasejc W$ such that for each $\dm i : \rival{k}$ in $W$, the expression $\dm i\psub \vfi$ mentions only variables $\dm j : \rival{\ell}$ in $V$ such that $\ell \geq k$.
	\end{itemize}
	Clearly this category comes with a faithful functor $\erasejc \loch : \dcubeopt \mycubex M n \to \cubecat^\mycubex_M$.
\end{definition}
The categories $\dcubeopt \cartes \bipointed n$ appear in the model of Degrees of Relatedness \cite{reldtt,reldtt-techreport}.

\begin{proposition} \label{thm:jetcubes:comparison:depth-bipointedsym}
	The category $\dcubeopt \affine \bipointedsym n$ is isomorphic to the category $\jetcubefwd \mycubex \bipointedsym {[\npolar]^n}$ for $\mycubex \in \accol{\cartes, \affine}$.
\end{proposition}
\begin{proof}
	By \cref{thm:affine-automatic}, the value of $\mycubex$ does not matter, so let us set $\mycubex = \affine$.
	We construct a functor $F : \jetcubefwd \affine \bipointedsym {[\npolar]^n} \to \dcubeopt \affine \bipointedsym n$ such that $\erasejc \loch \circ F = \erasejc \loch$:
	\begin{itemize}
		\item $F(\dm i_1 : \rival{\edge_{k_1}}, \ldots, \dm i_m : \rival{\edge_{k_m}}) = (\dm i_1 : \rival{k_1}, \ldots, \dm i_m : \rival{k_m})$,
		\item For the action on morphisms, we have nothing to choose, we can only verify that it exists. This is done by induction on the derivation in the calculus (\cref{fig:calculus}).
	\end{itemize}
	
	It is clear that $F$ is bijective on objects, and faithful.
	Fullness is proven by proving by induction on the length of the codomain that every morphism of depth $n$ cubes can be derived in the calculus.
\end{proof}

\begin{proposition} \label{thm:jetcubes:comparison:depth-bipointed}
	The category $\dcubeopt \affine \bipointed n$ is isomorphic to the category $\jetcubefwd \mycubex \bipointed {[\npolar]^n}$ for $\mycubex \in \accol{\cartes, \affine}$.
\end{proposition}
\begin{proof}
	Each time, the category for $\bipointed$ is the wide subcategory of the corresponding one for $\bipointedsym$ on morphisms that do not mention $\lnot$, so the result follows from \cref{thm:jetcubes:comparison:depth-bipointedsym}.
\end{proof}

\subsubsection{Comparison to Pinyo and Kraus's Twisted Cube Category}
In this section, we relate jet cubes to Pinyo and Kraus's twisted cubes \cite{pinyo-twisted} when $\vec a = [\ypolar]$.
$\jetset{[\ypolar]}$ is the category of proof-irrelevant reflexive graphs.
Pinyo and Kraus use arbitrary proof-irrelevant graphs, but since $\top$ is reflexive and the twisted prism functor \cite[def.\ 4]{pinyo-twisted} restricts to reflexive graphs, all twisted cubes are reflexive graphs anyway.

Two twisted cube categories appear (up to isomorphism) in \cite{pinyo-twisted}, and we show that we can recover both.

\begin{definition} \cite[def.\ 25]{pinyo-twisted}
	The category $\twistedcubegrp$ has as objects $[\ypolar]$-jet-cubes (i.e.\ natural numbers) and as morphisms $V \to W$ all jet set morphisms (i.e. graph morphisms) $\JEP(V) \to \JEP(W)$.
\end{definition}
\begin{proposition}
	 $\twistedcubegrp$ is isomorphic to $\jetcubefwd \cartes \booleanalg {[\ypolar]}$.
\end{proposition}
\begin{proof}
	Clearly, the objects correspond.
	The morphisms $V \to W$ of $\jetcubefwd \cartes \booleanalg {[\ypolar]}$ are morphisms $f : \JEP(V) \to \JEP(W)$ such that $Uf : \EP(\erasejc V) \to \EP(\erasejc W)$ lifts to a morphism of cubes, which it always does by \cref{thm:booleanalg-ff}.
\end{proof}

We thoroughly rephrase Pinyo and Kraus's ternary twisted cube category:
\begin{definition} \cite[def.\ 34]{pinyo-twisted} \label{def:twisted-tri}
	The category $\twistedcubetri$ has as objects $[\ypolar]$-jet-cubes (i.e.\ natural numbers) and as morphisms $V \to W$ all jet set morphisms (i.e. graph morphisms) $\JEP(V) \to \JEP(W)$ or, equivalently by the previous proposition, all jet cube morphisms $V \to W$ in $\jetcubefwd \cartes \booleanalg {[\ypolar]}$,	
	 generated by the rules \ruleref{terminal}, [\ruleref{src:fwd} immediately below \ruleref{inv:bck}], \ruleref{tgt:fwd} and \ruleref{prism:fwd} in \cref{fig:calculus}.
\end{definition}
The shared reader may object that Pinyo and Kraus define the morphisms of $\twistedcubetri$ by \emph{constructing} them inductively, rather than by selecting them inductively as we do above. However:
\begin{corollary} \label{thm:twisted-tri-inductive}
	Any morphism of $\twistedcubetri$ as defined here, has a unique derivation using the given rules. \qed
\end{corollary}
\begin{proposition}
	$\twistedcubetri$ is isomorphic to $\jetcubefwd \affine \bipointedsym {[\ypolar]}$.
\end{proposition}
\begin{proof}
	Since the rules mentioned in \cref{def:twisted-tri} pertain to the calculus of $\jetcubetri \affine \bipointedsym {[\ypolar]}$ and in fact always yield premises/conclusions about $\orif$-jet-cubes for conclusions/premises about $\orif$-jet-cubes, and since $\jetcubefwd \affine \bipointedsym {[\ypolar]}$ is a faithful subcategory of $\jetcubefwd \cartes \booleanalg {[\ypolar]}$ by \cref{thm:monad-coercions-faithful}, it is clear that the identity-on-objects functor $\twistedcubetri \to \jetcubefwd \affine \bipointedsym {[\ypolar]}$ is faithful, i.e.\ we can think of $\twistedcubetri$ as a wide subcategory of $\jetcubefwd \affine \bipointedsym {[\ypolar]}$.
	
	To show fullness, we note the following facts about the calculus for $\jetcubetri \affine \bipointedsym {[\ypolar]}$:
	\begin{enumerate}
		\item No rule (read bottom-up) introduces equijets in the codomain.
		\item In absence of equijets in the codomain, no rule changes the mask (except \ruleref{symmetrize} applied to the terminal codomain, but then apply \ruleref{terminal} instead).
		\begin{itemize}
			\item In particular, \ruleref{symmetrize} is useless.
		\end{itemize}
		\item Equijet variables can only be used at strictly stronger (lower) degrees, or at the current degree $i$ if $a_i = \npolar$. Since we have only one directed degree, equijet variables cannot be used.
		\begin{itemize}
			\item Hence \ruleref{wkn} can only be used to derive constant morphisms, which can instead be derived by [\ruleref{src:fwd} after \ruleref{inv:bck}] and \ruleref{tgt:fwd}.
			\item Hence \ruleref{exchange} is useless.
		\end{itemize} 
		\item At mask $[\ypolar]$, the rule \ruleref{concursor} cannot be used as there is only one degree.
		\item Since \ruleref{inv:fwd} and \ruleref{inv:bck} are mutually inverse, they can together be freely inserted everywhere. Hence, we can replace the rule \ruleref{src:fwd} with [\ruleref{src:fwd} after \ruleref{inv:bck}].
		\item \ruleref{inv:fwd} and \ruleref{inv:bck} can be pushed up through any of the remaining rules except \ruleref{prism:fwd} and \ruleref{prism:bck}. Thus, we only involute right before using a variable.
		All other rules (still read bottom-up) do not turn an $\orif$-codomain into an $\orifbe$-codomain, i.e.\ they do not introduce opposite jets.
		Thus, we can assume the codomain is an $\orif$-jet-cube until we encounter $\lnot \dm i$.
		\item This means that until we encounter $\lnot \dm i$, we only need the rules \ruleref{terminal}, [\ruleref{src:fwd} after \ruleref{inv:bck}], \ruleref{tgt:fwd} and \ruleref{prism:fwd}.
		These do not turn an $\orif$-codomain into an $\orifbe$-codomain. Thus, until we encounter $\lnot \dm i$, we can assume the domain is an $\orif$-jet-cube.
		\item If both domain and codomain are forward, we cannot encounter $\lnot \dm i$.
	\end{enumerate}
	This means we can always rewrite a derivation tree in the calculus for $\jetcubetri \affine \bipointedsym {[\ypolar]}$ of a morphism in $\jetcubefwd \affine \bipointedsym {[\ypolar]}$ to use only the prescribed rules. 
\end{proof}

\chapter{Modalities: Polarized Reshuffles} \label{ch:modalities}
In this chapter, we pin down the Hom-posets of our mode theory.
\Cref{sec:poresh} defines the 2-poset $\poreshcat$ of polarized reshuffles, which we would like to use as our mode theory. The objects of this 2-poset will then be the modes, and as promised in the previous chapter, these are exactly anpolarity masks.
The intuitions behind the definition of $\poreshcat$ are explained at length in \cref{sec:poresh:def}.
$\poreshcat$ is a polarized version of the category of reshuffles used to define the mode theory of Degrees of Relatedness \cite{reldtt,reldtt-techreport} (\cref{thm:reshcat-poreshcat}).

In the following sections, we investigate how polarized reshuffles can act on jet sets (\cref{sec:poresh-jetset}), jet topes and presheaves over these  (\cref{sec:poresh-jettope-jtset}), and jet cubes and presheaves over these (\cref{sec:poresh-jetcube-jcset}).

For both presheaf categories, we obtain a no-go theorem (\cref{thm:poresh-jtset:nogo,thm:poresh-jcset:nogo}) that tells us that we cannot use \emph{all} of $\poreshcat$ as our mode theory. For this reason, we decide to continue with just $\poreshcat\withlr$, the 2-poset of polarized reshuffles that have both a left and a right adjoint.

\section{The 2-poset of Polarized Reshuffles} \label{sec:poresh}

\subsection{Prerequisites}
\begin{definition}
	A \textdef{2-category}, \textdef{category-enriched category} or \textdef{(2, 2)-category} $\cat C$ consists of:
	\begin{itemize}
		\item A set of objects $\Obj(\cat C)$,
		\item For each $x, y \in \Obj(\cat C)$, a \emph{category} of morphisms $\Hom(x, y)$,
		\item For each $x \in \Obj(\cat C)$, an identity morphism $\id_x \in \Obj(\Hom(x, x))$,
		\item For each $x, y, z \in \Obj(\cat C)$, a \emph{functor} $\circ : \Hom(y, z) \times \Hom(x, y) \to \Hom(x, z)$,
	\end{itemize}
	such that $\circ$ is associative and unital with respect to $\id$.
	
	We write $\catC\op$ for the category with the same objects and such that $\Hom_{\catC\op}(x, y) = \Hom_\catC(y, x)$.
	
	We write $\catC\co$ for the category with the same objects and such that $\Hom_{\catC\co}(x, y) = \Hom_{\catC}(x, y)\op$.
	
	We write $\catC\coop = (\catC\co)\op$.
\end{definition}
\begin{definition}
	A \textdef{2-poset}, \textdef{poset-enriched category} or \textdef{Hom-wise gaunt/skeletal (1, 2)-category} $\cat C$ consists of:
	\begin{itemize}
		\item A set of objects $\Obj(\cat C)$,
		\item For each $x, y \in \Obj(\cat C)$, a \emph{poset} of morphisms $\Hom(x, y)$,
		\item For each $x \in \Obj(\cat C)$, an identity morphism $\id_x \in \Hom(x, x)$,
		\item For each $x, y, z \in \Obj(\cat C)$, a \emph{monotonically increasing} map $\circ : \Hom(y, z) \times \Hom(x, y) \to \Hom(x, z)$,
	\end{itemize}
	such that $\circ$ is associative and unital with respect to $\id$.
\end{definition}

\subsection{Definitions and Properties} \label{sec:poresh:def}
In this section, we will construct a diagram of 2-posets and poset-valued profunctors between them.
Viewing poset-valued presheaves $P : \catC\op \to \Poset$ as profunctors to the terminal 2-poset $\top$, the diagram we will construct is the following:
\[
	\xymatrix{
		&& \polcat
			\ar[rrdd]|{/}^(.6){\oripsh}
			\ar@{=>}[dd]
		\\ \\
		\poreshcat
			\ar[rruu]|{\setminus}^(.4){\poldegeqtop}
			\ar[rrrr]|{|}_{\oridegeqtop}
		&&&&
		\top.
	}
\]
The 2-poset $\poreshcat$ will serve as the mode theory of Naturality Pretype Theory.
Its objects, the modes, will be anpolarity masks.
Its morphisms, the modalities, are called \textbf{polarized reshuffles} and will answer the question: for a $\mu$-modal function $f$, in order to get a $j$-jet $f(x) \jet_j f(y)$, what do I need between $x$ and $y$?
The answer $P_i$ consists of two parts: the \emph{degree} $i$ at which we need a jet between $x$ and $y$, and the \emph{orientation} $P$ of that jet.
A polarized reshuffle $\mu \in \Hom_{\poreshcat}(\vec a, \vec b)$ is merely that: a consistent answer to the above question for all degrees $j$ in the codomain mask $\vec b$.
However, if we can answer that question, we can more generally answer: in order to get $f(x) \mathrel{Q_j} f(y)$, what do I need between $x$ and $y$?
The $Q_j$ will be called an \textbf{oriented degree} for the mask $\vec b$, i.e. $Q_j \in \oridegeqtop(\vec b)$, and we can combine it with $\mu$ to get the answer $P_i$ to our question, which is an oriented degree for the domain mask $\vec a$, i.e.\ $P_i \in \oridegeqtop(\vec a)$.
The operation that answers this question, is the functorial action of the presheaf $\oridegeqtop$.

In order to be able to define $\poreshcat$ in a somewhat concise way, we start by considering what would happen if there were always only a single degree.
This leads to the 2-poset $\polcat$ whose objects are anpolarities and whose morphisms are polarities, which answer the question: in order to get $f(x) \jet f(y)$, what do I need between $x$ and $y$?
There will be 4 polarities $\isopol$, $\pospol$, $\negpol$ and $\mixpol$ which will ask for an equijet, forward jet, backward jet and an infrajet respectively.
Once we know the answer to that question, we can answer the more general question: for a $p$-polar function $f$, in order to get $f(x) \mathrel{Q} f(y)$, what do I need between $x$ and $y$?
In other words, there will be an operation combining a polarity $p$ with an orientation $Q$, producing another orientation $P$. This is the functorial action of the presheaf of orientations $\oripsh$.
Finally, a \textbf{polarized degree} $p_i$ can be regarded as a modality for a function $f : A \to B$ from a domain $A$ with multiple degrees, to a codomain $B$ with only a single degree. It answers the question: for a $p_i$-modal function $f$, in order to get $f(x) \jet f(y)$, what do I need between $x$ and $y$?
The answer consists of a degree $i$ at which a jet is needed in $A$, and a polarity telling us which way the jet should point.
This multi-single-degree function $f$ can be composed at the domain side with multi-multi-degree functions, and at the codomain side with single-single-degree functions, which explains why $\poldegeqtop$ is a profunctor.
Finally, we can generalize the above question: for a $p_i$-modal function $f$, in order to get $f(x) \mathrel{Q} f(y)$, what do I need between $x$ and $y$? Thus, we get an operation that takes an orientation $Q$ and a polarized degree $p_i$ and answers with a polarized degree $P_i$; this is the filler of the triangular diagram.
Naturality and extranaturality of this operation simply express that it is consistent with how multi-single-degree functions compose on either side.

For functions with multiple degrees in the codomain, we know that $f(x) \jet_i f(y)$ will imply $f(x) \equijet_{i+1} f(y)$.
Hence, for a modality $\mu$ to be consistent, we will require that $\jetsym_i \circ \mu \leq \equijetsym_{i+1} \circ \mu$.
Since the only informational content of $\mu$ is parametrized by a \emph{degree} $i$, we will require that $i \cdot \mu \ll (i+1) \cdot \mu$.
This is the motivation of the somewhat peculiar relation $\ll$ introduced below, which is always transitive, reflexive on symmetric objects and antireflexive on non-symmetric objects.

\subsubsection{Polarities and Orientations}
\begin{definition} \label{def:polarity-cat}
	The \textbf{2-poset of polarities} $\polcat$ has
	\begin{itemize}
		\item as objects, anpolarities, i.e.\ $\npolar$ and $\ypolar$,
		\item as morphisms, \textbf{polarities}:
		\begin{align*}
			\Hom(\ypolar, \ypolar) &= \accol{\mixpol, \pospol, \negpol, \isopol}, \\
			\Hom(\ypolar, \npolar) &= \accol{\mixpol, \isopol}, \\
			\Hom(\npolar, \ypolar) &= \accol{\mixpol = \pospol = \negpol = \isopol =: \nonpol}, \\
			\Hom(\npolar, \npolar) &= \accol{\mixpol = \pospol = \negpol = \isopol =: \nonpol}.
		\end{align*}
		In other words, all Hom-sets are a quotient of a subset of $\Hom(\ypolar, \ypolar)$.
		If the domain is $\npolar$, we identify all polarities as $\nonpol$.
		If the domain is $\ypolar$ but the codomain is $\npolar$, we remove $\pospol$ and $\negpol$.
		
		The order is always generated by the fact that $\mixpol$ is minimal and $\isopol$ is maximal.
		The identities are $\id_\ypolar = \pospol$ and $\id_\npolar = \nonpol$ and composition is defined in \cref{fig:polarity-orientation} and is monotonically increasing in both arguments.
		
		We call these polarities: $\mixpol$ mixed-polar, $\pospol$ positive, $\negpol$ negative, $\isopol$ isopolar and $\nonpol$ non-polar.
	\end{itemize}
\end{definition}
\begin{definition} \label{def:orientation-psh}
	The poset-valued \textbf{presheaf of orientations} $\oripsh : \polcat\op \to \Poset$ has, as its action on objects:
	\[
		\oripsh(a) = \accol{\equijetsym, \jetsym, \tejsym, \infrajetsym},
	\]
	where we identify all elements with $\edgesym$ if $a = \npolar$.
	The order is generated by the fact that $\equijetsym$ is minimal and $\infrajetsym$ is maximal.
	The action on morphisms $\oripsh(p)$ is denoted as $\loch \oriof p$ and given in \cref{fig:polarity-orientation}; it is monotonically increasing in both arguments.\footnote{So the domain of $\oripsh : \polcat\op \to \Poset$ has reversed 1-cells but not reversed 2-cells / inequalities.}
\end{definition}
\begin{figure}[htb]
	\[
		\begin{array}{c | c c c c}
			{\downarrow} \circ {\rightarrow} &
			          \mixpol & \pospol & \negpol & \isopol
%			        & \equijetsym & \jetsym & \tejsym & \infrajetsym
			        \\ \hline
			\mixpol & \mixpol & \mixpol & \mixpol & \isopol
%			        & \equijetsym & \equijetsym & \equijetsym & \infrajetsym
			        \\
			\pospol & \mixpol & \pospol & \negpol & \isopol
%			        & \equijetsym & \jetsym & \tejsym & \infrajetsym
			        \\
			\negpol & \mixpol & \negpol & \pospol & \isopol
%			        & \equijetsym & \tejsym & \jetsym & \infrajetsym
			        \\
			\isopol & \mixpol & \isopol & \isopol & \isopol
%			        & \equijetsym & \infrajetsym & \infrajetsym & \infrajetsym
			        \\
		\end{array}
		\qquad \qquad
		\begin{array}{c | c c c c}
			{\downarrow} \oriof {\rightarrow} &
			          \mixpol & \pospol & \negpol & \isopol
			        \\ \hline
			\equijetsym & \equijetsym & \equijetsym & \equijetsym & \infrajetsym
			        \\
			\jetsym & \equijetsym & \jetsym & \tejsym & \infrajetsym
			        \\
			\tejsym & \equijetsym & \tejsym & \jetsym & \infrajetsym
			        \\
			\infrajetsym & \equijetsym & \infrajetsym & \infrajetsym & \infrajetsym
			        \\
		\end{array}
	\]
	\caption{Composition of polarities and their action on orientations.}
	\label{fig:polarity-orientation}
\end{figure}
\begin{proposition}
	The operations in \cref{fig:polarity-orientation} are well-defined.
\end{proposition}
\begin{proof}
	We prove this for composition in $\polcat$; the proof for $\oripsh$ is analogous.
	Consider a composition $a \xrightarrow{p} b \xrightarrow{q} c$.
	Special situations may occur if either $a$, $b$ or $c$ equals $\npolar$.
	\begin{itemize}
		\item If $a = \npolar$, then $p = \nonpol$ we need to make sense of $q \circ \nonpol$, which also equals $\nonpol$.
		\item If $b = \npolar$, then $q = \nonpol$ and $p \in \accol{\mixpol, \isopol}$ and we need to make sense of $\nonpol \circ p$, which according to \cref{fig:polarity-orientation} equals $p$.
		\item If $c = \npolar$, then $q \in \accol{\mixpol, \isopol}$ and the same needs to hold for $q \circ p$, which is indeed the case. \qedhere
	\end{itemize}
\end{proof}
\begin{proposition}
	Composition of polarities is unital and associative.
	In fact, composition of a sequence of $n \geq 0$ polarities can be characterized as follows:
	\begin{itemize}
		\item If any of the operands is either $\mixpol$ or $\isopol$, then the result is $\mixpol$ or $\isopol$, whichever occurs most to the right.
		\item If all of the operands are either $\pospol$ or $\negpol$, then the result is $\negpol$ if $\negpol$ occurs as an operand an odd number of times, and $\pospol$ otherwise. \qed
	\end{itemize}
\end{proposition}
\begin{proposition}
	The presheaf of orientations $\oripsh$ is isomorphic to the Yoneda-embedding $\yoneda(\ypolar) = \Hom(\loch, \ypolar)$ of $\ypolar$ in two ways: by identifying $\pospol$ with either $\jetsym$ or $\tejsym$. 
	
	In particular, it satisfies the presheaf laws: it respects identity and composition of polarities. \qed
\end{proposition}
\begin{proposition}
	\label{thm:pol-lattice}
	\label{thm:ori-lattice}
	\label{thm:pol-pol-lattice}
	\label{thm:ori-pol-lattice}
	Each constituent poset $\Hom(a, b)$ of $\polcat$ and each constituent poset $\oripsh(a)$ of $\oripsh$ is a lattice.
	Composition of polarities and their action on orientations both preserve meets and joins in the \emph{left} argument. \qed
\end{proposition}
Note that the fact that $\loch \circ \loch$ and $\loch \oriof \loch$ preserve meets and joins in their left argument, is easy to explain from the intuitions in \cref{sec:poresh:def}.
Indeed, $(P \vee Q) \oriof p$ answers the question: for a $p$-polar single-single degree function $f$, in order to have either $f(x) \mathrel{P} f(y)$ or $f(x) \mathrel{Q} f(y)$, what do I need between $x$ and $y$?
The answer is: either the weakest precondition $P \oriof p$ of $f(x) \mathrel{P} f(y)$, or the weakest precondition $Q \oriof p$ of $f(x) \mathrel{Q} f(y)$, i.e.\ you need $(P \oriof p) \vee (Q \oriof p)$.
The argument for meets and for $\loch \circ \loch$ is similar.
\begin{definition}
	We call a polarity $p : a \to b$ \textbf{symmetric} if $\tejsym \oriof p = \jetsym \oriof p$, which is the case if $a = \npolar$ or $b = \npolar$ or $p \in \accol{\isopol, \mixpol}$.
	
	For $p, q : a \to b$, we write $p \ll q$ if one of the following, equivalent conditions is satisfied:
	\begin{enumerate}
		\item $\jetsym \oriof p \leq \jetsym \oriof q$ and $\jetsym \oriof p \leq \tejsym \oriof q$,
		\item $\jetsym \oriof p \leq \jetsym \oriof q$ and $\tejsym \oriof p \leq \jetsym \oriof q$,
		\item $\jetsym \oriof p \leq \equijetsym \oriof q$,
		\item $\infrajetsym \oriof p \leq \jetsym \oriof q$,
		\item $\infrajetsym \oriof p \leq \equijetsym \oriof q$,
		\item $p \leq q$ and at least either of them is symmetric.
	\end{enumerate}
\end{definition}
\begin{proof}[Proof of equivalence]
	\begin{description}
		\item[$1 \Leftrightarrow 2$] This is easy to check manually.
		\item[$1 \Leftrightarrow 3$] By the universal property of the meet, and the fact that $\loch \oriof q$ preserves meets.
		\item[$2 \Leftrightarrow 4$] By the universal property of the join, and the fact that $\loch \oriof p$ preserves joins.
		\item[$1 \wedge 2 \Leftrightarrow 5$] By similar reasoning as the two previous points.
		\item[$1 \Rightarrow 6$] Condition 1 implies $p \leq q$ because $\jetsym \oriof \loch$ is an isomorphism of posets. If $p \leq q$ but neither is symmetric, then $p = q \in \accol{\pospol \neq \negpol}$, contradicting 1.
		\item[$6 \Rightarrow 1 \vee 2$] We can immediately prove either 1 or 2 depending on whether $p$ or $q$ is symmetric. \qedhere
	\end{description}
\end{proof}
\begin{definition}
	We call an orientation $P \in \oripsh(a)$ \textbf{symmetric} if $a = \npolar$ or $P \in \accol{\equijetsym, \infrajetsym}$.
	
	For $P, Q \in \oripsh(a)$, we write $P \ll Q$ if $P \leq Q$ and at least either of them is symmetric.
\end{definition}

\subsubsection{Polarized Degrees}
\begin{definition}
	Given an anpolarity mask $\vec a$, we define the following posets of \textbf{degrees}:
	\begin{itemize}
		\item $\Deg(\vec a) = \accol{0 \leq 1 \leq \ldots \leq \lenpol{\vec a} - 1}$,
		\item $\Degeq(\vec a) = \accol{\eqtydeg \leq 0 \leq 1 \leq \ldots \leq \lenpol{\vec a} - 1}$,
		\item $\Degeqtop(\vec a) = \accol{\eqtydeg \leq 0 \leq 1 \leq \ldots \leq \lenpol{\vec a} - 1 \leq \top}$.
	\end{itemize}
	We generalize the notation $a_i$ to generalized degrees $i$ by setting $a_\eqtydeg = a_\top = \npolar$.
\end{definition}
\begin{definition} \label{def:poldeg}
	Given an anpolarity mask $\vec a$ and an anpolarity $b$, we define the following posets of \textbf{polarized degrees}:
	\begin{itemize}
		\item $\poldeg(\vec a, b) = \Sigma(i \in \Deg(\vec a)).\Hom_\polcat(a_i, b)$ with dictionary order,
		\item $\poldegeq(\vec a, b)$ and $\poldegeqtop(\vec a, b)$ similarly.
	\end{itemize}
	We denote a dependent pair $(i, p)$ of a degree $i$ and a polarity $p$ as $\dpol i p$ and write $\getdeg(\dpol i p) = i$ and $\getpol(\dpol i p) = p$.
	
	We write $\dpol i p \ll \dpol j q$ if \textbf{EITHER} $i < j$ \textbf{OR} $i = j$ and $p \ll q$.
	
	We make $\poldeg(\vec a, b)$ a covariant 2-functor of $b \in \Obj(\polcat)$ by defining $q \circ (\dpol i p) = \dpol i {(q \circ p)}$, and similar for $\poldegeq(\vec a, b)$ and $\poldegeqtop(\vec a, b)$.
\end{definition}
\begin{corollary}
	The functor $\poldeg(\vec a, \loch)$ (as well as $\poldegeq(\vec a, \loch)$ and $\poldegeqtop(\vec a, \loch)$) respects identity and composition of polarities.
\end{corollary}
\begin{proof}
	This is immediately inherited from associativity and unitality of $\polcat$.
\end{proof}
\begin{corollary} \label{thm:pol-poldeg-lattice}
	The functorial action $q \circ (\pdeg p i)$ of polarities on polarized degrees, preserves meets and joins in its left argument. \qed
\end{corollary}
\begin{proposition} \label{thm:poldeg-lattice}
	Each poset $\poldeg(\vec a, b)$, $\poldegeq(\vec a, b)$ and $\poldegeqtop(\vec a, b)$ is a lattice.
\end{proposition}
\begin{proof}
	To take the meet/join of polarized degrees with different degrees, simply take the operand with the lowest/highest degree.
	To take the meet/join of polarized degrees with the same degree, take the meet/join of the polarities.
\end{proof}

\subsubsection{Polarized Reshuffles}
\begin{definition}\label{def:poreshcat}
	We define the 2-poset $\poreshcat$ of \textbf{polarized reshuffles} as follows:
	\begin{itemize}
		\item Objects are anpolarity masks.
		\item Morphisms $\mu : \vec a \to \vec b$ are functions
		\[
			\loch \cdot \mu : (j : \Degeq(\vec b)) \to \poldegeqtop(\vec a, b_j)
		\]
		such that if $j < j'$, then $j \cdot \mu \ll j' \cdot \mu$.
%		\item Morphisms $\mu : \vec a \to \vec b$ consist of:
%		\begin{itemize}
%			\item A monotonically increasing function $\getdeg(\mu) : \Degeq(\vec b) \to \Degeqtop(\vec a) : j \mapsto \getdeg(j \cdot \mu)$,
%			\item A function $\getpol(\mu) : (j \in \Degeqtop(\vec b)) \to \Hom_{\polcat}(a_{\getdeg(j \cdot \mu)}, b_j) : j \mapsto \getpol(j \cdot \mu)$,
%			\item Such that if $j < j'$ then \textbf{EITHER} $\getdeg(j \cdot \mu) < \getdeg(j' \cdot \mu)$ \textbf{OR} $\getdeg(j \cdot \mu) = \getdeg(j' \cdot \mu)$ and $\getpol(j \cdot \mu) \ll \getpol(j' \cdot \mu)$.
%		\end{itemize}
%		Let $\getdeg(j \cdot \mu) = i$ and $\getpol(j \cdot \mu) = p$. Then we write $j \cdot \mu = i_p$, with $\getdeg(i_p) = i$ and $\getpol(i_p) = p$.
%		We abbreviate the last condition above as $j \cdot \mu \ll j' \cdot \mu$.
		\begin{itemize}
			\item We extend the domain of $\loch \cdot \mu$ to $\Degeqtop(\vec b)$ by setting $\top \cdot \mu = \dpol \top \nonpol$. \\
			This maintains the property that $i < j$ implies $i \cdot \mu \ll j \cdot \mu$.
			\item Given an anpolarity $c$, we lift $\loch \cdot \mu$ to a function
			\begin{equation} \label{eq:poldeg-poresh}
				\loch \circ \mu : (\dpol j q : \poldegeqtop(\vec b, c)) \to \poldegeqtop(\vec a, c) : \dpol j q \mapsto q \circ (j \cdot \mu).
			\end{equation}
			This has the property that if $\dpol j q \ll \dpol{{j'}}{q'}$, then $\dpol j q \circ \mu \ll \dpol{{j'}}{q'} \circ \mu$.
			\item The identity $\id : \vec a \to \vec a$ is given by $i \cdot \id := \dpol i \pospol$.
			\item Composition $\nu \circ \mu$ is given by $i \cdot (\nu \circ \mu) := (i \cdot \nu) \circ \mu$.
		\end{itemize}
		\item Inequality of morphisms is considered pointwise, i.e.\ $\mu \leq \nu$ if for all $j$, we have $j \cdot \mu \leq j \cdot \nu$.
	\end{itemize}
	We will also denote modalities $\mu : \vec a \to \vec b$ as $\mu = \reshlist{\eqtydeg \cdot \mu}{0 \cdot \mu, \ldots, (\lenpol{\vec a} - 1) \cdot \mu}$, e.g.\ $\id_{[\ypolar, \npolar, \ypolar]} = \reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \pospol 0, \pdeg \nonpol 1, \pdeg \pospol 2}$.
\end{definition}
\begin{corollary} \label{thm:deg-vs-poldeg-poresh}
	We have $\pospol_j \circ \mu = j \cdot \mu$. \qed
\end{corollary}
\begin{proposition}
	$\poldegeqtop$ is a profunctor from $\poreshcat$ to $\polcat$, i.e.\ a 2-functor $\poldegeqtop : \poreshcat\op \times \polcat \to \Poset$.
\end{proposition}
%\begin{definition}
%	We already know that $\Degeqtop(\vec a, b)$ is a covariant 2-functor of $b \in \Obj(\polcat)$. We make it a contravariant 2-functor of $\vec a \in \Obj(\poreshcat)$, i.e. a profunctor $\Degeqtop : \poreshcat\op \times \polcat \to \Poset$, with the functorial action given by $\loch \circ \loch$.
%\end{definition}
We do not have the same result for $\poldeg$, and do not bother for $\poldegeq$.
\begin{proof}
	We already knew that it was covariant in its second argument.
	Contravariance in the first argument is given by the action $\loch \circ \mu$ on polarized degrees.
	To see that it respects the identity:
	\begin{align*}
		\pdeg p i \circ \id
		&= p \circ (i \cdot \id)
		= p \circ (\pdeg \pospol i)
		= \pdeg {(p \circ \pospol)}{i}
		= \pdeg p i.
	\end{align*}
	To see that functoriality on both sides commutes:
	\begin{align*}
		(r \circ \pdeg q j) \circ \mu
		&= \pdeg{(r \circ q)}{j} \circ \mu 
		& \text{(\cref{def:poldeg})} \\
		&= (r \circ q) \circ (j \cdot \mu)
		& \text{(\cref{eq:poldeg-poresh})} \\
		&= r \circ (q \circ (j \cdot \mu))
		& \text{($\poldegeqtop$ respects comp.\ of polarities)} \\
		&= r \circ (\pdeg q j \circ \mu)
		& \text{(\cref{eq:poldeg-poresh})}&.
	\end{align*}
	For composition:
	\begin{align*}
		\pdeg r k \circ (\nu \circ \mu)
		&= r \circ (k \cdot (\nu \circ \mu)) 
		& \text{(\cref{eq:poldeg-poresh})} \\
		&= r \circ ((k \cdot \nu) \circ \mu)
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
%		&= r \circ (\pdeg q j \circ \mu)
%		& \text{(let $\pdeg q j := k \cdot \nu$)} 
%		& \text{(\cref{eq:poldeg-poresh})} \\
%		&= r \circ (q \circ (j \cdot \mu))
		&= (r \circ (k \cdot \nu)) \circ \mu 
		& \text{(functoriality of $\poldegeqtop$ on both sides commutes)} \\
		&= (\pdeg r k \circ \nu) \circ \mu
		& \text{(\cref{eq:poldeg-poresh})}&.
		& \qquad \qedhere
	\end{align*}
\end{proof}
\begin{proposition}
	Composition in $\poreshcat$ is unital and associative.
\end{proposition}
\begin{proof}
	For the right unit law, we have:
	\begin{align*}
		i \cdot (\mu \circ \id)
		&= (i \cdot \mu) \circ \id
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
		&= i \cdot \mu
		& \text{($\poldegeqtop$ respects the identity)}&.
	\end{align*}
	For associativity, we have:
	\begin{align*}
		i \cdot (\rho \circ (\nu \circ \mu))
		&= (i \cdot \rho) \circ (\nu \circ \mu)
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
		&= ((i \cdot \rho) \circ \nu) \circ \mu
		& \text{($\poldegeqtop$ respects composition)} \\
		&= (i \cdot (\rho \circ \nu)) \circ \mu
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
		&= i \cdot ((\rho \circ \nu) \circ \mu)
		& \text{(def.\ of comp.\ in $\poreshcat$)}&.
	\end{align*}
	For the left unit law, we have
	\begin{align*}
		i \cdot (\id \circ \mu)
		&= (i \cdot \id) \circ \mu
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
		&= \pospol_i \circ \mu
		& \text{(def.\ of $\id$ in $\poreshcat$)} \\
%		&= \pospol \circ (i \cdot \mu)
%		& \text{(\cref{eq:poldeg-poresh})} \\
		&= i \cdot \mu
		& \text{(\cref{thm:deg-vs-poldeg-poresh})}&.
		\qquad \qedhere
	\end{align*}
\end{proof}
\begin{proposition}
	\label{thm:poresh-lattice}
	\label{thm:poldeg-poresh-lattice}
	\label{thm:poresh-poresh-lattice}
	\begin{enumerate}
		\item Each Hom-set of $\poreshcat$ is a lattice.
		\item The action $\pdeg q j \circ \mu$ of polarized degrees on polarized reshuffles, preserves meets and joins in its left argument.
		\item Composition of polarized reshuffles, preserves meets and joins in its left argument.
	\end{enumerate}
\end{proposition}
\begin{proof}
	\begin{enumerate}
		\item We can take meets/joins pointwise.
		\item For polarized degrees with different degrees, meets/joins amount to minima/maxima, which are preserved by any poset morphism.
		For polarized degrees with the same degree, this follows, via \cref{eq:poldeg-poresh}, from \ref{thm:pol-poldeg-lattice}.
		\item Follows immediately from the previous two points and the definition of composition of polarized reshuffles. \qedhere
	\end{enumerate}
\end{proof}

\subsubsection{Oriented Degrees}
\begin{definition}
	Given an anpolarity mask $\vec a$, we define the following posets of \textbf{oriented degrees}:
	\begin{itemize}
		\item $\orideg(\vec a) = \Sigma(i \in \Deg(\vec a)).\oripsh(a_i)$ with dictionary order,
		\item $\oridegeq(\vec a)$ and $\oridegeqtop(\vec a)$ similarly.
	\end{itemize}
	We denote a dependent pair $(i, P)$ of a degree $i$ and an orientation $P$ as $\odeg P i$ and write $\getdeg(\odeg P i) = i$ and $\getori(\odeg P i) = P$.
	
	We write $\odeg P i \ll \odeg Q j$ if \textbf{EITHER} $i < j$ \textbf{OR} $i = j$ and $P \ll Q$.
	
	We define a transformation, extranatural in $b$ (\cref{thm:ori-poldeg-extranatural}):
	\begin{equation}
		\loch \oriof \loch : \oripsh(b) \times \poldegeqtop(\vec a, b) \to \oridegeqtop(\vec a) : Q \oriof (\pdeg p i) = \odeg{(Q \oriof p)}{i}, \label{eq:ori-poldeg}
	\end{equation}
	and similar operations for $\poldegeq$ and $\poldeg$.
	
	Using this, we make $\oridegeqtop$ (but not $\orideg$ and $\oridegeq$) a presheaf by defining an operation
	\begin{equation} \label{eq:orideg-poresh}
		\loch \oriof \loch : \oridegeqtop(\vec b) \times \Hom_{\poreshcat}(\vec a, \vec b) \to \oridegeqtop(\vec a) : Q_j \oriof \mu = Q \oriof (j \cdot \mu),
	\end{equation}
	which preserves identity and composition (\cref{thm:orideg-functor-laws}).
	We can now observe that the action in \cref{eq:ori-poldeg} is natural in $\vec a$ (\cref{thm:ori-poldeg-natural}).
\end{definition}
\begin{proposition} \label{thm:ori-poldeg-extranatural}
	The action in \cref{eq:ori-poldeg} is extranatural in $b$.
\end{proposition}
\begin{proof}
	This is immediately inherited from functoriality of $\oripsh$:
	\begin{align*}
		(R \oriof q) \oriof (\pdeg p i)
		&= \pdeg{((R \oriof q) \oriof p)}{i}
		& \text{(\cref{eq:ori-poldeg})} \\
		&= \pdeg{(R \oriof (q \circ p))}{i}
		& \text{($\oripsh$ respects comp.\ of polarities)} \\
		&= R \oriof (\pdeg{(q \circ p)}{i})
		& \text{(\cref{eq:ori-poldeg})} \\
		&= R \oriof (q \circ (\pdeg p i))
		& \text{(\cref{def:poldeg})} &. \qquad \qedhere
	\end{align*}
\end{proof}
\begin{proposition} \label{thm:ori-poldeg-natural}
	The action in \cref{eq:ori-poldeg} is natural in $\vec a$.
\end{proposition}
\begin{proof}
	\begin{align*}
		(R \oriof \pdeg q j) \oriof \mu 
		&= \odeg{(R \oriof q)}{j} \oriof \mu 
		& \text{(\cref{eq:ori-poldeg})} \\
		&= (R \oriof q) \oriof (j \cdot \mu)
		& \text{(\cref{eq:orideg-poresh})} \\
		&= R \oriof (q \circ (j \cdot \mu))
		& \text{(\cref{thm:ori-poldeg-extranatural})} \\
		&= R \oriof (\pdeg q j \circ \mu)
		& \text{(\cref{eq:poldeg-poresh})} &. \qquad \qedhere
	\end{align*}
\end{proof}
\begin{proposition} \label{thm:orideg-functor-laws}
	The functorial action of $\oridegeqtop$ respects identity and composition of polarized reshuffles.
\end{proposition}
\begin{proof}
	For the identity, we have
	\begin{align*}
		\odeg P i \oriof \id
		&= P \oriof (i \cdot \id)
		& \text{(\cref{eq:orideg-poresh})} \\
		&= P \oriof (\pdeg \pospol i)
		& \text{(def.\ of $\id$ in $\poreshcat$)} \\
		&= \odeg{(P \oriof \pospol)}{i}
		& \text{(\cref{eq:ori-poldeg})} \\
		&= \odeg P i
		& \text{($\oripsh$ respects identity polarity)} &.
	\end{align*}
	For composition, we have
	\begin{align*}
		\odeg R k \oriof (\nu \circ \mu)
		&= R \oriof (k \cdot (\nu \circ \mu))
		& \text{(\cref{eq:orideg-poresh})} \\
		&= R \oriof ((k \cdot \nu) \circ \mu)
		& \text{(def.\ of comp.\ in $\poreshcat$)} \\
		&= (R \oriof (k \cdot \nu)) \oriof \mu 
		& \text{(\cref{thm:ori-poldeg-natural})} \\
		&= (\odeg R k \oriof \nu) \oriof \mu 
		& \text{(\cref{eq:orideg-poresh})} &. \qquad \qedhere
	\end{align*}
\end{proof}
\begin{proposition}
	\label{thm:orideg-lattice}
	\label{thm:ori-poldeg-lattice}
	\label{thm:orideg-poresh-lattice}
	\begin{enumerate}
		\item Each poset $\orideg(\vec a)$, $\oridegeq(\vec a)$ and $\oridegeqtop(\vec a)$ is a lattice.
		\item The action in \cref{eq:ori-poldeg} preserves meets and joins in its left argument.
		\item The action in \cref{eq:orideg-poresh} preserves meets and joins in its left argument.
	\end{enumerate}
\end{proposition}
\begin{proof}
	\begin{enumerate}
		\item To take the meet/join of oriented degrees with different degrees, simply take the operand with the lowest/highest degree. To take the meet/join of oriented degrees with the same degree, take the meet/join of the orientations.
		\item Trivial from \cref{thm:ori-pol-lattice}.
		\item For oriented degrees with different degrees, meets/joins amount to minima/maxima, which are preserved by any poset morphism. For oriented degrees with the same degree, this follows, via \cref{eq:orideg-poresh}, from the previous point. \qedhere
	\end{enumerate}
\end{proof}

\subsubsection{Discussion and Related Work}
\paragraph{When Everything is Symmetric}
If we forget about the existence of the anpolarity $\ypolar$, then $\polcat$ becomes a 2-poset with only a single object $\npolar$ and a single morphism $\nonpol \in \Hom_\polcat(\npolar, \npolar)$.
The presheaf $\oripsh$ is then just a poset $\oripsh(\npolar)$ containing only a single orientation $\edgesym$.
An anpolarity mask $\vec a$ is always of the form $[\npolar]^n$, i.e.\ it is just a natural number.
Furthermore, we have
\[
	\poldegeqtop([\npolar]^n, \npolar) \cong \oridegeqtop([\npolar]^n) \cong \Degeqtop([\npolar]^n).
\]
Finally, a polarized reshuffle $\mu \in \Hom_\poreshcat([\npolar]^m, [\npolar]^n)$ is essentially just a function
\[
	\loch \cdot \mu : \Degeq([\npolar]^n) \to \Degeqtop([\npolar]^m).
\]
Thus, we have retrieved exactly the 2-poset of (ordinary) reshuffles from Degrees of Relatedness \cite{reldtt,reldtt-techreport}:
\begin{definition}[{\cite[def.\ 6.2.7]{reldtt-techreport}}]
	The \textbf{2-poset of reshuffles} $\reshcat$ has:
	\begin{itemize}
		\item as objects, \textbf{depths}, which are integers $d \geq -1$,
		\item as morphisms $\mu \in \Hom_\reshcat(d, e)$, functions
		\[
			\loch \cdot \mu : \accol{\eqtydeg \leq 0 \leq \ldots \leq e} \to \accol{\eqtydeg \leq 0 \leq \ldots \leq d \leq \top},
		\]
		\item pointwise inequalities.
	\end{itemize}
\end{definition}
\begin{theorem} \label{thm:reshcat-poreshcat}
	There is an embedding $I : \reshcat \to \poreshcat$ of the 2-poset of reshuffles $\reshcat$ from \cite[def.\ 6.2.7]{reldtt-techreport} into $\poreshcat$ which
	\begin{itemize}
		\item sends the depth $d \geq -1$ to the anpolarity mask $I(d) = [\npolar]^{d+1}$,
		\item sends the reshuffle $\mu \in \Hom_\reshcat(d, e)$ to the polarized reshuffle $I(\mu) \in \Hom_\poreshcat([\npolar]^{d+1}, [\npolar]^{e+1})$
		such that $i \cdot I(\mu) = \pdeg{\nonpol}{i \cdot \mu}$.
	\end{itemize}
	The action of the 2-functor $I$ on every $\Hom$-poset is an isomorphism of posets. \qed
\end{theorem}

\paragraph{When Everything is Directed}
If we forget about the existence of the anpolarity $\npolar$, then $\polcat$ becomes a 2-poset with a single object $\ypolar$, i.e.\ fully determined by the ordered monoid $\Hom_\polcat(\ypolar, \ypolar) = \accol{\isopol, \pospol, \negpol, \mixpol}$.

This ordered monoid has a semantics in endofunctors on $\Cat$, sending $\pospol$ to the identity functor, $\negpol$ to taking the opposite, $\isopol$ to taking the localization (which makes all morphisms invertible) and $\mixpol$ to taking the core (which discards all non-invertible morphisms).

\emph{Almost} the same ordered monoid is used by Abel \cite{abel-polarized} (who writes $\top$ for $\isopol$ and $\circ$ for $\mixpol$),
in my master thesis \cite{nuyts-phd} (where I write $=$ for $\isopol$)
and in our earlier work on polarities for Agda \cite{abstract-agda-polarities} (ignoring the strictly positive modality; there we write $*$ or \texttt{mixed} for $\mixpol$ and \texttt{unused} for $\isopol$).
However, there is a subtle difference in that all of the cited work has $\isopol \circ \mixpol = \isopol$, whereas we have $\isopol \circ \mixpol = \mixpol$.
The variation with $\isopol \circ \mixpol = \isopol$ has a semantics in endofunctors on $\Cat$ where we model $\isopol$ not as taking the localization, but as squashing to a (sub)singleton.
Alternatively, it has a semantics on the category of pro-arrow equipments \cite{nlab:proarrow,proarrow1,proarrow2} where $\pospol$ is still the identity, $\negpol$ and $\mixpol$ take the opposite and core (resp.) of the arrow dimension, and $\isopol$ replaces the arrow dimension with the core of the pro-arrow dimension.

For us, pro-arrows will live at a different degree than arrows, and a modality that replaces the arrow relation with the core of the pro-arrow relation, will make crucial use of the \emph{reshuffling} aspect of polarized reshuffles.
%, and our \emph{polarities} (as opposed to polarized reshuffles) are concerned with only a single degree.
Similarly, a squashing operation can be represented by a modality $\mu$ such that $\eqtydeg \cdot \mu = \nonpol_\top$.
Our \emph{polarities}, on the contrary, are concerned with only a single degree, and as such we stick to the interpretation of $\isopol$ as promoting infrajets to jets (hence equijets, by symmetry of infrajets), much like the localization does.
%Moreover, we do not think of $\isopol$ as a squashing or `unused' modality, but rather as a modality for functions that promote morphisms to isomorphisms, as the localization does.
This leads to the equality $\isopol \circ \mixpol = \mixpol$.

The presheaf of orientations $\oripsh$ is just a single poset $\oripsh(\ypolar) = \accol{\equijetsym, \jetsym, \tejsym, \infrajetsym}$ on which the ordered monoid of polarities has a right action.

An anpolarity mask $\vec a$ is always of the form $[\ypolar]^n$, i.e.\ it is just a natural number.
A polarized/oriented degree $\pdeg p i \in \poldegeqtop([\ypolar]^n, \ypolar)$ or $\odeg P i \in \oridegeqtop([\ypolar]^n)$ is now just a (non-dependent) pair of a degree and a polarity/orientation.

For purposes of illustration, we list all polarized reshuffles in $\Hom_\poreshcat([\ypolar], [\ypolar])$:
\[
	\begin{array}{l l l l}
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \nonpol \eqtydeg} \\
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \mixpol 0} &
		\reshlist{\pdeg \mixpol 0}{\pdeg \mixpol 0} \\
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \pospol 0} &
		\reshlist{\pdeg \mixpol 0}{\pdeg \pospol 0} \\
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \negpol 0} &
		\reshlist{\pdeg \mixpol 0}{\pdeg \negpol 0} \\
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \isopol 0} &
		\reshlist{\pdeg \mixpol 0}{\pdeg \isopol 0} &
		\reshlist{\pdeg \isopol 0}{\pdeg \isopol 0} \\
		\reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \nonpol \top} &
		\reshlist{\pdeg \mixpol 0}{\pdeg \nonpol \top} &
		\reshlist{\pdeg \isopol 0}{\pdeg \nonpol \top} &
		\reshlist{\pdeg \nonpol \top}{\pdeg \nonpol \top},
	\end{array}
\]
where the identity is $\id_{[\ypolar]} = \reshlist{\pdeg \nonpol \eqtydeg}{\pdeg \pospol 0}$.

%\subsubsection{Old Stuff}
%\todoi{Old stuff}
%\begin{definition}\label{def:orisymbol}
%	Let $a \in \Anpolarity$ be an anpolarity.
%	We define the sets of \textbf{$a$-orientations} and \textbf{$a$-polarities} as
%	\[
%		\oripshnodegree(a) = \accol{\jetsym, \tejsym, \equijetsym, \infrajetsym},
%		\qquad
%		\polcatnodegree(a) = \accol{\pospol, \negpol, \isopol, \mixpol},
%	\]
%	where we identify all elements if $a = \npolar$, i.e.\ $\oripshnodegree(\npolar) = \accol{\edgesym}$ and $\polcatnodegree(\npolar) = \accol{\nonpol}$.
%	
%	Let $\vec a$ be an anpolarity mask.
%	We define the set of \textbf{$\vec a$-orientations} as
%	\[
%		\oripsh(\vec a) = \set{P_i}{P \in \oripshnodegree, 0 \leq i < \lenpol{\vec a}} \cup \accol{\eqtysym, \topsym},
%	\]
%	where we identify $\jetsym_i = \tejsym_i = \equijetsym_i = \infrajetsym_i =: \edgesym_i$ if $a_i = \npolar$.
%	We write $\deg(P_i) := i$.
%	
%	We define the subset of \textbf{forward $\vec a$-orientations} as
%	\[
%		\oripshfwd(\vec a) = \set{\jetsym_i}{0 \leq i < \lenpol{\vec a}} \cup \accol{\eqtysym} \subseteq \oripsh(\vec a).
%	\]
%	(Note the removal of $\topsym$.)
%	
%	On $\oripsh(\vec a)$, we define a partial order generated by
%	\[
%		\eqtysym \leq P_i \leq \topsym, \qquad
%		\equijetsym_i \leq \jetsym_i \leq \infrajetsym_i, \qquad
%		\equijetsym_i \leq \tejsym_i \leq \infrajetsym_i, \qquad
%		\infrajetsym_i \leq \equijetsym_j\,\text{if}\,i < j.
%	\]
%	This makes $\oripsh(\vec a)$ a lattice.
%	
%	We define an associative, non-commutative multiplication operation $\loch \cdot \loch : \oripshnodegree \times \oripshnodegree \to \oripshnodegree$ by
%	\[
%		\begin{array}{c | c c c c}
%			{\downarrow} \cdot {\rightarrow} & \jetsym & \tejsym & \equijetsym & \infrajetsym \\ \hline
%			\jetsym & \jetsym & \tejsym & \equijetsym & \infrajetsym \\
%			\tejsym & \tejsym & \jetsym & \equijetsym & \infrajetsym \\
%			\equijetsym & \equijetsym & \equijetsym & \equijetsym & \infrajetsym \\
%			\infrajetsym & \infrajetsym & \infrajetsym & \equijetsym & \infrajetsym
%		\end{array}
%	\]
%	and we define $\loch \cdot \loch : \oripshnodegree \times \oripsh(\vec a) \to \oripsh(\vec a)$ by
%	\[
%		P \cdot \eqtysym = \eqtysym, \qquad
%		P \cdot \topsym = \topsym, \qquad
%		P \cdot (Q_i) = (P \cdot Q)_i.
%	\]
%	This is mixed associative: $(P \cdot Q) \cdot R_i = P \cdot (Q \cdot R_i)$.
%	If $i = \npolar$, we simply get $P \cdot \edgesym_i = \edgesym_i$.
%	We call a symbol $P_i \in \oripsh(\vec a)$ \textbf{symmetric} if $\tejsym \cdot P_i = P_i$, and similar for $P \in \oripshnodegree$.
%	We note that $\equijetsym \cdot P_i$ is the greatest symmetric symbol $\leq P_i$ and $\infrajetsym \cdot P_i$ is the least symmetric symbol $\geq P_i$.
%	
%	If $P_i, Q_j \in \oripsh(\vec a)$ and either is symmetric, then we either have $P_i \leq Q_j$ or $Q_j \leq P_i$.
%	
%	We write $P_i \ll Q_j$ if $\infrajetsym \cdot P_i \leq \equijetsym \cdot Q_j$, which is the case if either: $P_i = \eqtysym$, $Q_j = \topsym$, $i < j$ or if $i = j$ and either $P = \equijetsym$ or $Q = \infrajetsym$ (both of which are true if $a_i = \npolar$).
%\end{definition}
%\begin{definition}\label{def:poreshcat}
%	Let $\vec a$ and $\vec b$ be anpolarity masks.
%	A \textbf{polarized reshuffle} $\mu : \vec a \to \vec b$ from $\vec a$ to $\vec b$ is a function
%	\[
%		\loch \cdot \mu : \oripshfwd(\vec b) \to \oripsh(\vec a)
%	\]
%	such that if $P_i < Q_j$ then $P_i \cdot \mu \ll Q_j \cdot \mu$, such that $\eqtysym \cdot \mu$ is symmetric and such that if $b_i = \npolar$ then $\edgesym_i \cdot \mu$ is symmetric.
%	
%	We also denote $\mu$ by explicitly listing its actions as
%	\[
%		\mu = \reshlist{\eqtysym \cdot \mu}{\jetsym_0 \cdot \mu, \ldots, \jetsym_{\lenpol{\vec b}-1} \cdot \mu}.
%	\]
%	
%	The \textbf{identity} reshuffle $\id : \vec a \to \vec a$ is given by
%	\[
%		\id = \reshlist{\eqtysym}{\jetsym_0, \ldots, \jetsym_{\lenpol{\vec a}-1}},
%	\]
%	so that $\jetsym_i \cdot \id = \jetsym_i$.
%	
%	The \textbf{bind} of $\mu$ extends $\loch \cdot \mu$ to
%	\[
%		\loch \cdot \mu : \oripsh(\vec b) \to \oripsh(\vec a)
%	\]
%	by setting $\topsym \cdot \mu = \topsym$ and $P_i \cdot \mu = P \cdot (\jetsym_i \cdot \mu)$.
%	This operation is well-defined for $b_i = \npolar$ thanks to the requirement that $\jetsym_i \cdot \mu$ be symmetric in that case.
%	It preserves $\leq$, and even meets and joins.
%	
%	Given polarized reshuffles $\mu : \vec a \to \vec b$ and $\nu : \vec b \to \vec c$, then we define their \textbf{composite reshuffle} $\nu \circ \mu : \vec a \to \vec c$ by composing $\nu$ with the bind of $\mu$:
%	\[
%		P_i \cdot (\nu \circ \mu) := (P_i \cdot \nu) \cdot \mu.
%	\]
%	
%	Finally, if $\mu$ and $\nu$ are both polarized reshuffles from $\vec a$ to $\vec b$, then we say $\mu \leq \nu$ if this inequality holds pointwise, i.e.\ if $P_i \cdot \mu \leq P_i \cdot \nu$ for all $P_i \in \oripshfwd(\vec b)$.
%	It is easy to see that this property then extends to all $P_i \in \oripsh(\vec b)$.
%	
%	We thus define the \textdef{2-poset of polarized reshuffles} $\poreshcat$ whose objects are anpolarity masks, and whose morphisms are polarized reshuffles.
%\end{definition}
%\begin{corollary}
%	The Hom-wise equal sub-2-poset of $\poreshcat$ on masks with only symmetric degrees, is isomorphic to the category $\reshcat$ of (non-polarized) reshuffles from the model of Degrees of Relatedness \cite[def.\ 6.2.7]{reldtt-techreport}\cite{reldtt}, with the mask $[\npolar]^n$ corresponding to the depth $n-1$. \qed
%\end{corollary}

\subsection{Adjunctions of Polarized Reshuffles}
\begin{notation} \label{not:poresh-with}
	Sometimes, we need to consider only reshuffles that have at least a certain number of left/right adjoints. The 2-posets that contain only those reshuffles (with the same order relation) will be denoted as $\poreshcat\withllr$, where the number of white bullets on the left/right is the minimal number of left/right adjoints.
\end{notation}

\subsubsection{Characterization}
\begin{theorem}\label{thm:poresh-adjoint}
	\begin{enumerate}
		\item A pair of polarized reshuffles $\lambda \in \Hom(\vec a, \vec b)$ and $\rho \in \Hom(\vec b, \vec a)$ is adjoint ($\lambda \dashv \rho$) if and only if the following equivalent conditions are satisfied:
		\begin{align}
			&\forall P_i \in \oridegeqtop(\vec a), Q_j \in \oridegeqtop(\vec b). P_i \leq Q_j \oriof \lambda \Leftrightarrow P_i \oriof \rho \leq Q_j,
			\label{eq:poresh-adjoint-crit-orideg}
			\\
			&\forall c \in \Anpolarity, p_i \in \poldegeqtop(\vec a, c), q_j \in \poldegeqtop(\vec b, c). p_i \leq q_j \circ \lambda \Leftrightarrow p_i \circ \rho \leq q_j.
			\label{eq:poresh-adjoint-crit-poldeg}
		\end{align}
		\item By consequence:
		\begin{itemize}
			\item A reshuffle $\rho$ has a left adjoint $\lambda$ if and only if
			\begin{align}
				&\eqtydeg \cdot \rho = \nonpol_\eqtydeg, \text{and} \label{eq:poresh-withl-crit1} \\
				&\text{for all } i \in \Degeq(\vec a) \text{ with } i \cdot \rho = \isopol_j \text{, we have } b_j = \npolar \text{ (so $i \cdot \rho = \nonpol_j$)}. \label{eq:poresh-withl-crit2}
				%&\text{for all } \jetsym_i \in \oripshfwd(\vec a) \text{ with } a_i = \ypolar \text{, we have } \jetsym_i \cdot \rho \neq \infrajetsym_j. \label{eq:poresh-withl-crit2}
			\end{align}
			In this case,
			\begin{itemize}
				\item for any $Q_j \in \oridegeqtop(\vec b)$, we find $Q_j \oriof \lambda$ as the greatest oriented degree $P_i \in \oridegeqtop(\vec a)$ such that $P_i \oriof \rho \leq Q_j$;
				\item for any $q_j \in \poldegeqtop(\vec b, c)$, we find $q_j \circ \lambda$ as the greatest polarized degree $p_i \in \poldegeqtop(\vec a, c)$ such that $p_i \circ \rho \leq q_j$.\footnote{Recall from \cref{thm:deg-vs-poldeg-poresh} that $j \cdot \lambda = \pospol_j \circ \lambda$.}
			\end{itemize}
			
			\item A reshuffle $\lambda$ has a right adjoint $\rho$ if and only if
			\begin{align}
				&\text{for all } j \in \Degeq(\vec b), \text{we have } j \cdot \lambda < \nonpol_\top, \text{and} \label{eq:poresh-withr-crit1} \\
				&\text{for all } j \in \Degeq(\vec b) \text{ with } j \cdot \lambda = \mixpol_i \text{, we have } a_i = \npolar \text{ (so $j \cdot \lambda = \nonpol_i$)}. \label{eq:poresh-withr-crit2}
			\end{align}
			In this case,
			\begin{itemize}
				\item for any $P_i \in \oridegeqtop(\vec a)$, we find $P_i \oriof \rho$ as the least oriented degree $Q_j \in \oridegeqtop(\vec b)$ such that $P_i \leq Q_j \oriof \lambda$;
				\item for any $p_i \in \poldegeqtop(\vec a, c)$, we find $p_i \circ \rho$ as the least polarized degree $q_j \in \poldegeqtop(\vec b, c)$ such that $p_i \leq q_j \circ \lambda$.
			\end{itemize}
		\end{itemize}
	\end{enumerate}
\end{theorem}
\begin{proof}
	First of all, throughout the statement of the theorem, the formulation in terms of oriented degrees is equivalent to the formulation in terms of polarized degrees with `codomain' $\ypolar$ because we have isomorphisms of poset-valued presheaves $\Hom_\polcat(\loch, \ypolar) \cong \oripsh$ and $\poldegeqtop(\loch, \ypolar) \cong \oridegeqtop$.
	In both cases the isomorphism is given by the action $\jetsym \oriof \loch$.
	Furthermore, the corresponding presheaves of polarities and polarized degrees with codomain $\npolar$ are pointwise full subposets of those with codomain $\ypolar$, so asking that the same conditions apply there, adds nothing to the statement as a whole.
	\begin{enumerate}
		\item First, assume that we have reshuffles $\lambda \in \Hom(\vec a, \vec b)$ and $\rho \in \Hom(\vec b, \vec a)$ satisfying \cref{eq:poresh-adjoint-crit-orideg,eq:poresh-adjoint-crit-poldeg}.
		We show that $\lambda \dashv \rho$, i.e. that $\id_{\vec a} \leq \rho \circ \lambda$ and $\lambda \circ \rho \leq \id_{\vec b}$.
		
		To see the former, we need to show that for all $i \in \Degeq(\vec a)$, we have $\pospol_i \leq (i \cdot \rho) \circ \lambda$:
		\begin{align*}
			\pospol_i \leq (i \cdot \rho) \circ \lambda
			&\quad\Leftrightarrow\quad
			\pospol_i \leq \pospol_i \circ \rho \circ \lambda
			& \text{(\cref{thm:deg-vs-poldeg-poresh})} \\
%			&\quad\Leftrightarrow\quad
%			\jetsym \oriof \pospol_i \leq \jetsym \oriof \pospol_i \circ \rho \circ \lambda
%			& \text{($\jetsym \oriof \loch$ is an isomorphism)} \\
			&\quad\Leftrightarrow\quad
			\pospol_i \circ \rho \leq \pospol_i \circ \rho
			& \text{(\cref{eq:poresh-adjoint-crit-poldeg})} \\
			&\quad\Leftrightarrow\quad
			\text{true}.
		\end{align*}
		
		To see the latter, we need to show that for all $j \in \Degeq(\vec b)$, we have $(j \cdot \lambda) \circ \rho \leq \pospol_j$:
		\begin{align*}
			(j \cdot \lambda) \circ \rho \leq \pospol_j
			&\quad\Leftrightarrow\quad
			\pospol_j \circ \lambda \circ \rho \leq \pospol_j
			& \text{(\cref{thm:deg-vs-poldeg-poresh})} \\
%			&\quad\Leftrightarrow\quad
%			\jetsym \oriof \pospol_j \circ \lambda \circ \rho \leq \jetsym \oriof \pospol_j
%			& \text{($\jetsym \oriof \loch$ is an isomorphism)} \\
			&\quad\Leftrightarrow\quad
			\pospol_j \circ \lambda \leq \pospol_j \circ \lambda
			& \text{(\cref{eq:poresh-adjoint-crit-poldeg})} \\
			&\quad\Leftrightarrow\quad
			\text{true}.
		\end{align*}
		
		Conversely, assume that $\lambda \dashv \rho$. Then we have
		\begin{align*}
			P_i \leq Q_j \oriof \lambda &\quad\Rightarrow\quad P_i \oriof \rho \leq (Q_j \oriof \lambda) \oriof \rho = Q_j \oriof (\lambda \circ \rho) \leq Q_j, \\
			P_i \oriof \rho \leq Q_j &\quad\Rightarrow\quad P_i \leq P_i \oriof (\rho \circ \lambda) = (P_i \oriof \rho) \oriof \lambda \leq Q_j \oriof \lambda,
		\end{align*}
		so all adjoint pairs satisfy \cref{eq:poresh-adjoint-crit-orideg} and, equivalently, \cref{eq:poresh-adjoint-crit-poldeg}.
		
		\item Next, we move to the criteria to determine existence of a left/right adjoint and the algorithms for constructing them.
		The algorithms are just rephrasings of \cref{eq:poresh-adjoint-crit-orideg,eq:poresh-adjoint-crit-poldeg}, so assuming that a left/right adjoint exists, they are clearly correct.
		
		\textbf{Existence of left adjoint.} Assume given a reshuffle $\rho \in \Hom(\vec b, \vec a)$.
		We would like to define in a first step a function (parametrized by $c \in \Anpolarity$)
		\[
			\ell_c : \poldegeqtop(\vec b, c) \to \poldegeqtop(\vec a, c) : q_j \mapsto \max \set{p_i \in \poldegeqtop(\vec a, c)}{p_i \circ \rho \leq q_j}.
		\]
		A left adjoint $\lambda \dashv \rho$ exists if and only if this function is definable and is the action of some polarized reshuffle on polarized degrees.
		%
		However, $\ell_c$ is only defined if the set of which we take the maximum\footnote{Which differs from the join in that it needs to be one of the operands.}, is non-empty\footnote{In which case there is indeed a maximum, since the set is closed under joins, since $\loch \oriof \rho$ respects joins (\cref{thm:poldeg-poresh-lattice}).}.
		As such, existence of a left adjoint requires that
		\[
			\forall q_j \in \poldegeqtop(\vec b, c). \exists p_i \in \poldegeqtop(\vec a, c).p_i \circ \rho \leq q_j.
		\]
		Without loss of generality, we can instantiate both $p_i$ and $q_j$ with the minimal element $\nonpol_\eqtydeg$, so existence of a left adjoint requires that $\eqtydeg \cdot \rho = \nonpol_\eqtydeg \circ \rho = \nonpol_\eqtydeg$ (\cref{eq:poresh-withl-crit1}).
		
		We now assume that this is the case, so that $\ell_c$ is defined.
		It is then, by construction, right adjoint to $\loch \circ \rho$.
		We define a polarized reshuffle $\lambda \in \Hom(\vec a, \vec b)$ by $j \cdot \lambda = \ell_{b_j}(\pospol_j) \in \poldegeqtop(\vec a, b_j)$.
		We have to show that $\ell$ is the action of $\lambda$ if and only if \cref{eq:poresh-withl-crit2} holds.
		\begin{itemize}
			\item To prove `only if', assume that \cref{eq:poresh-withl-crit2} does not hold (which is decidable). Then there exists some $i \in \Degeq(\vec a)$ such that $i \cdot \rho = \isopol_j \in \poldegeqtop(\vec b, a_i)$ with $b_j = \ypolar$.
			
			This implies that $\isopol_i \circ \rho = \isopol_j \in \poldegeqtop(\vec b, \ypolar)$ and hence, by the adjunction $\loch \circ \rho \dashv \ell$, that $\isopol_i \leq \ell_{\ypolar}(\isopol_j)$.
			
			On the other hand, we have that $\mixpol_i \circ \rho = \isopol_j \not\leq \pospol_j \in \poldegeqtop(\vec b, \ypolar)$ and hence, by the adjunction $\loch \circ \rho \dashv \ell$, that $\mixpol_i \not\leq \ell_\ypolar(\pospol_j) = j \cdot \lambda \in \poldegeqtop(\vec a, \ypolar)$.
			This is only possible if $\getdeg(j \cdot \lambda) < i$.
			But this degree is preserved by the action of $\isopol$.
			
			We tie our findings together:
			\[
				\getdeg(\isopol_j \circ \lambda) = \getdeg(j \cdot \lambda) < i = \getdeg(\isopol_i) \leq \getdeg(\ell_\ypolar(\isopol_j))
			\]
			so that $\ell$ cannot be the action of $\lambda$.
			
			\item To prove `if', assume that \cref{eq:poresh-withl-crit2} holds. We prove that $\ell_c$ is the action of $\lambda$.
			It is sufficient to prove this for $c = \ypolar$, since there is just one composition table for polarities (\cref{fig:polarity-orientation}) and no additional equalities are introduced if the codomain $c$ becomes $\npolar$.
			It is clear from the definition of $\ell$ that $\ell(\nonpol_\top) = \nonpol_\top$, and for all other degrees we have $\ell(\pospol_j) = \pospol_j \circ \lambda$ by definition of $\lambda$ and \cref{thm:deg-vs-poldeg-poresh}.
%			For degrees $j$ where $b_j = \npolar$, this is enough, as all polarized degrees are then equal to $\nonpol_j = \pospol_j$.
%			For other degrees $j$, we have furthermore
			\begin{align*}
				\negpol_j \circ \lambda
				&= \negpol \circ (j \cdot \lambda)
				= \negpol \circ \ell(\pospol_j) \\
				& \qquad \qquad \text{(Definition of $\lambda$)} \\
				&= \negpol \circ \max \set{p_i \in \poldegeqtop(\vec a, b_j)}{p_i \circ \rho \leq \pospol_j} \\
				& \qquad \qquad \text{(Definition of $\ell$)} \\
				&= \max \set{\negpol \circ p_i}{p_i \in \poldegeqtop(\vec a, b_j) \text{ with } p_i \circ \rho \leq \pospol_j} \\
				& \qquad \qquad \text{($\negpol \circ \loch : \poldegeqtop(\vec a, b_j) \to \poldegeqtop(\vec a, \ypolar)$ preserves $\leq$.)} \\
				&= \max \set{p'_i \in \poldegeqtop(\vec a, \ypolar)}{\negpol \circ p'_i \circ \rho \leq \pospol_j} \\
				& \qquad \qquad \text{(By taking $p'_i := \negpol \circ p_i$)} \\
				&= \max \set{p'_i \in \poldegeqtop(\vec a, \ypolar)}{p'_i \circ \rho \leq \negpol_j} \\
				& \qquad \qquad \text{(Involution $\tejsym \cdot \loch$ preserves and reflects $\leq$.)} \\
				&= \ell(\negpol_j), \\
				% ------------------------
				\mixpol_j \circ \lambda
				&= (\pospol_j \circ \lambda) \wedge (\negpol_j \circ \lambda) \\
				& \qquad \qquad \text{(By \cref{thm:poldeg-poresh-lattice})} \\
				&= \ell_\ypolar(\pospol_j) \wedge \ell_\ypolar(\negpol_j) \\
				& \qquad \qquad \text{(By previous results)} \\
				&= \ell_\ypolar(\pospol_j \wedge \negpol_j) = \ell_\ypolar(\mixpol_j) \\
				& \qquad \qquad \text{(Right adjoints preserve meets),} \\
				% ------------------------
				\isopol_j \circ \lambda
				&= (\pospol_j \circ \lambda) \vee (\negpol_j \circ \lambda) \\
				& \qquad \qquad \text{(By \cref{thm:poldeg-poresh-lattice})} \\
				&= \ell_\ypolar(\pospol_j) \vee \ell_\ypolar(\negpol_j) \\
				& \qquad \qquad \text{(By previous results)} \\
				&= \max \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \pospol_j} \vee \max \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \negpol_j} \\
				& \qquad \qquad \text{(Definition of $\ell$)} \\
				&= \bigvee \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \pospol_j} \vee \bigvee \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \negpol_j} \\
				& \qquad \qquad \text{(The maxima exist, so they are equal to the joins (suprema).)} \\
				&= \bigvee \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \pospol_j} \cup \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \negpol_j} \\
				& \qquad \qquad \text{(Associativity.)} \\
				&= \bigvee \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \pospol_j \text{ or } p_i \circ \rho \leq \negpol_j} \\
				&= \bigvee \set{p_i \in \poldegeqtop(\vec a, \ypolar)}{p_i \circ \rho \leq \isopol_j} \\
				& \qquad \qquad \text{(Using \cref{eq:poresh-withl-crit2}.)} \\
				&= \ell_\ypolar(\isopol_j). \\
				& \qquad \qquad \text{(Definition and existence of $\ell$.)}
			\end{align*}
		\end{itemize}
		
		\textbf{Existence of right adjoint.}
		Assume given a reshuffle $\lambda \in \Hom(\vec a, \vec b)$.
		We would like to define in a first step a function (parametrized by $c \in \Anpolarity$)
		\[
			r_c : \poldegeqtop(\vec a, c) \to \poldegeqtop(\vec b, c) : p_i \mapsto \min \set{q_j \in \poldegeqtop(\vec b, c)}{p_i \leq q_j \circ \lambda}.
		\]
		A right adjoint $\lambda \dashv \rho$ exists if and only if this function is definable and is the action of some polarized reshuffle.
		However, $r_c$ is only defined if the set of which we take the minimum, is non-empty.
		As such, existence of a right adjoint requires that
		\[
			\forall p_i \in \poldegeqtop(\vec a, c) . \exists q_j \in \poldegeqtop(\vec b, c). p_i \leq q_j \cdot \lambda.
		\]
		Without loss of generality, we can instantiate both $p_i$ and $q_j$ with the maximal element $\nonpol_\top$, in which case the resulting requirement $\nonpol_\top \leq \nonpol_\top \cdot \lambda$ is true by definition of the action of a polarized reshuffle.
		
		We conclude that $r$ is always defined.
		It is then, by construction, left adjoint to $\loch \circ \lambda$.
		We define a polarized reshuffle $\rho \in \Hom(\vec b, \vec a)$ by $i \cdot \rho = r_{a_i}(\pospol_i) \in \poldegeqtop(\vec b, a_i)$.
		We have to show that $r$ is the action of $\rho$ if and only if \cref{eq:poresh-withr-crit1,eq:poresh-withr-crit2} hold.
		\begin{itemize}
			\item Assume that \cref{eq:poresh-withr-crit1} does not hold (which is decidable).
			Then there exists some $j \in \Degeq(\vec b)$ such that $\pospol_j \circ \lambda = j \cdot \lambda = \nonpol_\top \in \poldegeqtop(\vec a, b_j)$.
			Then by the adjunction $r \dashv \loch \circ \lambda$, we get
			$r_{b_j}(\nonpol_\top) \leq \pospol_j \neq \nonpol_\top = \nonpol_\top \circ \rho \in \poldegeqtop(\vec b, b_j)$, implying that $r$ cannot be the action of $\rho$.
			
			\item Assume that \cref{eq:poresh-withr-crit2} does not hold (which is decidable).
			Then there exists some $j \in \Degeq(\vec b)$ such that $j \cdot \lambda = \mixpol_i \in \poldegeqtop(\vec a, b_j)$ with $a_i = \ypolar$.
			
			This implies that $\mixpol_j \circ \lambda = \mixpol_i \in \poldegeqtop(\vec a, \ypolar)$ and hence, by the adjunction $r \dashv \loch \circ \lambda$, that $r_\ypolar(\mixpol_i) \leq \mixpol_j \in \poldegeqtop(\vec b, \ypolar)$.
			
			This also implies that $\isopol_j \circ \lambda = \mixpol_i \not \geq \pospol_i \in \poldegeqtop(\vec a, \ypolar)$ and hence, by the adjunction $r \dashv \loch \circ \lambda$, that $i \cdot \rho = r_\ypolar(\pospol_i) \not\leq \isopol_j \in \poldegeqtop(\vec b, \ypolar)$.
			This is only possible if $\getdeg(i \cdot \rho) > j$.
			But this degree is preserved by the action of $\mixpol$.
			
			We tie our findings together:
			\[
				\getdeg(\mixpol_i \circ \rho) = \getdeg(i \cdot \rho) > j = \getdeg(\mixpol_j) \geq \getdeg(r_\ypolar(\mixpol_i))
			\]
			so that $r$ cannot be the action of $\rho$.
			
			\item To prove `if', assume that \cref{eq:poresh-withr-crit1,eq:poresh-withr-crit2} hold.
			We prove that $r_c$ is the action of $\rho$.
			Again, it is sufficient to prove this for $c = \ypolar$.
			From \cref{eq:poresh-withr-crit1} and the definition of $r$, it follows that $r(\nonpol_\top) = \nonpol_\top$.
			For all other degrees we have $r(\pospol_i) = \pospol_i \circ \rho$ by definition of $\rho$ and \cref{thm:deg-vs-poldeg-poresh}.
			Furthermore, entirely dually (w.r.t.\ $\leq$) to our earlier calculations, we have
			\begin{align*}
				\negpol_i \circ \rho &= r_\ypolar(\negpol_i) \\
				&\qquad \qquad \text{(Analogous to dual situation.)} \\
				% ----------------
				\isopol_i \circ \rho
				&= (\pospol_i \circ \rho) \vee (\negpol_i \circ \rho) \\
				&\qquad \qquad \text{(By \cref{thm:poldeg-poresh-lattice})} \\
				&= r_\ypolar(\pospol_i) \vee r_\ypolar(\negpol_i) \\
				&\qquad \qquad \text{(By previous results)} \\
				&= r_\ypolar(\pospol_i \vee \negpol_i) = r_\ypolar(\isopol_i) \\
				&\qquad \qquad \text{(Left adjoints preserve joins),} \\
				% ----------------
				\mixpol_i \circ \rho
				&= (\pospol_i \circ \rho) \wedge (\negpol_i \circ \rho) \\
				&\qquad \qquad \text{(By \cref{thm:poldeg-poresh-lattice})} \\
				&= r_\ypolar(\pospol_i) \wedge r_\ypolar(\negpol_i) \\
				&\qquad \qquad \text{(By previous results)} \\
				&= \min \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\pospol_i \leq q_j \circ \lambda} \wedge \min \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\negpol_i \leq q_j \circ \lambda} \\
				&= \bigwedge \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\pospol_i \leq q_j \circ \lambda} \wedge \bigwedge \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\negpol_i \leq q_j \circ \lambda} \\
				&\qquad \qquad \text{(The minima exist, so they are equal to the meets (infima).)} \\
				&= \bigwedge \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\pospol_i \leq q_j \circ \lambda} \cup \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\negpol_i \leq q_j \circ \lambda} \\
				&\qquad \qquad \text{(Associativity.)} \\
				&= \bigwedge \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\pospol_i \leq q_j \circ \lambda \text{ or } \negpol_i \leq q_j} \\
				&= \bigwedge \set{q_j \in \poldegeqtop(\vec b, \ypolar)}{\mixpol_i \leq q_j} \\
				&\qquad \qquad \text{(Using \cref{eq:poresh-withr-crit2}.)} \\
				&= r_\ypolar(\mixpol_i). \\
				&\qquad \qquad \text{(Definition and existence of $r$.)} &\qedhere
			\end{align*}
		\end{itemize}
	\end{enumerate}
\end{proof}

\begin{definition} \label{def:suc-degree}
	Let $\vec a$ be an anpolarity mask and $i \in \Degeqtop(\vec a)$.
	\begin{enumerate}
		\item If $i < \top$, write $\sucdeg(i) := \min \set{i' \in \Degeqtop(\vec a)}{i' > i}$; we call this the \textbf{successor} of $i$.
		\item If $i > \eqtydeg$, write $\predeg(i) := \max \set{i' \in \Degeqtop(\vec a)}{i' < i}$; we call this the \textbf{predecessor} of $i$.
	\end{enumerate}
\end{definition}

\begin{theorem} \label{thm:poresh-withll}
	Let $\tau \in \Hom(\vec a, \vec b)$ be a polarized reshuffle with left adjoint $\rho \in \Hom(\vec b, \vec a)$.
	Then $\rho$ has a further left adjoint $\lambda \dashv \rho \dashv \tau$ if and only if
	\begin{align}
		&\text{$\getdeg(\sucdeg(\eqtydeg) \cdot \tau) > \eqtydeg$, and} \label{eq:poresh-withll-crit1} \\
		&\text{$\forall j \in \Degeq(\vec b), i \in \Degeq(\vec a)$, if $j \cdot \tau \leq \mixpol_i$ and $\getdeg(\sucdeg(j) \cdot \tau) > i$ then $b_j = \npolar$.} \label{eq:poresh-withll-crit2}
	\end{align}
\end{theorem}
In words, \cref{eq:poresh-withll-crit2} says that:
\begin{itemize}
	\item The last mention of a symmetric degree $i \in \Degeq(\vec a)$ by $\tau$ is at a symmetric degree $j \in \Degeq(\vec b)$;
	\item The last mention of a directed degree $i \in \Degeq(\vec a)$ (hence $i \neq \eqtydeg$) is either:
	\begin{itemize}
		\item of the form $\mixpol_i$ at a symmetric degree $j \in \Degeq(\vec b)$;
		\item or of the form $\pospol_i$ or $\negpol_i$ at an arbitrary degree $j \in \Degeq(\vec b)$;
		\item it already could not be of the form $\isopol_i$ as per \cref{eq:poresh-withl-crit2};
	\end{itemize}
	\item If a degree $i \in \Degeq(\vec a)$ is never mentioned, then the last mention of a degree less than $i$ is at a symmetric degree $j \in \Degeq(\vec b)$.
\end{itemize}
\begin{proof}
	We show that \cref{eq:poresh-withll-crit1} $\Leftrightarrow$ \cref{eq:poresh-withl-crit1} and \cref{eq:poresh-withll-crit2} $\Leftrightarrow$ \cref{eq:poresh-withl-crit2}.
	
	Starting from \cref{eq:poresh-withl-crit1}, we have
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		\eqtydeg \cdot \rho = \nonpol_\eqtydeg \\
		&\quad\Leftrightarrow\quad
		\eqtydeg \cdot \rho < \mixpol_{\sucdeg(\eqtydeg)} \\
		&\quad\Leftrightarrow\quad
		\eqtydeg \cdot \rho < \pospol_{\sucdeg(\eqtydeg)}
		& \text{(Case distinction on $b_{\sucdeg(\eqtydeg)}$; $\rho$ satisfies \cref{eq:poresh-withr-crit2})} \\
		&\quad\Leftrightarrow\quad
		\nonpol_\eqtydeg \circ \rho \not\geq \pospol_{\sucdeg(\eqtydeg)}
		& \text{(By \cref{thm:deg-vs-poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)} \\
		&\quad\Leftrightarrow\quad
		\nonpol_\eqtydeg \not\geq \pospol_{\sucdeg(\eqtydeg)} \circ \tau
		& \text{($\loch \circ \tau \dashv \loch \circ \rho$)} \\
		&\quad\Leftrightarrow\quad
		\nonpol_\eqtydeg < {\sucdeg(\eqtydeg)} \cdot \tau
		& \text{(By \cref{thm:deg-vs-poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)} \\
		&\quad\Leftrightarrow\quad
		\eqtydeg < \getdeg({\sucdeg(\eqtydeg)} \cdot \tau).
	\end{align*}
	%Now either $\lenpol{\vec b} = 0$ and $m = \top$, in which case $\getdeg(m \cdot \tau) = \top$ and the given equation is trivally satisfied; or $\lenpol{\vec b} > 0$ and $m = 0$.
	This gives \cref{eq:poresh-withll-crit1}.
	
	Recall \cref{eq:poresh-withl-crit2}:
	\begin{align*}
		\text{for all } i \in \Degeq(\vec a) \text{ with } i \cdot \rho = \isopol_j \text{, we have } b_j = \npolar \text{ (so $i \cdot \rho = \nonpol_j$)}.
	\end{align*}
	We can rewrite the condition as $\isopol_j \leq i \cdot \rho$ \textbf{AND} $\isopol_j \geq i \cdot \rho$.
	We have
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		\isopol_j \leq i \cdot \rho
		\\ &\quad\Leftrightarrow\quad
		\isopol_j \circ \tau \leq \pospol_i
		& \text{($\loch \circ \tau \dashv \loch \circ \rho$; \cref{thm:deg-vs-poldeg-poresh})}
%		\\ &\quad\Leftrightarrow\quad
%		\isopol \circ (j \cdot \tau) \leq \pospol_i
%		& \text{(\cref{eq:poldeg-poresh})}
%		\\ &\quad\Leftrightarrow\quad
%		\isopol_{\getdeg(j \cdot \tau)} \leq \pospol_i
%		& \text{(Case distinction on $a_{\getdeg(j \cdot \tau)}$; $\tau$ satisfies \cref{eq:poresh-withr-crit2})}
%		\\ &\quad\Leftrightarrow\quad
%		\getdeg(j \cdot \tau) < i \text{ or} \\
%		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
%		\getdeg(j \cdot \tau) = i \text{ with } a_i = \npolar,
		\\ &\quad\Leftrightarrow\quad
		(\pospol_j \circ \tau) \vee (\negpol_j \circ \tau) \leq \pospol_i
		& \text{(\Cref{thm:poldeg-poresh-lattice})}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \circ \tau \leq \pospol_i \text{ and }
		\negpol_j \circ \tau \leq \pospol_i
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \circ \tau \leq \pospol_i \text{ and }
		\pospol_j \circ \tau \leq \negpol_i
		& \text{(Apply $\negpol \circ \loch$ to both sides)}
		\\ &\quad\Leftrightarrow\quad
		j \cdot \tau \leq \mixpol_i
	\end{align*}
	and
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		\isopol_j \geq i \cdot \rho
		\\ &\quad\Leftrightarrow\quad
		\mixpol_{\sucdeg(j)} > i \cdot \rho
		%& \paren{\text{Let ${\sucdeg(j)} = \min \set{j' \in \Degeqtop(\vec b)}{j' > j}$}}
		\\ &\quad\Leftrightarrow\quad
		\mixpol_{\sucdeg(j)} \not\leq \pospol_i \circ \rho
		& \text{(By \cref{thm:deg-vs-poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)}
		\\ &\quad\Leftrightarrow\quad
		\mixpol_{\sucdeg(j)} \circ \tau \not\leq \pospol_i
		& \text{($\loch \circ \tau \dashv \loch \circ \rho$)}
		\\ &\quad\Leftrightarrow\quad
		\mixpol \circ ({\sucdeg(j)} \cdot \tau) > \pospol_i
		& \text{(By \cref{eq:poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)}
		\\ &\quad\Leftrightarrow\quad
		\mixpol_{\getdeg({\sucdeg(j)} \cdot \tau)} > \pospol_i
		& \text{(Case distinction on $a_{\getdeg({\sucdeg(j)} \cdot \tau)}$; $\tau$ satisfies \cref{eq:poresh-withl-crit2})}
		\\ &\quad\Leftrightarrow\quad
		\getdeg({\sucdeg(j)} \cdot \tau) > i
	\end{align*}
	%Now either $\lenpol{\vec b} = j+1$ and $m = \top$, in which case $\getdeg(m \cdot \tau) = \top$ and the given equation is trivially satisfied; or $\lenpol{\vec b} > j+1$ and $m = j+1$.
	Thus, for any $i$, if both of the above conditions for $\tau$ are satisfied, we conclude that $b_j = \npolar$.
	This gives \cref{eq:poresh-withll-crit2}.
\end{proof}

\begin{theorem} \label{thm:poresh-withrr}
	Let $\kappa \in \Hom(\vec b, \vec a)$ be a polarized reshuffle with right adjoint $\lambda \in \Hom(\vec a, \vec b)$.
	Then $\lambda$ has a further right adjoint $\kappa \dashv \lambda \dashv \rho$ if and only if
	\begin{align}
		&\predeg(\top) \cdot \kappa > \mixpol_{\predeg(\top)} \label{eq:poresh-withrr-crit1} \\
		&\text{$\forall j \in \Degeq(\vec b), i \in \Deg(\vec a)$, if $\getdeg(\predeg(i) \cdot \kappa) < j$ and $i \cdot \kappa \geq \isopol_j$ then $a_i = \npolar$.} \label{eq:poresh-withrr-crit2}
	\end{align}
\end{theorem}
In words, \cref{eq:poresh-withrr-crit2} says that:
\begin{itemize}
	\item The first mention of a symmetric degree $j \in \Degeq(\vec b)$ by $\kappa$ is at a symmetric degree $i \in \Degeq(\vec a)$;
	\item The first mention of a directed degree $j \in \Degeq(\vec b)$ by $\kappa$ is either:
	\begin{itemize}
		\item of the form $\isopol_j$ at a symmetric degree $i \in \Degeq(\vec a)$;
		\item or of the form $\pospol_j$ or $\negpol_j$ at an arbitrary degree $i \in \Degeq(\vec a)$;
		\item it already could not be of the form $\mixpol_j$ as per \cref{eq:poresh-withr-crit2};
	\end{itemize}
	\item If a degree $j \in \Degeq(\vec b)$ is never mentioned, then the first mention of degree greater than $j$ is at a symmetric degree $i \in \Degeq(\vec a)$.
\end{itemize}
\begin{proof}
	We show that \cref{eq:poresh-withrr-crit1} $\Leftrightarrow$ \cref{eq:poresh-withr-crit1} and \cref{eq:poresh-withrr-crit2} $\Leftrightarrow$ \cref{eq:poresh-withr-crit2}.
	
	Note that \cref{eq:poresh-withr-crit1} can equivalently be stated only for $j = \predeg(\top)$. Then we have
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		\predeg(\top) \cdot \lambda < \nonpol_\top
		\\ &\quad\Leftrightarrow\quad
		\pospol_{\predeg(\top)} \circ \lambda \leq \isopol_{\predeg(\top)}
		&\text{(\Cref{thm:deg-vs-poldeg-poresh})}
		\\ &\quad\Leftrightarrow\quad
		\pospol_{\predeg(\top)} \leq \isopol_{\predeg(\top)} \circ \kappa
		&\text{($\loch \circ \lambda \dashv \loch \circ \kappa$)}
		\\ &\quad\Leftrightarrow\quad
		\mixpol_{\predeg(\top)} < \predeg(\top) \cdot \kappa
		&\text{(Case distinction)} &.
	\end{align*}
	
	Recall \cref{eq:poresh-withr-crit2}:
	\[
		\text{for all } j \in \Degeq(\vec b) \text{ with } j \cdot \lambda = \mixpol_i \text{, we have } a_i = \npolar \text{ (so $j \cdot \lambda = \nonpol_i$)}.
	\]
	We can rewrite the condition as $j \cdot \lambda \leq \mixpol_i$ \textbf{AND} $\mixpol_i \leq j \cdot \lambda$. We have
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		j \cdot \lambda \leq \mixpol_i
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \leq \mixpol_i \circ \kappa
		& \text{($\loch\circ  \lambda \dashv \loch \circ \kappa$; \cref{thm:deg-vs-poldeg-poresh})}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \leq (\pospol_i \circ \kappa) \wedge (\negpol_i \circ \kappa)
		& \text{(\cref{thm:poldeg-poresh-lattice})}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \leq \pospol_i \circ \kappa \text{ and }
		\pospol_j \leq \negpol_i \circ \kappa
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \leq \pospol_i \circ \kappa \text{ and }
		\negpol_j \leq \pospol_i \circ \kappa
		& \text{(Apply $\negpol \circ \loch$ to both sides)}
		\\ &\quad\Leftrightarrow\quad
		\isopol_j \leq i \cdot \kappa
	\end{align*}
	and
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		j \cdot \lambda \geq \mixpol_i
		\\ &\quad\Leftrightarrow\quad
		j \cdot \lambda > \isopol_{\predeg(i)}
		&\text{(WLOG, $i > \eqtydeg$, since $a_\eqtydeg = \npolar$ regardless)}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \circ \lambda \not\leq \isopol_{\predeg(i)}
		& \text{(By \cref{thm:deg-vs-poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j \not\leq \isopol_{\predeg(i)} \circ \kappa
		& \text{($\loch\circ  \lambda \dashv \loch \circ \kappa$)}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j > \isopol \circ (\predeg(i) \cdot \kappa)
		& \text{(By \cref{eq:poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)}
		\\ &\quad\Leftrightarrow\quad
		\pospol_j > \isopol_{\getdeg(\predeg(i) \cdot \kappa)}
		& \text{(Case distinction on $b_{\getdeg(\predeg(i) \cdot \kappa)}$; $\kappa$ satisfies \cref{eq:poresh-withr-crit2})}
		\\ &\quad\Leftrightarrow\quad
		j > \getdeg(\predeg(i) \cdot \kappa).
	\end{align*}
	Thus, for any $j \in \Deg(\vec b)$, if both of the above conditions for $\kappa$ are satisfied, we conclude that $a_i = \npolar$. This gives \cref{eq:poresh-withrr-crit2}.
\end{proof}

\subsubsection{Examples}
\begin{example} \label{ex:poresh-op}
	Let $a_i = \ypolar$.
	Then we have a self-inverse and therefore self-adjoint polarized reshuffle $\Op_i : \vec a \to \vec a$ defined by $i \cdot \Op_i = \negpol_i$ and $j \cdot \Op_i = \pospol_j$ for all $i \neq j \in \Degeq(\vec a)$.
\end{example}
\begin{example} \label{ex:poresh-sym}
	Let $\vec a \sqsubset_i \vec b$ (\cref{def:anpolarity-order-step}).
	Then we have a triple of adjoint polarized reshuffles
	\[
		\Fsymresh_i \dashv \Usymresh_i \dashv \Csymresh_i
	\]
	where $\Usymresh_i : \vec a \to \vec b$, defined by
	\begin{align*}
		i \cdot \Fsymresh_i &= \isopol_i
		& i \cdot \Usymresh_i &= \nonpol_i
		& i \cdot \Csymresh_i &= \mixpol_i
		\\
		j \cdot \Fsymresh_i &= \pospol_i
		& j \cdot \Usymresh_i &= \pospol_i
		& j \cdot \Csymresh_i &= \pospol_i
		& \text{for $i \neq j \in \Degeq(\vec a) = \Degeq(\vec b)$}
	\end{align*}
	From \cref{thm:poresh-adjoint}, we conclude that no further left or right adjoints exist. We have
	\[
		\Fsymresh_i \circ \Usymresh_i = \id, \qquad \Csymresh_i \circ \Usymresh_i = \id_{\vec a}.
	\]
	Thus, we get an idempotent monad $\UFsymresh_i = \Usymresh_i \circ \Fsymresh_i$ and an idempotent comonad $\UCsymresh_i = \Usymresh_i \circ \Fsymresh_i$ such that $\UFsymresh_i \dashv \UCsymresh_i$.
	Both are given by
	\begin{align*}
		i \cdot \UFsymresh_i &= \isopol_i
		& i \cdot \UCsymresh_i &= \mixpol_i
		\\
		j \cdot \UFsymresh_i &= \pospol_i
		& j \cdot \UCsymresh_i &= \pospol_i
		& \text{for $i \neq j \in \Degeq(\vec b)$}
	\end{align*}
\end{example}
\begin{example} \label{ex:cohesion}
	Let $\vec b$ be obtained from $\vec a$ by deleting the anpolarity with degree $i$.
	Let $n := \lenpol{\vec a} = \lenpol{\vec b} + 1$.
	We define the following polarized reshuffle, which forgets the $i$-jet relation:
	\[
		\cohfget_i = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \pospol_{i+1}, \ldots, \pospol_{n-1}} : \vec a \to \vec b
	\]
	\begin{itemize}
		\item If $i = 0$, then $\cohfget_0$ has two left adjoints $\cohpi_0 \dashv \cohdisc_0 \dashv \cohfget_0$ with
		\begin{align*}
			\cohpi_0 &= \reshlist{\isopol_0}{\pospol_1, \ldots, \pospol_{n-1}} &: \vec a \to \vec b, \\
			\dashv
			\cohdisc_0 &= \reshlist{\nonpol_\eqtydeg}{\nonpol_\eqtydeg, \pospol_0, \ldots, \pospol_{n-2}} &: \vec b \to \vec a, \\
			\dashv
			\cohfget_0 &= \reshlist{\nonpol_\eqtydeg}{\pospol_1, \ldots, \pospol_{n-1}} &: \vec a \to \vec b.
		\end{align*}
		By \cref{thm:poresh-adjoint}, $\cohpi_0$ has no further left adjoints.
		We have $\cohpi_0 \cohdisc_0 = \cohfget_0 \cohdisc_0 = \id_{\vec b}$. We get adjoint idempotent (co)monads
		\begin{align*}
			\shp_0 = \cohdisc_0 \cohpi_0 &= \reshlist{\isopol_0}{\isopol_0, \pospol_1, \ldots, \pospol_{n-1}} &: \vec a \to \vec a, \\
			\dashv
			\flat_0 = \cohdisc_0 \cohfget_0 &= \reshlist{\nonpol_\eqtydeg}{\nonpol_\eqtydeg, \pospol_1, \ldots, \pospol_{n-1}} : \vec a \to \vec a.
		\end{align*}
		\item If $i > 0$, then $\cohfget_i$ has a left adjoint $\cohdisc_i \dashv \cohfget_i$ where
		\[
			\cohdisc_i = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \isopol_{i-1}, \pospol_i, \ldots, \pospol_{n-2}} : \vec b \to \vec a.
		\]
		We have $\cohfget_i \cohdisc_i = \id_{\vec b}$. We get an idempotent comonad
		\[
			\flat_i = \cohdisc_i \cohfget_i = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \isopol_{i-1}, \pospol_{i+1}, \ldots, \pospol_{n-1}} : \vec a \to \vec a
		\]
		\begin{itemize}
			\item If $a_{i-1} = b_{i-1} = \ypolar$, then $\cohdisc_i$ has no further left adjoints.
			\item If $a_{i-1} = b_{i-1} = \npolar$, then we have $\cohpi_i \dashv \cohdisc_i \dashv \cohfget_i$ with
			\begin{align*}
				\cohpi_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-2}, \isopol_i, \pospol_{i+1}, \ldots, \pospol_{n-1}}
				&: \vec a \to \vec b, \\
				\dashv
				\cohdisc_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-2}, \nonpol_{i-1}, \nonpol_{i-1}, \pospol_i, \ldots, \pospol_{n-2}}
				&: \vec b \to \vec a, \\
				\dashv
				\cohfget_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-2}, \nonpol_{i-1}, \pospol_{i+1}, \ldots, \pospol_{n-1}}
				&: \vec a \to \vec b.
			\end{align*}
			We have $\cohpi_i \cohdisc_i = \cohfget_i \cohdisc_i = \id_{\vec b}$. We get adjoint idempotent (co)monads
			\begin{align*}
				\shp_i = \cohdisc_i \cohpi_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-2}, \isopol_i, \isopol_i, \pospol_{i+1}, \ldots, \pospol_{n-1}} &: \vec a \to \vec a, \\
				\dashv
				\flat_i = \cohdisc_i \cohfget_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-2}, \nonpol_{i-1}, \nonpol_{i-1}, \pospol_{i+1}, \ldots, \pospol_{n-1}} &: \vec a \to \vec a
			\end{align*}
			\begin{itemize}
				\item If $a_i = \ypolar$, then there are no further left adjoints.
				\item If $a_i = \npolar$, then $\cohpi_i = \cohfget_{i-1}$ and we can continue.
			\end{itemize}
		\end{itemize}
		\item If $i = n-1$, then $\cohfget_{n-1}$ has a right adjoint $\cohfget_{n-1} \dashv \cohcodisc_{n-1}$ with
		\begin{align*}
			\cohfget_{n-1} &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{n-2}} &: \vec a \to \vec b, \\
			\dashv
			\cohcodisc_{n-1} &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{n-2}, \nonpol_\top} &: \vec b \to \vec a,
		\end{align*}
		and there are no further right adjoints.
		We have $\cohfget_{n-1} \cohcodisc_{n-1} = \id_{\vec b}$.
		We get an idempotent monad
		\[
			\sharp_{n-1} = \cohcodisc_{n-1} \cohfget_{n-1} = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{n-2}, \nonpol_\top} : \vec a \to \vec a.
		\]
		\item If $i < n-1$, then $\cohfget_i$ has a right adjoint $\cohfget_i \dashv \cohcodisc_i$ with
		\[
			\cohcodisc_i = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \mixpol_{i}, \pospol_{i}, \ldots, \pospol_{n-2}} : \vec b \to \vec a.
		\]
		We have $\cohfget_i \cohcodisc_i = \id_{\vec b}$. We get an idempotent monad
		\[
			\sharp_i = \cohcodisc_i \cohfget_i = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \mixpol_{i+1}, \pospol_{i+1}, \ldots, \pospol_{n-1}} : \vec a \to \vec a.
		\]
		\begin{itemize}
			\item If $a_{i+1} = b_i = \ypolar$, then there are no further right adjoints.
			\item If $a_{i+1} = b_i = \npolar$, then we have $\cohfget_i \dashv \cohcodisc_i \dashv \cohcopi_i$ with
			\begin{align*}
				\cohfget_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \nonpol_{i+1}, \pospol_{i+2}, \ldots, \pospol_{n-1}} &: \vec a \to \vec b, \\
				\dashv
				\cohcodisc_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \nonpol_{i}, \nonpol_{i}, \pospol_{i+1}, \ldots, \pospol_{n-2}} &: \vec b \to \vec a, \\
				\dashv
				\cohcopi_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \mixpol_i, \pospol_{i+2}, \ldots, \pospol_{n-1}} &: \vec a \to \vec b.
			\end{align*}
			We have $\cohfget_i \cohcodisc_i = \cohcopi_i \cohcodisc_i = \id_{\vec b}$. We get adjoint idempotent (co)monads
			\begin{align*}
				\sharp_i = \cohcodisc_i \cohfget_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \nonpol_{i+1}, \nonpol_{i+1}, \pospol_{i+2}, \ldots, \pospol_{n-1}} &: \vec a \to \vec a, \\
				\dashv
				\coshp_i = \cohcodisc_i \cohcopi_i &= \reshlist{\nonpol_\eqtydeg}{\pospol_0, \ldots, \pospol_{i-1}, \mixpol_{i}, \mixpol_{i}, \pospol_{i+2}, \ldots, \pospol_{n-1}} &: \vec a \to \vec a.
			\end{align*}
			\begin{itemize}
				\item If $a_i = \ypolar$, then there are no further right adjoints.
				\item If $a_i = \npolar$, then
				\[
					\begin{array}{c c c c c c c c c}
						\cohdisc_i
						&\dashv&
						\cohfget_i
						&\dashv&
						\cohcodisc_i
						&\dashv&
						\cohcopi_i
						&&
						\\
						&&
						\rotatebox{90}{$=$}
						&&
						\rotatebox{90}{$=$}
						&&
						\rotatebox{90}{$=$}
						&&
						\\
						&&
						\cohpi_{i+1}
						&\dashv&
						\cohdisc_{i+1}
						&\dashv&
						\cohfget_{i+1}
						&\dashv&
						\cohcodisc_{i+1},
						\\
						\phantom{a}
						\\
						\phantom{a}
						\\
						\flat_i
						&\dashv&
						\sharp_i
						&\dashv&
						\coshp_i
						\\
						&&
						\rotatebox{90}{$=$}
						&&
						\rotatebox{90}{$=$}
						&&
						\\
						&&
						\shp_{i+1}
						&\dashv&
						\flat_{i+1}
						&\dashv&
						\sharp_{i+1},
					\end{array}
				\]
				and we can continue.
			\end{itemize}
		\end{itemize}
	\end{itemize}
\end{example}
\begin{example} \label{ex:pjb-paramty} \todo{Make sure to refer correctly.}
	We use the notations from \cref{sec:pb}.
	Let $\vec a = \maskopypolar{[\ypolar, \ypolar]}{\maskpjb} = [\npolar, \ypolar, \npolar, \npolar, \ypolar, \npolar]$ and $\vec b = \maskopypolar{[\ypolar]}{\maskpjb} = [\npolar, \ypolar, \npolar]$.
	We have the following chain of adjoint reshuffles, now annotated with big degrees, which cannot be extended on either side:
	\begin{align*}
		\cohpi_0^{\maskopfont{PJB}} &= \reshlist{\nwbridgepol_0}{\nwpathpol_1, \nwpospol_1, \nwbridgepol_1} &: \vec a \to \vec b, \\
		\dashv
		\cohdisc_0^{\maskopfont{PJB}} &= \reshlist{\nonpol_\eqtydeg}{\nonpol_\eqtydeg, \nonpol_\eqtydeg, \nonpol_\eqtydeg, \nwpathpol_0, \nwpospol_0, \nwbridgepol_0} &: \vec b \to \vec a, \\
		\dashv
		\cohpi{}_0^{\maskopfont{JB};}{}_1^{\maskopfont{P}} =
		\cohfget_0^{\maskopfont{PJB}} &= \reshlist{\nonpol_\eqtydeg}{\nwpathpol_1, \nwpospol_1, \nwbridgepol_1} &: \vec a \to \vec b, \\
		\dashv
		\cohdisc{}_0^{\maskopfont{JB};}{}_1^{\maskopfont{P}} =
		\cohcodisc_0^{\maskopfont{PJB}} &= \reshlist{\nonpol_\eqtydeg}{\nwpathpol_0, \nwpathpol_0, \nwpathpol_0, \nwpathpol_0, \nwpospol_0, \nwbridgepol_0} &: \vec b \to \vec a, \\
		\dashv
		\cohfget{}_0^{\maskopfont{JB};}{}_1^{\maskopfont{P}} =
		\cohcopi_0^{\maskopfont{PJB}} &= 
		\reshlist{\nonpol_\eqtydeg}{\nwpathpol_0, \nwpospol_1, \nwbridgepol_1} &: \vec a \to \vec b, \\
		\dashv
		\cohcodisc{}_0^{\maskopfont{JB};}{}_1^{\maskopfont{P}} =
		\phantom{\cohcopi_0^{\maskopfont{PJB}}} &\mathrel{\phantom{=}} 
		\reshlist{\nonpol_\eqtydeg}{\nwpathpol_0, \nwmixpol_0, \nwmixpol_0, \nwmixpol_0, \nwpospol_0, \nwbridgepol_0} &: \vec b \to \vec a.
	\end{align*}
	The function type with modality $\cohfget_0^{\maskopfont{PJB}}$ will take a limit of a covariant functor, and could be called `covariant naturality'.
	The modality $\cohcodisc_0^{\maskopfont{PJB}}$ will be used to lift structure inhabiting a covariant functor to $\Type^{\vec b}$, to mode $\vec a$, e.g. to build the category of pointed types. It could be called `covariant structurality', generalizing the structural modality in Degrees of Relatedness \cite{reldtt}.\todo{Not 100\% sure right now.}
\end{example}
%\begin{example}
%	Let $\vec a = \maskopypolar{[\ypolar, \ypolar]}{\maskrpj} = [\npolar, \npolar, \ypolar, \npolar, \npolar, \ypolar]$ and $\vec b = \maskopypolar{[\ypolar]}{\maskrpj} = [\npolar, \npolar, \ypolar]$.
%	We have the following chain of adjoint reshuffles, now annotated with big degrees, which cannot be extended on either side:
%	\begin{align*}
%		\cohpi_0 &= \reshlist{\nwinfrajetsym_0}{\nwrodsym_1, \nwpathsym_1, \nwjetsym_1} &: \vec a \to \vec b, \\
%		\dashv
%		\cohdisc_0 &= \reshlist{\eqtysym}{\eqtysym, \eqtysym, \eqtysym, \nwrodsym_0, \nwpathsym_0, \nwjetsym_0} &: \vec b \to \vec a, \\
%		\dashv
%		\cohfget_0 &= \reshlist{\eqtysym}{\nwrodsym_1, \nwpathsym_1, \nwjetsym_1} &: \vec a \to \vec b, \\
%		\dashv
%		\cohcodisc_0 &= \reshlist{\eqtysym}{\nwrodsym_0, \nwrodsym_0, \nwrodsym_0, \nwrodsym_0, \nwpathsym_0, \nwjetsym_0} &: \vec b \to \vec a, \\
%		&\dashv
%		\reshlist{\eqtysym}{\nwrodsym_0, \nwpathsym_1, \nwjetsym_1} &: \vec a \to \vec b, \\
%		&\dashv
%		\reshlist{\eqtysym}{\nwrodsym_0, \nwpathsym_1, \nwpathsym_1, \nwpathsym_1, \nwpathsym_1, \nwjetsym_1} &: \vec b \to \vec a, \\
%		&\dashv
%		\reshlist{\eqtysym}{\nwrodsym_0, \nwpathsym_0, \nwjetsym_1} &: \vec a \to \vec b, \\
%		&\dashv
%		\reshlist{\eqtysym}{\nwrodsym_0, \nwpathsym_1, \nwequijetsym_1, \nwequijetsym_1, \nwequijetsym_1, \nwjetsym_1} &: \vec b \to \vec a.
%	\end{align*}
%\end{example}

\subsubsection{Additional Results}
\begin{proposition} \label{thm:poresh-op}
	Let $\mu : \vec a \to \vec b$ be a polarized reshuffle, $a_i = b_j = \ypolar$, and let $j \cdot \mu \in \accol{\pospol_i, \negpol_i}$.
	Then $\Op_j \circ \mu = \mu \circ \Op_i$.
\end{proposition}
\begin{proof}
	We prove this if $j \cdot \mu = \pospol_i$; otherwise we can set $\mu' = \Op_j \circ \mu$. Clearly, we have:
	\[
		j \cdot (\Op_j \circ \mu) = \negpol_j \circ \mu = \negpol_i = (j \cdot \mu) \circ \Op_i.
	\]
	Now if $j' \neq j$, then we have
	\begin{align*}
		j' \cdot (\Op_j \circ \mu) &= \pospol_{j'} \circ \mu = j' \cdot \mu, \\
		j' \cdot (\mu \circ \Op_j) &= (j' \cdot \mu) \circ \Op_j,
	\end{align*}
	so we have to prove that $(j' \cdot \mu) \circ \Op_j = j' \cdot \mu$.
	This is the case if either $\getdeg(j' \cdot \mu) \neq i$ or $\getpol(j' \cdot \mu)$ is symmetric. But that follows from the fact that $j' \cdot \mu \ll j \cdot \mu$ or $j \cdot \mu \ll j' \cdot \mu$.
\end{proof}
\begin{proposition} \label{thm:poresh-adjoint-directed}
	Let $\lambda : \vec a \to \vec b$ be a polarized reshuffle with adjoint $\lambda \dashv \rho$. Let $a_i = b_j = \ypolar$. Then we have:
	\begin{itemize}
		\item $j \cdot \lambda = \pospol_i \quad\Leftrightarrow\quad i \cdot \rho = \pospol_j$,
		\item $j \cdot \lambda = \negpol_i \quad\Leftrightarrow\quad i \cdot \rho = \negpol_j$.
	\end{itemize}
\end{proposition}
\begin{proof}
	We will prove the first equivalence. The second one then follows by considering $\lambda' = \Op_j \circ \lambda = \lambda \circ \Op_i$ and its adjoint $\rho' = \Op_i \circ \rho = \rho \circ \Op_j$.
	
	We decompose the equality as $\pospol_i \leq j \cdot \lambda < \isopol_i$.
	For the first inequality, we have
	\[
		\pospol_i \leq j \cdot \lambda
		\quad\Leftrightarrow\quad
		\pospol_i \leq \pospol_j \circ \lambda
		\quad\Leftrightarrow\quad
		\pospol_i \circ \rho \leq \pospol_j
		\quad\Leftrightarrow\quad
		i \cdot \rho \leq \pospol_j.
	\]
	On the other hand, we have
	\begin{align*}
		&\quad\mathrel{\phantom{\Leftrightarrow}}\quad
		\isopol_i > j \cdot \lambda
		\\ &\quad\Leftrightarrow\quad
		\isopol_i \not\leq \pospol_j \circ \lambda
		& \text{(\Cref{thm:deg-vs-poldeg-poresh}. Sym.\ pol.\ degrees are always comparable)}
		\\ &\quad\Leftrightarrow\quad
		\isopol_i \circ \rho \not\leq \pospol_j
		& \text{($\loch \circ \rho \dashv \loch \circ \lambda$)}
		\\ &\quad\Leftrightarrow\quad
		\isopol_i \circ \rho > \pospol_j
		& \text{Sym.\ pol.\ degrees are always comparable)}&.
	\end{align*}
	Since $\getdeg(\isopol_i \circ \rho) = \getdeg(i \cdot \rho)$, we can conclude that both must be equal to $j$. Then from $i \cdot \rho \leq \pospol_j$, it follows that $i \cdot \rho \in \accol{\mixpol_j, \pospol_j}$.
	Then $\isopol_i \circ \rho > \pospol_j$ rules out $\mixpol_j$, so we conclude that $i \cdot \rho = \pospol_j$.
\end{proof}

\section{Semantics on Jet Sets and Jet Setoids} \label{sec:poresh-jetset}
\begin{notation} \label{not:enriched}
	Let $\catV$ be a monoidal category.
	We write $\catV \Cat$ for the category of $\catV$-enriched categories.
	
	Let $F : \catV \to \catW$ be a monoidal functor. Then we write $F_1 : \catV \Cat \to \catW \Cat$ for the functor that applies $F$ Hom-wise.
\end{notation}
\begin{definition} \label{def:setoid}
	A \textbf{setoid} is a set equipped with an equivalence relation $\eqtysym$.
	A \textbf{setoid morphism} is a function between setoids respecting $\eqtysym$.
	This defines the category $\Setoid$ of setoids.
	
	A setoid is called \textbf{discrete} if the equivalence relation is the equality relation.
	
	$\Setoid$ can be regarded as a $\Setoid$-enriched category by considering setoid morphisms equivalent if they are pointwise equivalent.
\end{definition}
\begin{definition} \label{def:setoid-cohesion}
	We have an adjoint triple $\setoidquot \dashv \setoiddisc \dashv \setoidfget$ between the (ordinary) category of setoids and $\Set$:
	\begin{itemize}
		\item $\setoidquot : \Setoid \to \Set$ quotients out the equivalence relation,
		\item $\setoiddisc : \Set \to \Setoid$ equips a set with a discrete equivalence relation (i.e.\ the equality relation),
		\item $\setoidfget : \Setoid \to \Set$ forgets the equivalence relation.
	\end{itemize}
\end{definition}
We can now use $\setoidfget_1 : \Setoid\Cat \to \Cat$ to disambiguate between the setoid-enriched category of setoids $\Setoid$ and the ordinary category of setoids $\setoidfget_1 \Setoid$.
\begin{corollary} \label{thm:setoid-equiv-set}
	The \emph{setoid-enriched} quotient and discrete functor $\setoidquot : \Setoid \to \setoiddisc_1 \Set$ and $\setoiddisc : \setoiddisc_1 \Set \to \Setoid$ form an equivalence of $\Setoid$-enriched categories (where $\setoiddisc \setoidquot$ is only naturally \emph{equivalent}, not naturally isomorphic, to the identity functor). \qed
\end{corollary}
\begin{definition} \label{def:jetsetoid}
	We define the category $\jetsetoid{\vec a}$ of \textbf{$\vec a$-jet-setoids} as the following strict pullback:
	\[
		\xymatrix{
			\jetsetoid{\vec a}
				\xydrcorner
				\ar@{.>}[r]
				\ar@{.>}[d]
			&
			\jetset{\vec a}
				\ar[d]^U
			\\
			\Setoid
				\ar[r]_\setoidquot
			&
			\Set
		}
	\]
	where $U$ sends a jet set to its carrier and $\setoidquot$ quotients out the equivalence relation.
	In other words, a jet setoid $X$ is a setoid $X$ with a jet set structure on $\setoidquot X$.
	However, rather than working with equivalence classes explicitly, we will pull back the jet set structure along $[\loch] : X \to \setoidquot X$ and consider an equivalence-respecting jet set structure directly on $X$.
	A jet setoid morphism is then a setoid morphism $f : X \to Y$ such that $x_1 \jet_i x_2$ for $x_1, x_2 \in X$ implies $f(x_1) \jet_i f(x_2)$.
	
	We turn $\jetsetoid{\vec a}$ into a $\Setoid$-enriched category by declaring morphisms equivalent if the underlying setoid morphisms are equivalent.
\end{definition}
\begin{corollary} \label{thm:jetsetoid-cohesion}
	The adjunction $\setoidquot \dashv \setoiddisc$ of categories from \cref{def:setoid-cohesion} carries over to an adjunction $\setoidquot \dashv \setoiddisc$ between $\setoidfget_1 \jetsetoid{\vec a}$ and $\jetset{\vec a}$. \qed
\end{corollary}
\begin{corollary} \label{thm:jetsetoid-equiv-jetset}
	The equivalence of setoid-enriched categories from \cref{thm:setoid-equiv-set} carries over to an equivalence of setoid-enriched categories $\jetsetoid{\vec a} \simeq \setoiddisc_1 \jetset{\vec a}$. \qed
\end{corollary}
\begin{definition}
	\label{def:poresh-jetsetoid}
	\label{def:poresh-jetset}
	\begin{enumerate}
		\item We define a strict\footnote{Assuming propositional extensionality.} 2-functor $\jetsetoidsym : \poreshcat \to \Setoid\Cat$ from the 2-category of polarized reshuffles to the 2-category of setoid-enriched categories:
		\begin{itemize}
			\item Sending an object $\vec a$ to $\jetsetoid{\vec a}$.
			\item Sending a morphism $\mu : \vec a \to \vec b$ to $\jetsetoid{\mu} : \jetsetoid{\vec a} \to \jetsetoid{\vec b}$ where $\jetsetoid{\mu}$ (more briefly denoted as $\mu$) sends a jet setoid $X$ to the jet setoid $\mu X$ whose
			\begin{itemize}
				\item carrier is the carrier of $X$,
				%quotiented out by the transitive closure of $\eqtysym \cdot \mu$ in case $\eqtysym \cdot \mu \neq \eqtysym$,
				\item equivalence relation $\eqtysym^{\mu X}$ is given by transitive closure of $\eqtysym \oriof \mu$ on $X$,
				\item $i$-jet relation $\jetsym_i^{\mu X}$ is given by the relation $\jetsym_i \cdot \mu$ on $X$, made stable under $\eqtysym^{\mu X}$, i.e. we have
				$\jetsym_i^{\mu X} = (\eqtysym \oriof \mu)^* \otimes (\jetsym_i \cdot \mu) \otimes (\eqtysym \oriof \mu)^*$, where $\otimes$ is composition of relations via existential quantification.
	%			\item $\hat x \jet_i^{\mu X} \hat y$ if and only if $\hat x$ and $\hat y$ have representants $x$ and $y$ related by $\jetsym_i \cdot \mu$ in $X$.
	%			This is in turn equivalent to saying that all representants of $\hat x$ and $\hat y$ are related by $(\eqtysym \cdot \mu)^* \otimes (\jetsym_i \cdot \mu) \otimes (\eqtysym \cdot \mu)^*$ in $X$, where $\otimes$ is composition of relations via existential quantification.
			\end{itemize}
			$\jetsetoid{\mu}$ is easily seen to have a functorial action on jet set morphisms which preserves identity and composition.
			\item Sending a unique proof of inequality $\mu \leq \nu : \vec a \to \vec b$ to an obvious natural transformation $\ket{\mu \leq \nu} : \mu \to \nu : \jetsetoid{\vec a} \to \jetsetoid{\vec b}$ whose underlying function is the identity function.
		\end{itemize}
		
		\item By \cref{thm:jetsetoid-equiv-jetset}, we obtain a pseudofunctor $\jetsetsym : \poreshcat \to \Cat$:
		\begin{itemize}
			\item Sending an object $\vec a$ to $\jetset{\vec a}$,
			\item Sending a morphism $\mu : \vec a \to \vec b$ to $\jetset{\mu} = \setoidquot \circ \jetsetoid{\mu} \circ \setoiddisc : \jetset{\vec a} \to \jetset{\vec b}$,
			\item \ldots
		\end{itemize}
		
		\item Additionally, if we consider only modalities $\mu$ satisfying \cref{eq:poresh-withl-crit1} (i.e.\ those for which $\eqtydeg \cdot \mu = \nonpol_\eqtydeg$) and denote the restricted 2-poset as $\poreshcat \noquot$, then we directly get a strict 2-functor $\jetsetsym \noquot : \poreshcat \noquot \to \Cat$, equivalent to the pseudofunctor above:
		\begin{itemize}
			\item Sending an object $\vec a$ to $\jetset{\vec a}$,
			\item Sending a morphism $\mu : \vec a \to \vec b$ to $\jetsetl{\mu} : \jetset{\vec a} \to \jetset{\vec b}$ where $\jetsetl{\mu}$ (more briefly denoted as $\mu$) sends a jet set $X$ to the jet set $\mu X$ whose
			\begin{itemize}
				\item carrier is the carrier of $X$,
				\item $i$-jet relation $\jetsym_i^{\mu X}$ is the relation $\jetsym_i \oriof \mu$ on $X$.
			\end{itemize}
			\item \ldots
		\end{itemize}
	\end{enumerate}
\end{definition}
\begin{corollary} \label{thm:poresh-jetsetoid:bind}
	Let $\mu : \vec a \to \vec b$ and $X \in \jetsetoid{\vec a}$.
	For an arbitrary $Q_j \in \oridegeqtop(\vec b)$, the relation $Q_j$ on $\mu X$ is given by $(\eqtysym \oriof \mu)^* \otimes (Q_j \oriof \mu) \otimes (\eqtysym \oriof \mu)^*$.
	Here, $\topsym$ is interpreted as `true'.
	
	If $\mu$ has a left adjoint and $X \in \jetset{\vec a}$, then for an arbitrary $Q_j \in \oripsh(\vec b)$, the relation $Q_j$ on $\mu X$ is given by  $Q_j \oriof \mu$. \qed
\end{corollary}
\begin{example} \label{ex:poresh-op-jetset}
	The functor $\Op_i$ from \cref{def:op} arises from the reshuffle in \cref{ex:poresh-op} as $\jetsetl{\Op_i}$.
\end{example}
\begin{example} \label{ex:poresh-sym-jetset}
	The functors $\Fsym_i \dashv \Usym_i \dashv \Csym_i$ and $\UFsym_i \dashv \UCsym_i$ from \cref{def:sym-forget,def:sym-free,def:sym-cofree} arise from the reshuffles in \cref{ex:poresh-sym} as
	\[
		\jetsetl{\Fsymresh_i} \dashv \jetsetl{\Usymresh_i} \dashv \jetsetl{\Csymresh_i},
	\]
	\[
		\jetsetl{\UFsymresh_i} \dashv \jetsetl{\UCsymresh_i}.
	\]
\end{example}

\subsection{Intervals and Prisms}
\begin{definition} \label{def:jetsetoid-interval}
	We view the intervals from \cref{def:interval} not just as jet sets but also as (discrete) jet setoids. We additionally introduce $\rival{\eqtysym}$, the jet setoid on $\accol{0, 1}$ generated by $0 \eqty 1$, and $\rival{\topsym}$ as the jet set or jet setoid on $\accol{0, 1}$ where the equivalence and all $i$-jet relations are reflexive.
\end{definition}
\begin{proposition} \label{thm:poresh-jetsetoid-intervals}
	Let $\mu : \vec a \to \vec b$ be a polarized reshuffle with right adjoint $\mu \dashv \rho$. Then we have%
	\footnote{By virtue of \cref{thm:poresh-adjoint}, all right hand sides are defined since $P_i \oriof \rho \neq \infrajetsym_j$ for $b_j = \ypolar$.}
	\begin{equation}
		\jetsetoid{\mu} \rival{\jetsym_i} = \rival{\jetsym_i \oriof \rho}, \quad
		\jetsetoid{\mu} \rival{\tejsym_i} = \rival{\tejsym_i \oriof \rho}, \quad
		\jetsetoid{\mu} \rival{\equijetsym_i} = \rival{\equijetsym_i \oriof \rho}.
		\label{eq:poresh-jetsetoid-intervals}
	\end{equation}
\end{proposition}
\begin{proof}
	By \cref{thm:poresh-adjoint}, $P_i \oriof \rho$ is the least symbol (i.e. the strictest relation) $Q_j$ such that $P_i \leq Q_j \oriof \mu$, i.e. so that $0 \mathrel{Q_j} 1$ in $\mu \rival{P_i}$.
	This means that the jet setoid structure of $\mu \rival{P_i}$ is indeed generated by $0 \mathrel{(P_i \oriof \rho)} 1$.
\end{proof}
\begin{definition} \label{def:jetsetoid-prism}
	We define the prism functors from \cref{def:prism} on jet setoids:
	\begin{itemize}
		\item The carrier is still $X \times \accol{0, 1}$,
		\item We set $(x, u) \eqty (y, v)$ if $x \eqty y$ and $u = v$, i.e.\ the underlying setoid is $X \times \rival{\topsym}$.
		\item Jet relations are generated as in \cref{def:prism}.
	\end{itemize}
\end{definition}
\begin{definition} \label{def:jetsetoid-separated-product}
	We adapt \cref{def:separated-product} of the separated product to jet setoids by taking the cartesian product of the underlying setoids and replacing equality with equivalence in \cref{def:separated-product}.
\end{definition}
\begin{lemma} \label{thm:poresh-jetsetoid-cocontinuous}
	Let $\mu : \vec a \to \vec b$ be a polarized reshuffle.
	Then $\jetsetoid{\mu}$, seen as a non-enriched functor, preserves colimits.
\end{lemma}
\begin{proof}
	Take a diagram $D : \cat S \to \jetsetoid{\vec a}$.
	We prove (assuming propositional extensionality) that
	\[
		\mu \colim D = \colim (\mu  \circ D).
	\]
	\begin{itemize}
		\item The functor $\jetsetoid{\mu}$ does not modify the carrier, and the carrier of a colimit of jet setoids is the colimit of the carriers.
		Write $\iota_s$ for the functions $D(s) \to \colim D$.
		\item One checks that, on both sides, elements $x$ and $y$ are equivalent if and only if there exist $x = x_0, x_1, x_2, \ldots, x_n = y$ such that for each $0 \leq i < n$, there exists an $s \in \Obj(\cat S)$ and $u, v \in D(s)$ such that $x_i = \iota_s(u)$ and $x_{i+1} = \iota_s(v)$ and $u \mathrel{(\eqtysym \oriof \mu)} v$.
		\item One checks that, on both sides, $x \jet_i y$ holds in $\mu \colim D$ if and only if there exist an $s \in \Obj(\cat S)$, $x \eqty^{\mu \colim D} \iota_s(x')$ and $y \eqty^{\mu \colim D} \iota_s(y')$ such that $x' \mathrel{(\jetsym_i \cdot \mu)} y'$ in $D(s)$. \qedhere
	\end{itemize}
\end{proof}
\begin{proposition} \label{thm:poresh-jetsetoid-prism-commut}
	Let $\mu : \vec a \to \vec b$ be a polarized reshuffle with right adjoint $\mu \dashv \rho$.
	Then the action of $\jetsetoid{\mu}$ on prisms can be looked up in the following table:%
	\footnote{Note that if $b_j = \npolar$, then the results for $\nonpol_j$ are consistent.}%
	\footnote{Note that if $i \cdot \rho = \isopol_j$, then by \cref{eq:poresh-withl-crit2}, $b_j = \npolar$.}
	\[
		\begin{array}{c || c | c | c | c | c}
			i \cdot \rho 
			& \nonpol_\eqtydeg 
			& \mixpol_j
			& \pospol_j
			& \negpol_j 
			& \nonpol_\top 
			\\ \hline
			\mu(X \multip \rival{\jetsym_i})
			& (\mu X) \times \rival{\eqtysym}
			& (\mu X) * \rival{\equijetsym_j}
			& (\mu X) \multip \rival{\jetsym_j}
			& (\Op_j\mu X) \multip \rival{\tejsym_j}
			& (\mu X) \times \rival{\topsym}
			\\
			\mu(X \multip \rival{\tejsym_i})
			& (\mu X) \times \rival{\eqtysym}
			& (\mu X) * \rival{\equijetsym_j}
			& (\mu X) \multip \rival{\tejsym_j}
			& (\Op_j\mu X) \multip \rival{\jetsym_j}
			& (\mu X) \times \rival{\topsym}
		\end{array}
	\]
\end{proposition}
Note that a cartesian product with $\rival{\eqtysym}$ or $\rival{\topsym}$ is the same as a separated product, since neither jet setoid has any jets between non-equivalent elements.
\begin{proof}
	We mainly prove the upper row of the table
	For the lower row, we use that $X \multip \rival{\tejsym_i} = \Op_i(X \multip \rival{\jetsym_i})$ so the result can be derived from the upper row if we can rewrite $\mu \circ \Op_i$.
	
	Each time, it is clear that the carrier is just $X \times \accol{0, 1}$.
	We can write $X \multip \rival{\jetsym_i}$ as the colimit of $\Op_i(X)$, $X$, a copy of $\rival{P_i}$ for every element of $X$, and a copy of the terminal jet setoid for every element of $X \times \accol{0, 1}$.
	By \cref{thm:poresh-jetsetoid-cocontinuous}, $\jetsetoid{\mu}$ preserves that colimit.
	By \cref{thm:poresh-jetsetoid-intervals}, $\mu \rival{\jetsym_i} = \rival{\jetsym_i \oriof \rho}$.
	Thus, we see that $\mu (X \multip \rival{\jetsym_i})$ is a colimit of $\mu \Op_i X$, $\mu X$ and copies of $\rival{\jetsym_i \oriof \rho}$.
	We case distinguish on $i \cdot \rho$.
	\begin{description}
		\item[\framebox{$\nonpol_\eqtydeg$}] If $i \cdot \rho = \nonpol_\eqtydeg$, then $\Op_i \circ \rho = \rho$.
		Then by uniqueness of the adjoint, $\mu \circ \Op_i = \mu$.
		Then the colimit produces $(\mu X) * \rival{\edgesym_\eqtydeg}$, and the result for the opposite prism is the same.
%		
%		then from \cref{eq:poresh-adjoint-crit-orideg} in the statement of \cref{thm:poresh-adjoint}, we conclude that $\pospol_i \leq \nonpol_\eqtydeg \oriof \mu$.
%		By symmetry of $\nonpol_\eqtydeg \oriof \mu$, we can conclude that $\isopol_i \leq \nonpol_\eqtydeg \oriof \mu$, so that $\mu$ cannot mention degree $i$ in any form other than $\isopol_i$ and therefore $\mu = \mu \circ \Op_i$. Then the colimit produces $(\mu X) * \rival{\eqty} = (\mu X) \times \rival{\eqty}$, and the result for the opposite prism is the same.
		
		\item[\framebox{$\mixpol_j$}] If $i \cdot \rho = \mixpol_j$, then $\Op_i \circ \rho = \rho$.
		Then by uniqueness of the adjoint, $\mu \circ \Op_i = \mu$.
		Then the colimit produces $(\mu X) * \rival{\equijetsym_j}$, and the result for the opposite prism is the same.
		
		\item[\framebox{$\pospol_j$}] If $i \cdot \rho = \pospol_j$, then by \cref{thm:poresh-adjoint-directed}, $j \cdot \mu = \pospol_i$ and $\mu \circ \Op_i = \Op_j \circ \mu$.
		This means that we are taking the $j$-opposite at the original source-side of the twisted prism, which is also the new source-side, so we get a $j$-twisted prism $(\mu X) \multip \rival{\jetsym_j}$.
		The image of the $i$-opposite is then the $j$-opposite of the image, which is the opposite prism $(\mu X) \multip \rival{\tejsym_j}$.
		
		\item[\framebox{$\negpol_j$}] If $i \cdot \rho = \negpol_j$, then by \cref{thm:poresh-adjoint-directed}, $j \cdot \mu = \negpol_i$ and $\mu \circ \Op_i = \Op_j \circ \mu$.
		This means that we are taking the $j$-opposite at the original source-side of the twisted prism, which is the new \emph{target}-side. Equivalently, we can take the $j$-opposite on both sides and then again at the source-side, so we get a $j$-twisted prism $(\Op_j \mu X) \multip \rival{\jetsym_j}$.
		The image of the $i$-opposite is then the $j$-opposite of the image, which is the opposite prism $(\Op_j \mu X) \multip \rival{\tejsym_j}$.
		
		\item[\framebox{$\nonpol_\top$}] If $i \cdot \rho = \nonpol_\top$, then $\Op_i \circ \rho = \rho$.
		Then by uniqueness of the adjoint, $\mu \circ \Op_i = \mu$.
		Then the colimit produces $(\mu X) * \rival{\edgesym_\top} = (\mu X) \times \rival{\edgesym_\top}$, and the result for the opposite prism is the same. \qedhere
	\end{description}
\end{proof}

\section{Semantical Notations} \label{sec:notations}

\subsection{Presheaf Notations} \label{sec:notations:psh}
We use the presheaf notations from \cite{reldtt-techreport}. Concretely:
\begin{itemize}
	\item The application of a presheaf $\Gamma \in \widehat \catW$ to an object $W \in \catW$ is denoted $\DSub W \Gamma$.
	\item The restriction of $\gamma : \DSub W \Gamma$ by $\vfi : V \to W$ is denoted $\gamma \circ \vfi$ or $\gamma \vfi$.
	\item The application of a presheaf morphism $\sigma : \Gamma \to \Delta$ to $\gamma : \DSub W \Gamma$ is denoted $\sigma \circ \gamma$ or $\sigma \gamma$.
	\begin{itemize}
		\item By naturality of $\sigma$, we have $\sigma \circ (\gamma \circ \vfi) = (\sigma \circ \gamma) \circ \vfi$.
	\end{itemize}
	\item If $\Gamma \in \widehat \catW$ and $T \in \Ty(\Gamma)$ (also denoted $\Gamma \sez T \type$), i.e. $T$ is a presheaf over the category of elements $\catW/\Gamma$, then we write the application of $T$ to $(W, \gamma)$ as $(W \Dsez T \dsub \gamma)$ and $t \in (W \Dsez T \dsub \gamma)$ as $W \Dsez t : T \dsub \gamma$.
	\begin{itemize}
		\item By definition of type substitution in a presheaf CwF, we have $(W \Dsez T[\sigma] \dsub \gamma) = (W \Dsez T \dsub{\sigma \gamma})$
	\end{itemize}
	\item The restriction of $W \Dsez t : T \dsub \gamma$ by $\vfi : (V, \gamma \circ \vfi) \to (W, \gamma)$ is denoted as $W \Dsez t \psub \vfi : T \dsub{\gamma \vfi}$.
	\item If $t \in \Tm(\Gamma, T)$ (also denoted $\Gamma \sez t : T$), then the application of $t$ to $(W, \gamma)$ is denoted $V \Dsez t \dsub \gamma : T \dsub \gamma$.
	\begin{itemize}
		\item The naturality condition for terms is then expressed as $t \dsub \gamma \psub \vfi = t \dsub{\gamma \vfi}$.
		\item By definition of term substitution in a presheaf CwF, we have $t[\sigma] \dsub \gamma = t \dsub{\sigma \gamma}$.
	\end{itemize}
	\item We omit applications of the isomorphisms $(\DSub W \Gamma) \cong (\yoneda W \to \Gamma)$ and $(W \Dsez T \dsub \gamma) \cong (\yoneda W \sez T [\gamma])$.
	This is not unreasonable: e.g. given $W \Dsez t : T \dsub \gamma$, the term $\yoneda W \sez t' : T[\gamma]$ is defined by $t' \dsub \vfi := t \psub \vfi$.
\end{itemize}
One advantage of these notations is that we can put presheaf cells in diagrams; we will use double arrows when doing so.

\subsection{End and Co-ends} \label{sec:notations:end}
We use existential quantifiers over objects of a category to denote ends and co-ends, i.e. if $F : \catC\op \times \catC \to \Set$, then its co-end is denoted $\exists X.F(X, X)$ and its end is denoted $\forall X.F(X, X)$.

\section{Semantics on Jet Topes and Jet-Topic Sets} \label{sec:poresh-jettope-jtset}
In this section, we investigate how polarized reshuffles act on jet topes and on presheaves over these, which we call jet-topic sets.

\subsection{Semantics on Jet Topes} \label{sec:poresh-jettope}
In this section, we want to construct a 2-functor that sends polarized reshuffles $\mu : \vec a \to \vec b$ to functors $\jettope{\vec a} \to \jettope{\vec b}$, thus giving our mode theory of polarized reshuffles a semantics on jet topes.

However, it is pointless to distinguish between two modalities when they have the exact same semantics, and it is at least roughly pointless to do so when they have roughly the same semantics.
Looking at \cref{def:jet-tope} of jet topes, we see that:
\begin{itemize}
	\item Due to $i$-antisymmetry at directed degrees, we know that the $i$-equijet relation is equivalent to the $(i-1)$-infrajet relation (if $i > 0$) or to equality (if $i = 0$).
	This means that a modality $\mu$ will have the same semantics, regardless of whether $j \cdot \mu = \mixpol_i$ or $j \cdot \mu = \isopol_{i-1}$ (if $i > 0$) or $j \cdot \mu = \nonpol_\eqtydeg$ (if $i = 0$).
	For this reason, we will disallow any mentions of $\mixpol_i$ when $a_i = \ypolar$.
	
	\item Due to $(n-1)$-connectedness, the $(n-1)$-infrajet relation is roughly equivalent to the `true' relation.
	For this reason, we will disallow any mentions of $\nonpol_\top$, as $\isopol_{n-1}$ can be mentioned instead.
\end{itemize}
Taking these two requirements together, by \cref{thm:poresh-adjoint}, we get exactly the statement that $\mu$ must have a right adjoint.

\begin{theorem} \label{thm:poresh-jettope}
	Let $\mu \in \Hom_\poreshcat(\vec a, \vec b)$ have a right adjoint $\mu \dashv \rho$.
	Then the functor $\mu : \jetset{\vec a} \to \jetset{\vec b}$ sends jet topes to jet topes if and only if $\rho$ has a further right adjoint $\mu \dashv \rho \dashv \tau$.
	
	By consequence, there is a pseudofunctor $\jettopesym : \poreshcat\withrr \to \Cat$ sending
	\begin{itemize}
		\item an object $\vec a$ to $\jettope{\vec a}$,
		\item a morphism $\mu : \vec a \to \vec b$ to the restriction of $\jetset{\mu} : \jetset{\vec a} \to \jetset{\vec b}$ to $\jettope{\vec a}$,
		\item a 2-cell $\alpha : \mu \to \nu : \vec a \to \vec b$ to the restriction of $\jetset{\alpha}$ to $\jettope{\vec a}$.
	\end{itemize}
\end{theorem}
\begin{proof}
	We first prove the `only if' direction.
	Note that, by \cref{thm:poresh-withrr}, the property that $\rho$ has a further right adjoint is decidable, so we can do this from the absurd.
	Assume that $\rho$ does not have a right adjoint.
	\begin{itemize}
		\item Either $\rho$ violates \cref{eq:poresh-withr-crit1}, i.e. $\predeg(\top) \cdot \rho = \nonpol_\top$.
		Then by \cref{thm:poresh-jetsetoid-intervals}, $\mu \rival{\jetsym_{\predeg(\top)}} = \rival{\edgesym_\top}$, where $\rival{\jetsym_{\predeg(\top)}}$ is a jet tope but $\rival{\edgesym_\top}$ is not, as it is not $(n-1)$-connected (if $n > 0$) or not a subsingleton (if $n = 0$).
		\item Or $\rho : \vec b \to \vec a$ violates \cref{eq:poresh-withr-crit2}, i.e.\ there is some $i \in \Degeq(\vec a)$ with $i \cdot \rho = \mixpol_j$ and $b_j = \ypolar$.
		Then by \cref{thm:poresh-jetsetoid-intervals}, $\mu \rival{\jetsym_i} = \rival{\equijetsym_j}$, where $\rival{\jetsym_i}$ is a jet tope but $\rival{\equijetsym_j}$ is not, as it is not $j$-antisymmetric.
	\end{itemize}
	
	Now we prove the `if' direction.
	Assume that $\rho$ does have a further right adjoint $\mu \dashv \rho \dashv \tau$ and take a jet tope $X$.
	We prove that $\mu X$ is a jet tope (\cref{def:jet-tope}).
	Informed by the construction in \cref{def:poresh-jetset}, we will regard both $X$ and $\mu X$ as jet \emph{setoids}.
	\begin{enumerate}
		\item Clearly, $\setoidquot(\mu X)$ is finite, as $\setoidquot(X)$ was finite.
		
		\item To see that $\mu X$ is $\predeg(\top)$-connected (i.e.\ $(n-1)$-connected if $n > 0$, or $\eqtydeg$-connected if $n = 0$), note that $x \jet_{\predeg(\top)} y$ in $\mu X$ if and only if $x \infrajet_{\eqtydeg \cdot \mu}^* x' \jet_{\predeg(\top) \cdot \mu} y' \infrajet_{\eqtydeg \cdot \mu}^* y$, and in particular if $x \jet_{\predeg(\top) \cdot \mu} y$.
		Now $\predeg(\top) \cdot \mu > \mixpol_{\predeg(\top)}$ by \cref{eq:poresh-withrr-crit1}.
		So $\infrajetsym_{\predeg(\top)} \oriof \mu = \infrajetsym_{\predeg(\top)}$.
		Thus, since $\infrajetsym_{\predeg(\top)}^*$ is always true in $X$, we conclude that $\infrajetsym_{\predeg(\top)}^*$ is always true in $\mu X$.
		
		\item We show that $\mu X$ is $j$-orientable for every $j \in \Deg(\vec b)$. Let $x \infrajet_j^* y$ in $\mu X$.
		Then
		\[
			x \mathrel{((\edgesym_\eqtydeg \oriof \mu)^* \otimes (\infrajetsym_j \oriof \mu) \otimes (\edgesym_\eqtydeg \oriof \mu)^*)^*} y
		\]
		in $X$.
		Now $\eqtydeg < j$ so $\eqtydeg \cdot \mu \ll j \cdot \mu$, so $\edgesym_\eqtydeg \oriof \mu \leq \equijetsym_j \oriof \mu \leq \infrajetsym_j \oriof \mu$, so we can conclude more simply that $x \mathrel{(\infrajetsym_j \oriof \mu)^*} y$.
		By case analysis on $\getpol(j \cdot \mu)$, where the symmetric cases are trivial, and using that $X$ is $\getdeg(j \cdot \mu)$-orientable, we can conclude that $x (\jet_j \oriof \mu)^* y$ or $x (\tej_j \oriof \mu)^* y$ in $X$, and therefore that $x \jet_j^* y$ or $x \tej_j^* y$ in $\mu X$.
		
		\item We show that $\mu X$ is $j$-acyclic for every $j \in \Deg(\vec b)$ by similar reasoning.
		
		\item Assume that $b_j = \ypolar$.
		We show that $\mu X$ is $j$-antisymmetric, i.e. that $x \equijet_j^{\mu X} y$ implies $x \infrajet_{\predeg(j)}^{\mu X} y$.
		Let $p'_{i'} = \predeg(j) \cdot \mu$ and $p_i = j \cdot \mu$.
		We case split on how $i'$ compares to $i$
		\begin{description}
			\item[$i' = i$] Then without relying on $X$ being a jet tope, we can prove $j$-antisymmetry by case distinction on $p'$ and $p$.
			\item[$i' = \predeg(i)$] Then by \cref{eq:poresh-withrr-crit2,eq:poresh-withr-crit2}, we find that $p \in \accol{\pospol, \negpol}$. By \cref{eq:poresh-withr-crit2}, $p' \in \accol{\pospol, \negpol, \isopol}$.
			Thus, we see that $\infrajetsym_{\predeg(j)} \oriof \mu = \infrajetsym_{\predeg(i)}$ and $\equijetsym_j \oriof \mu = \equijetsym_i$.
			Then we can invoke $i$-antisymmetry of $X$.
			\item[$i' < \predeg(i)$] Then we have $\getdeg(\predeg(j) \cdot \mu) < \predeg(i)$ and $j \cdot \mu \geq \isopol_{\predeg(i)}$, so by \cref{eq:poresh-withrr-crit2}, this is impossible as $b_j = \ypolar$. \qedhere
		\end{description}
	\end{enumerate}
\end{proof}

\subsection{Adjoint Triple Semantics on Jet-Topic Sets} \label{sec:poresh-jtset:triple}
\begin{definition}
	The category of \textbf{$\vec a$-jet-topic sets} is the presheaf category $\jtset{\vec a} := \Psh(\jettope{\vec a})$.
\end{definition}
\begin{theorem} \label{thm:poresh-jtset:triple}
	We have the following pseudofunctors:
	\begin{itemize}
		\item $\jtsetsym\withrr : \poreshcat\withrr \to \Cat\withrr$,
		\item $\jtsetsym\withlr : \poreshcat\withlr \to \Cat\withlr$,
		\item $\jtsetsym\withll : \poreshcat\withll \to \Cat\withll$,
	\end{itemize}
	to the 2-category of categories, functors with a specified number of left/right adjoints (\cref{not:poresh-with}), and natural transformations, where:
	\begin{itemize}
		\item each functor sends an object $\vec a$ to $\Psh(\jettope{\vec a})$,
		\item a triple of polarized reshuffles $\mu \dashv \rho \dashv \tau$ is sent by the respective functors to
		\[
			\jtsetsym\withrr(\mu) = \lpsh \mu
			\qquad\dashv\qquad
			\jtsetsym\withlr(\rho) = \fpsh \mu
			\qquad\dashv\qquad
			\jtsetsym\withll(\tau) = \rpsh \mu,
		\]
		of which $\fpsh \mu$ is a strict CwF morphism \cite{dybjer-cwf} and $\rpsh \mu$ is a weak CwF morphism \cite[def.\ 2.1.1]{reldtt-techreport}\cite[def.\ 3.2.5]{nuyts-phd} w.r.t.\ the standard CwF structure on a presheaf category \cite[ch.\ 4]{Hofmann97}\cite[\S 4.1]{nuyts-phd}.
		\item 2-cells are also respected.
	\end{itemize}
\end{theorem}
\begin{proof}
	In general, a functor $F : \catV \to \catW$ gives rise to a triple of adjoint functors $\lpsh F \dashv \fpsh F \dashv \rpsh F$ where $\fpsh F : \Psh(\catW) \to \Psh(\catV)$ is precomposition with $F$ and the other two are left and right Kan extension along $F$ \cite{stacks-adjoints,nlab:lifting-functors}\cite[\S 2.3.8]{nuyts-phd}.
	It is in general true that $\fpsh F$ is a strict CwF morphism and $\rpsh F$ is a weak one \cite[thm.\ 2.2.1 \& prop.\ 2.2.9]{reldtt-techreport}\cite[\S 6.4]{nuyts-phd}.
	
	The middle operation amounts to a strict 2-functor $\Cat\coop \to \Cat$, so the other operations amount to pseudofunctors $\Cat \to \Cat$.
	We compose these operations with the pseudofunctorial semantics of polarized reshuffles on jet topes (\cref{thm:poresh-jettope}), and finally use the fact that $\poreshcat\withll \cong (\poreshcat\withlr)\coop \cong \poreshcat\withrr$, with each isomorphism sending a polarized reshuffle to its left adjoint.
\end{proof}

\subsection{No Adjoint Pair Semantics on Jet-Topic Sets} \label{sec:poresh-jtset:nogo}
\Cref{thm:poresh-jtset:triple} is a fairly good result: any polarized reshuffle that is part of a chain of at least three adjoints, now has semantics on jet-topic sets.
Moreover, if we have a chain of four adjoints $\kappa \dashv \mu \dashv \rho \dashv \tau$, then by uniqueness of the adjoint, we find that $\jtsetsym\withlr(\mu) \cong \jtsetsym\withrr(\mu)$ and similar for $\rho$.
So the 3 pseudofunctors essentially agree on the intersection of their domains.

However, we can have commutative diagrams in $\poreshcat$ each of whose sides has semantics in jet-topic sets, but where the composites of the sides do not have such semantics, so that commutativity is not necessarily preserved.
Consider, for example, the following diagram with polarized reshuffles from \cref{ex:cohesion}:
\[
	\xymatrix{
		[\ypolar]
			\ar[rr]^{\cohpi_0 = \reshlist{\isopol_0}{}}
			\ar[dd]_{\cohcodisc_1 = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \nonpol_\top}}
		&&
		[]
			\ar[dd]^{\cohcodisc_0 = \reshlist{\nonpol_\eqtydeg}{\nonpol_\top}}
		\\ \\
		[\ypolar, \ypolar]
			\ar[rr]_{\cohpi_0 = \reshlist{\isopol_0}{\pospol_1}}
		&&
		[\ypolar]
	}
\]
The horizontal sides are in $\poreshcat\withrr$, since $\cohpi_0 \dashv \cohdisc_0 \dashv \cohfget_0$.
The vertical sides are in $\poreshcat\withll$, since $\cohdisc_i \dashv \cohfget_i \dashv \cohcodisc_i$.
The diagonals compose to $\reshlist{\isopol_0}{\nonpol_\top} : [\ypolar] \to [\ypolar]$, which by \cref{thm:poresh-adjoint} has neither a left, nor a right adjoint.
So each of the sides has semantics on jet-topic sets, but we currently do not know whether the diagram still commutes there.
We cannot invoke the composition law of any pseudofunctor provided by \cref{thm:poresh-jtset:triple}, because the composition operands all require a different pseudofunctor.

Unfortunately, we have the following \textbf{no-go theorem}:
\begin{theorem} \label{thm:poresh-jtset:nogo}
	The following, equivalent\footnote{Assuming an adjoint can be picked if one exists.}, objects \textbf{do not exist}:
	\begin{itemize}
		\item A pseudofunctor $\jtsetsym\withr : \poreshcat\withr \to \Cat\withr$ that extends both $\jtsetsym\withrr$ and $\jtsetsym\withlr$ up to natural isomorphism,
		\item A pseudofunctor $\jtsetsym\withl : \poreshcat\withl \to \Cat\withl$ that extends both $\jtsetsym\withlr$ and $\jtsetsym\withll$ up to natural isomorphism.
	\end{itemize}
\end{theorem}
\begin{proof}
	Assume the former exists, and consider the polarized reshuffles
	\[
		\cohfget_0 = \reshlist{\nonpol_\eqtydeg}{\pospol_1} : [\ypolar, \ypolar] \to [\ypolar], \qquad
		\cohdisc_1 = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \isopol_0} : [\ypolar] \to [\ypolar, \ypolar]
	\]
	from \cref{ex:cohesion}, which compose to $\cohfget_0 \cohdisc_1 = \reshlist{\nonpol_\eqtydeg}{\isopol_0} : [\ypolar] \to [\ypolar]$.
	This latter reshuffle is easily computed to be idempotent, i.e.\ $\reshlist{\nonpol_\eqtydeg}{\isopol_0}^2 = \reshlist{\nonpol_\eqtydeg}{\isopol_0}$.
	Then by pseudofunctoriality, we expect a natural isomorphism $\jtsetsym\withr(\cohfget_0 \cohdisc_1)^2 \cong \jtsetsym\withr(\cohfget_0 \cohdisc_1)$, but we will disprove this.
	
	By pseudofunctoriality, we know that
	\[
		\jtsetsym\withr(\cohfget_0 \cohdisc_1)
		\cong \jtsetsym\withr(\cohfget_0) \circ \jtsetsym\withr(\cohdisc_1)
		\cong \jtsetsym\withlr(\cohfget_0) \circ \jtsetsym\withrr(\cohdisc_1)
		= \fpsh{(\cohdisc_0)} \circ \lpsh{(\cohdisc_1)},
	\]
	where $\cohdisc_0 = \reshlist{\nonpol_\eqtydeg}{\nonpol_\eqtydeg, \pospol_0} : [\ypolar] \to [\ypolar, \ypolar]$.
	Consider the jet-topic set $\yoneda \rival{\jetsym_0} \in \jtset{[\ypolar]}$, which is the Yoneda-embedding of the jet tope $\rival{\jetsym_0} \in \jettope{[\ypolar]}$.
	We compute the sets of 0-jets of its images under either the above functor or its square:
	\begin{align*}
		&\quad\mathrel{\phantom{=}}\quad
		\DSub{\rival{\jetsym_0}}{\fpsh{(\cohdisc_0)} \lpsh{(\cohdisc_1)} \yoneda \rival{\jetsym_0}} \\
		&\quad=\quad \DSub{\cohdisc_0 \rival{\jetsym_0}}{\lpsh{(\cohdisc_1)} \yoneda \rival{\jetsym_0}} \\
		&\quad\cong\quad \DSub{\cohdisc_0 \rival{\jetsym_0}}{\yoneda \cohdisc_1 \rival{\jetsym_0}}
		& \text{($\lpsh F \circ \yoneda \cong \yoneda \circ F$)} \\
		&\quad=\quad \DSub{\rival{\jetsym_0 \oriof \cohfget_0}}{\yoneda \rival{\jetsym_0 \oriof \cohfget_1}}
		& \text{(\cref{thm:poresh-jetsetoid-intervals})} \\
		&\quad=\quad \DSub{\rival{\jetsym_1}}{\yoneda \rival{\jetsym_0}} \\
		&\quad=\quad \rival{\jetsym_1} \to \rival{\jetsym_0}.
	\end{align*}
	Note that, after applying the reshuffles to the jet topes, we obtain jet topes in $\jettope{[\ypolar, \ypolar]}$.
	Since any two nodes in $\rival{\jetsym_0}$ are connected by a $1$-equijet, any function $\accol{0, 1} \to \accol{0, 1}$ between the carriers is a jet set (hence jet tope) morphism.
	
	On the other hand, we have
	\begin{align*}
		&\quad\mathrel{\phantom{=}}\quad
		\DSub{\rival{\jetsym_0}}{\fpsh{(\cohdisc_0)} \lpsh{(\cohdisc_1)} \fpsh{(\cohdisc_0)} \lpsh{(\cohdisc_1)} \yoneda \rival{\jetsym_0}} \\
		&\quad\cong\quad \DSub{\rival{\jetsym_1}}{\lpsh{(\cohdisc_1)} \fpsh{(\cohdisc_0)} \yoneda \rival{\jetsym_0}}
		& \text{(by similar reasoning as above)} \\
		&\quad=\quad
		\exists X^{{}\in \jettope{[\ypolar]}}.(\rival{\jetsym_1} \to \cohdisc_1 X) \times (\DSub{X}{\fpsh{(\cohdisc_0)} \yoneda \rival{\jetsym_0}})
		& \text{(construction of left Kan extension)} \\
		&\quad=\quad
		\exists X^{{}\in \jettope{[\ypolar]}}.(\rival{\jetsym_1} \to \cohdisc_1 X) \times (\cohdisc_0 X \to \rival{\jetsym_0}).
	\end{align*}
	(Note that $\exists$ denotes a co-end (\cref{sec:notations:end}).)
	Now a $1$-jet in $\cohdisc_1 X = \reshlist{\nonpol_\eqtydeg}{\pospol_0, \isopol_0} X$ is a $1$-infrajet in $X$. Such an infrajet either points forwards, in which case $f : \rival{\jetsym_1} \to \cohdisc_1 X$ factors over some $\rival{\jetsym_1} \to \cohdisc_1 \rival{\jetsym_0}$, or it points backwards, in which case it factors over $\rival{\jetsym_1} \to \cohdisc_1 \rival{\tejsym_0}$.
	If it factors over both, since $X$ is a jet tope, by $0$-antisymmetry, it factors over $\rival{\jetsym_1} \to \cohdisc_1 \top$.
	Thus, the result of the computation above is the following pushout
	\begin{align*}
		\ldots &\quad\cong\quad
		(\cohdisc_0 \rival{\jetsym_0} \to \rival{\jetsym_0}) \uplus_{(\cohdisc_0 \top \to \rival{\jetsym_0})} (\cohdisc_0 \rival{\tejsym_0} \to \rival{\jetsym_0}) \\
		&\quad=\quad (\rival{\jetsym_1} \to \rival{\jetsym_0}) \uplus_{(\top \to \rival{\jetsym_0})} (\rival{\tejsym_1} \to \rival{\jetsym_0})
		& \text{(\cref{thm:poresh-jetsetoid-intervals})} \\
		&\quad\cong\quad (\accol{0,1} \to \accol{0, 1}) \uplus_{\accol{0, 1}} (\accol{0,1} \to \accol{0, 1})
	\end{align*}
	so all non-constant functions between the carriers now occur twice!
	The intuitive reason is in fact simple: a $0$-jet in $\jtsetsym\withr(\reshlist{\nonpol_\eqtydeg}{\isopol_0}) \Gamma$ should be a $0$-jet in $\Gamma$ pointing either way, i.e.\ unless the jet is constant, we make a choice in which direction it will point, and then we pick a jet in that direction.
	But then when we apply this operation twice, a $0$-jet in $\jtsetsym\withr(\reshlist{\nonpol_\eqtydeg}{\isopol_0}) \jtsetsym\withr(\reshlist{\nonpol_\eqtydeg}{\isopol_0}) \Gamma$  should be a $0$-jet in $\Gamma$ pointing \emph{either either} way, i.e.\ unless the jet is constant, we choose two bits of which one decides in which direction it will point, and then we pick a jet in that direction.
	Note the choice of an unused bit.
	
	Now assume $\jtsetsym\withl$ exists.
	The right adjoint to $\cohfget_0 \cohdisc_1$ is $\cohfget_1 \cohcodisc_0 = \reshlist{\nonpol_\eqtydeg}{\mixpol_0}$, which is necessarily also idempotent.
	By similar reasoning as above, we will have
	\[
		\jtsetsym\withl(\cohfget_1 \cohcodisc_0) = \fpsh{(\cohdisc_1)} \circ \rpsh{(\cohdisc_0)},
	\]
	which is right adjoint to $\fpsh{(\cohdisc_0)} \circ \lpsh{(\cohdisc_1)}$ and therefore also non-idempotent.
%	and therefore, the right adjoint to $\jtsetsym\withr(\cohfget_0 \cohdisc_1)$ will be $\jtsetsym\withl(\cohfget_1 \cohcodisc_0)$.
%	Since the former is not idempotent, neither is the latter.
\end{proof}

\subsection{Conclusion} \label{sec:poresh-jtset:conclusion}
In conclusion, if we intend to model Naturality Pretype Theory in jet-topic sets, then we will confine ourselves to using $\poreshcat\withlr$ as our mode theory.
This means that our internal modalities will be indexed by polarized reshuffles which have a left and a right adjoint, i.e.\ satisfy \cref{eq:poresh-withl-crit1,eq:poresh-withl-crit2,eq:poresh-withr-crit1,eq:poresh-withr-crit2}.
It is almost certainly possible to drop \cref{eq:poresh-withr-crit1} so as to include modalities for irrelevance and shape-irrelevance \cite{reldtt}, but we leave this to potential future work.

Thus, the \emph{locks} in our MTT instance will then correspond to polarized reshuffles in $\poreshcat\withrr$, i.e.\ those satisfying \cref{eq:poresh-withr-crit1,eq:poresh-withr-crit2,eq:poresh-withrr-crit1,eq:poresh-withrr-crit2}; where the future work hinted-at above might allow dropping \cref{eq:poresh-withrr-crit1}.

\wip{
\subsection{Sinistrification} \label{sec:poresh-jtset:sin}
%\todoi{Maybe skip dextrification, since it seems to work differently for the two criteria for having a left adjoint. We use sinistrification to give them an additional right adjoint so that we can interpret them on jet topes and internalize them.}
%\todoi{Argue that we want to preserve at least commutation of modalities that actually can be internalized, i.e. those that have a single left adjoint. Their locks internalize functors that have a single right adjoint.}
For this reason, not unlike our usage of jet setoids in \cref{sec:poresh-jetset}, we will take a detour via alternative categories that are equivalent to the categories of jet-topic sets but where our semantics do not act on adjoint triples as in \cref{thm:poresh-jtset:triple}, but rather on adjoint pairs (\cref{sec:poresh-jtset:pair-sin}).
That is:
\begin{itemize}
	\item $\jtsetsym\withrr$ and $\jtsetsym\withlr$ will get a common generalization $\jtsetsym\withr$ with domain $\poreshcat\withr$,
	\item $\jtsetsym\withlr$ and $\jtsetsym\withll$ will get a common generalization $\jtsetsym\withl$ with domain $\poreshcat\withl$.
\end{itemize}
In fact, we could aim for a single semantics generalizing all three, but:
\begin{itemize}
	\item we will see that it does not work for jet-cubical sets \todo{Refer to no-go theorem},
	\item it is unnecessary: the general modal system MTT \cite{mtt-journal} that we wish to instantiate, itself has a syntax $\locknovar \mu$ for left adjoint functors, which can be applied to contexts, and another syntax $\Modifynovar \mu \loch$ for (weak) dependent right adjoints (DRAs, \cite{dra}), which can be applied to types.
	These will be modelled by pairs of a left adjoint and an (in our case proper) DRA.
	Equations between functors that are neither left nor right adjoint, but may arise as a composite of left and right adjoints, are not of interest to MTT, so we take no interest in dealing with these in the model.
\end{itemize}
%a single strict 2-functorial semantics of our mode theory can be achieved (\cref{sec:poresh-jtset:strict}).

The trick we will use to achieve the above is the following: we will insert additional symmetric degrees into our anpolarity masks, which will serve as degrees for formal equijets, as well as for the `true' relation.
Then any polarized reshuffle can be re-encoded as one that does not mention $\mixpol_i$ for directed degrees $i$, nor $\nonpol_\top$, i.e.\ as one that has a right adjoint as per \cref{thm:poresh-adjoint}, by mentioning the inserted formal degrees instead.
We call this \textbf{sinistrification}.%
%The result is that any polarized reshuffle can be re-encoded as one that has both a left and a right adjoint. We call this \textbf{ambidextrification}.
%To get a handle on equality, we will resort to setoid-valued presheaves.
\footnote{Shulman \cite{matt} introduces a construction called \emph{co-dextrification} (Lat.\ \emph{dexter}: `right') which adds left adjoints to existing morphisms in a certain 2-category in such a way that the result satisfies a co-free property. He should perhaps have called it \emph{co-free dextrification}, so that the free construction could be called \emph{free dextrification} and the word \emph{dextrification} per se would be available when no universal property is proven. We mean the word sinistrification (Lat.\ \emph{sinister}: `left') in this latter sense: we do not prove any universal property. As such, we cannot speak of \emph{the} sinistrification but are instead presenting \emph{some} particular sinistrification that we choose to work with.}

We will then take the full subcategory of jet-topic sets for the `sinistrified' mask, on those presheaves where formal and actual equijets actually coincide (\cref{sec:poresh-jtset:pair-sin}), and whose formal `true' relation is actually true.
This category will be equivalent to the original category of jet-topic sets for the original mask (\cref{sec:poresh-jtset:pair}).

%Ambidextrification is done in two steps: sinistrification (making all reshuffles left adjoint) and dextrification (making them right adjoint).

\bigskip

\noindent By \cref{thm:poresh-adjoint}, left adjoints cannot mention $\nonpol_\top$ or $\mixpol_i$ for symmetric degrees $i$.
So in order to make all polarized reshuffles left adjoint, we will insert formal degrees $\nwedgesym_{\lenpol{\vec a}}$ for the true relation, and $\nwpathsym_i$ for the $i$-equijet relation.
This operation makes use of \cref{def:pb} and its \emph{big degree} notation.
\begin{definition} \label{def:poresh-sin:obj}
	Given a mask $\vec a$, we define its \textbf{sinistrification}\footnote{Of course, a mask is just an object and cannot become a left adjoint. We use the word sinistrification already because $\Sin$ will be extended to a strict 2-functor.} $\Sin(\vec a) := \maskop{[\vec a, \npolar]}{\maskpj}{\maske}$ (\cref{def:pb}), and a polarized reshuffle
	\[
		\cohfget^\Sin : \Sin(\vec a) \to \vec a
	\]
	given by
	\[
		\left\{ \begin{array}{r l l l}
			\eqtydeg \cdot \cohfget^\Sin &:=& \nonpol_\eqtydeg \\
			i \cdot \cohfget^\Sin &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			i \cdot \cohfget^\Sin &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}.
		\end{array} \right.
	\]
\end{definition}
When we let $\cohfget^\Sin$ act on a jet set, its effect is to forget the inserted formal relations.
\begin{proposition} \label{thm:poresh-sin:cohesion}
	The polarized reshuffle $\cohfget^\Sin$ is part of an adjoint triple
	$\cohdisc^\Sin \dashv \cohfget^\Sin \dashv \cohcodisc^\Sin$ where $\cohdisc^\Sin, \cohcodisc^\Sin : \vec a \to \Sin(\vec a)$ are defined by%
	\footnote{We do not realy care about $\cohdisc^\Sin$ beyond its existence.}
	\[
		\left\{ \begin{array}{r l l l}
			\eqtydeg \cdot \cohdisc^\Sin &:=& \nonpol_\eqtydeg \\
			\edgedeg i \cdot \cohdisc^\Sin &:=& \nonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			\pathdeg i \cdot \cohdisc^\Sin &:=& \isopol_{\predeg(i)} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\jetdeg i \cdot \cohdisc^\Sin &:=& \pospol_{i} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\edgedeg{\lenpol{\vec a}} \cdot \cohdisc^\Sin &:=& \isopol_{\predeg(\top)}.
		\end{array} \right.
	\]
	\[
		\left\{ \begin{array}{r l l l}
			\eqtydeg \cdot \cohcodisc^\Sin &:=& \nonpol_\eqtydeg \\
			\edgedeg i \cdot \cohcodisc^\Sin &:=& \nonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			\pathdeg i \cdot \cohcodisc^\Sin &:=& \mixpol_{i} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\jetdeg i \cdot \cohcodisc^\Sin &:=& \pospol_{i} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\edgedeg{\lenpol{\vec a}} \cdot \cohcodisc^\Sin &:=& \nonpol_\top.
		\end{array} \right.
	\]
	We have $\cohfget^\Sin \cohdisc^\Sin = \cohfget^\Sin \cohcodisc^\Sin = \id_{\vec a}$, and we have idempotent (co)monads $\flat^\Sin = \cohdisc^\Sin \cohfget^\Sin$ and $\sharp^\Sin = \cohcodisc^\Sin \cohfget^\Sin$. The latter is given by:
	\[
		\left\{ \begin{array}{r l l l}
			\eqtydeg \cdot \sharp^\Sin &:=& \nonpol_\eqtydeg \\
			\edgedeg i \cdot \sharp^\Sin &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			\pathdeg i \cdot \sharp^\Sin &:=& \nwmixpol_{i} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\jetdeg i \cdot \sharp^\Sin &:=& \nwpospol_{i} &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\edgedeg{\lenpol{\vec a}} \cdot \sharp^\Sin &:=& \nonpol_\top.
		\end{array} \right.
	\]
\end{proposition}
\begin{proof}
	By \cref{thm:poresh-adjoint}. Alternatively, one can simply verify the unit and co-unit inequalities for these adjunctions.
\end{proof}
The action of $\cohcodisc^\Sin$ on an $\vec a$-jet set is to insert formal relations for $i$-equijets and for the true relation, and actually define them as the original $i$-equijet and true relations.
The action of $\sharp^\Sin$ is to \emph{re}define the formal relations this way.
The action of $\cohdisc^\Sin$ is rather less useful: it instead inserts formal relations for $\predeg(i)$-infrajets and $\predeg(\top)$-infrajets.

When we look at the action on polarized degrees, the order of the adjoints is reversed:
\[
	\loch \circ \cohcodisc^\Sin \dashv \loch \circ \cohfget^\Sin \dashv \loch \circ \cohdisc^\Sin.
\]
\begin{proposition} \label{thm:poresh-sin:div-poldeg}
	The operation $\loch \circ \cohcodisc^\Sin : \poldegeqtop(\Sin(\vec a), b) \to \poldegeqtop(\vec a, b)$ has a left adjoint $\loch \divleft \cohcodisc^\Sin : \poldegeqtop(\vec a, b) \to \poldegeqtop(\Sin(\vec a), b)$ given by:
	\[
		\left\{ \begin{array}{r l l l}
			\nonpol_\eqtydeg \divleft \cohcodisc^\Sin &:=& \nonpol_\eqtydeg, \\
			\nonpol_i \divleft \cohcodisc^\Sin &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			\mixpol_i \divleft \cohcodisc^\Sin &:=& \nwpathpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\pospol_i \divleft \cohcodisc^\Sin &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\negpol_i \divleft \cohcodisc^\Sin &:=& \nwnegpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\isopol_i \divleft \cohcodisc^\Sin &:=& \nwisopol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nonpol_\top \divleft \cohcodisc^\Sin &:=& \nwnonpol_{\lenpol{\vec a}}. \\
		\end{array} \right.
	\]
	The composite $(\loch \divleft \cohcodisc^\Sin) \circ \cohcodisc^\Sin$ is the identity at $\poldegeqtop(\vec a, b)$.
	The other composite $(\loch \circ \cohcodisc^\Sin) \divleft \cohcodisc^\Sin =: \loch \divleft \sharp^\Sin$ is an idempotent comonad left adjoint to $\loch \circ \sharp^\Sin$ and is given by
	\[
		\left\{ \begin{array}{r l l l}
			\nonpol_\eqtydeg \divleft \sharp^\Sin &:=& \nonpol_\eqtydeg, \\
			\nwnonpol_i \divleft \sharp^\Sin &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
			\nwpathpol_i \divleft \sharp^\Sin &:=& \nwpathpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nwmixpol_i \divleft \sharp^\Sin &:=& \nwpathpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nwpospol_i \divleft \sharp^\Sin &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nwnegpol_i \divleft \sharp^\Sin &:=& \nwnegpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nwisopol_i \divleft \sharp^\Sin &:=& \nwisopol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
			\nwnonpol_{\lenpol{\vec a}} \divleft \sharp^\Sin &:=& \nwnonpol_{\lenpol{\vec a}}. \\
			\nonpol_\top \divleft \sharp^\Sin &:=& \nwnonpol_{\lenpol{\vec a}}. \\
		\end{array} \right.
	\]
\end{proposition}
\begin{proof}
	Define the operation $\loch \divleft \cohcodisc^\Sin$ as above.
	The composition with $\loch \circ \cohcodisc^\Sin$ on either side can be computed, and indeed we find the identity and $\loch \divleft \sharp^\Sin$ as defined above.
	The unit inequality is then trivial whereas the co-unit inequality $\loch \divleft \sharp^\Sin \leq \id$ is easy to check.
	This establishes that $\loch \divleft \cohcodisc^\Sin \dashv \loch \circ \cohcodisc^\Sin$.
	
	The fact that $(\loch \circ \cohcodisc^\Sin) \divleft \cohcodisc^\Sin$ is left adjoint to $\loch \circ \sharp^\Sin$ follows from the fact that adjunctions compose: the right adjoint of the former is $(\loch \circ \cohcodisc^\Sin) \circ \cohfget^\Sin = \loch \circ \sharp^\Sin$.
\end{proof}
The action of $\loch \divleft \cohcodisc^\Sin$ is to rewrite polarized degrees whose mention is illegal in a left adjoint modality, to their formal counterparts.
The action of $\loch \divleft \sharp^\Sin$ is the same, but on input that was already allowed to mention the formal counterparts.
\begin{proposition} \label{thm:poresh-sin:div-poresh}
	The operation $\loch \circ \cohcodisc^\Sin : \Hom_\poreshcat(\Sin(\vec a), \vec b) \to \Hom_\poreshcat(\vec a, \vec b)$ has a left adjoint $\loch \divleft \cohcodisc^\Sin : \Hom_\poreshcat(\vec a, \vec b) \to \Hom_\poreshcat(\Sin(\vec a), \vec b)$ given by $i \cdot (\mu \divleft \cohcodisc^\Sin) := (i \cdot \mu) \divleft \cohcodisc^\Sin$.
	
	The idempotent comonad $\loch \divleft \sharp^\Sin$ similarly generalizes to polarized reshuffles.
\end{proposition}
\begin{proof}
	Follows from \cref{thm:poresh-sin:div-poldeg}, since all operations involved act degree-wise.
\end{proof}
\begin{lemma} \label{thm:poresh-sin:div-poresh:fuse}
	Let $\nu : \vec b \to \vec c$ be a left adjoint, and $\mu : \vec a \to \vec b$. Then $\nu \circ (\mu \divleft \cohcodisc^\Sin) = (\nu \circ \mu) \divleft \cohcodisc^\Sin$.
\end{lemma}
\begin{proof}
	Take $k \in \Deg(\vec c)$, and let $k \cdot \nu = q_j$. Since $\nu$ is a left adjoint, we know that $j < \top$ and that, if $b_j = \ypolar$, then $q \in \accol{\isopol, \pospol, \negpol}$.
	For these polarities, we can check that $q \circ (p_i \divleft \cohcodisc^\Sin) = (q \circ p_i) \divleft \cohcodisc^\Sin$.
	Thus, we find:
	\begin{align*}
		k \cdot (\nu \circ (\mu \divleft \cohcodisc^\Sin))
		&= q_j \circ (\mu \divleft \cohcodisc^\Sin)
		& (\text{\cref{def:poreshcat}}) \\
		&= q \circ ((j \cdot \mu) \divleft \cohcodisc^\Sin)
		& (\text{$j < \top$; \cref{thm:poresh-sin:div-poresh}}) \\
		&= ((q \circ (j \cdot \mu)) \divleft \cohcodisc^\Sin)
		& (\text{argued above}) \\
		&= ((q_j \circ \mu) \divleft \cohcodisc^\Sin) \\
		&= ((k \cdot (\nu \circ \mu)) \divleft \cohcodisc^\Sin)
		& (\text{\cref{def:poreshcat}}) \\
		&= k \cdot ((\nu \circ \mu) \divleft \cohcodisc^\Sin)
		& (\text{\cref{thm:poresh-sin:div-poresh}})&. &\qedhere
	\end{align*}
\end{proof}
\begin{definition} \label{def:sin}
	We define a strict 2-functor $\Sin : \poreshcat \to \poreshcat\withr$ called \textbf{sinistrification}, which sends:
	\begin{itemize}
		\item an object $\vec a$ to $\Sin(\vec a) := \maskop{[\vec a, \npolar]}{\maskpj}{\maske}$ (\cref{def:poresh-sin:obj}),
		\item a morphism $\mu : \vec a \to \vec b$ to $\Sin(\mu) := (\cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin$,
		\item this respects 2-cells because both $\cohcodisc^\Sin \circ \loch$ and $\loch \divleft \cohcodisc^\Sin$ are monotonically increasing.
	\end{itemize}
\end{definition}
Thus, the action of $\loch \circ \Sin(\mu)$ on polarized degrees is to first rewrite formal polarized degrees to their original counterparts ($\loch \circ \cohcodisc^\Sin$), then look up those degrees in $\mu$, and finally rewrite illegal degrees to their formal counterparts ($\loch \divleft \cohcodisc^\Sin$).
\begin{proposition}
	$\Sin$ respects the functor laws.
\end{proposition}
\begin{proof}
	This is most easily seen by the explanation given above.
	Alternatively:
	
	Preservation of the identity can simply be computed.
%	To see that identity is respected, we have
%	\begin{align*}
%		\eqtydeg \cdot (\cohcodisc^\Sin \divleft \cohcodisc^\Sin)
%		&= (\eqtydeg \cdot \cohcodisc^\Sin) \divleft \cohcodisc^\Sin \\
%		&= \nonpol_\eqtydeg \divleft \cohcodisc^\Sin = \nonpol_\eqtydeg, \\
%		\edgedeg i \cdot (\cohcodisc^\Sin \divleft \cohcodisc^\Sin)
%		&= (\edgedeg i \cdot \cohcodisc^\Sin) \divleft \cohcodisc^\Sin \\
%		&= \nonpol_i \divleft \cohcodisc^\Sin = \nwnonpol_i, \\
%		\pathdeg i \cdot (\cohcodisc^\Sin \divleft \cohcodisc^\Sin)
%		&= (\pathdeg i \cdot \cohcodisc^\Sin) \divleft \cohcodisc^\Sin \\
%		&= \mixpol_i \divleft \cohcodisc^\Sin = \nwpathpol_i \\
%		\jetdeg i \cdot (\cohcodisc^\Sin \divleft \cohcodisc^\Sin)
%		&= (\jetdeg i \cdot \cohcodisc^\Sin) \divleft \cohcodisc^\Sin \\
%		&= \pospol_i \divleft \cohcodisc^\Sin = \nwpospol_i, \\
%		\edgedeg{\lenpol{\vec a}} \cdot (\cohcodisc^\Sin \divleft \cohcodisc^\Sin)
%		&= (\edgedeg{\lenpol{\vec a}} \cdot \cohcodisc^\Sin) \divleft \cohcodisc^\Sin \\
%		&= \nonpol_\top \divleft \cohcodisc^\Sin = \nwnonpol_{\lenpol{\vec a}}.
%	\end{align*}

	We argue preservation of composition as follows:
	\begin{align*}
		\Sin(\nu) \circ \Sin(\mu)
		&= \Sin(\nu) \circ ((\cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin) \\
		&= ((\Sin(\nu) \circ \cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin)
		& \text{(\cref{thm:poresh-sin:div-poresh:fuse})} \\
		&= ((((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) \circ \cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin) \\
		&= ((\cohcodisc^\Sin \circ \nu \circ \mu) \divleft \cohcodisc^\Sin)
		& ((\loch \divleft \cohcodisc^\Sin) \circ \cohcodisc^\Sin = \id) \\
		&= \Sin(\nu \circ \mu). &&& \qedhere
	\end{align*}
%	
%	To see that composition of $\mu : \vec a \to \vec b$ with $\nu : \vec b \to \vec c$ is respected, first note that for any $\mu : \vec a \to \vec b$, we have
%	\begin{align*}
%		\edgedeg{\lenpol{\vec b}} \cdot ((\cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin)
%		&= (\edgedeg{\lenpol{\vec b}} \cdot (\cohcodisc^\Sin \circ \mu)) \divleft \cohcodisc^\Sin \\
%		&= (\nonpol_\top \circ \mu) \divleft \cohcodisc^\Sin
%		= \nonpol_\top \divleft \cohcodisc^\Sin = \edgedeg{\lenpol{\vec a}},
%	\end{align*}
%	i.e.\ all sinistrified modalities respect the `formal true relation' $\edgesym_{\lenpol{\vec x}}$.
%	
%	Next, we consider any other degree $\bigdeg{k}{\mymaskz} \in \Degeq(\Sin(\vec c))$, and we can assume $k < \lenpol{\vec c}$:
%	\begin{align*}
%		&{} \mathrel{\phantom{=}}
%		\getdeg\paren{ \bigdeg{k}{\mymaskz} \cdot ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) } \\
%		&= \getdeg\paren{ ((\bigdeg{k}{\mymaskz} \cdot (\cohcodisc^\Sin \circ \nu)) \divleft \cohcodisc^\Sin) \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) } \\
%		&= \getdeg\paren{ ((r_k \circ \nu) \divleft \cohcodisc^\Sin) \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) }
%		& \text{for some $r$} \\
%	\end{align*}
%	
%	\todoi{Old stuff}
%	To see that composition is respected, we have, for any big degree $I$:
%	\begin{align*}
%		&{} \mathrel{\phantom{=}}
%		I \cdot ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) \\
%		&= ((I \cdot (\cohcodisc^\Sin \circ \nu)) \divleft \cohcodisc^\Sin) \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin).
%	\end{align*}
%	Now let $I \cdot (\cohcodisc^\Sin \circ \nu) =: p_i$ and $p_i \divleft \cohcodisc^\Sin = p'_{I'}$.
%	Then we can proceed:
%	\begin{align*}
%		\ldots &= p'_{I'} \circ ((\cohcodisc^\Sin \circ \nu) \divleft \cohcodisc^\Sin) \\
%		&= p' \circ ((I' \cdot (\cohcodisc^\Sin \circ \nu)) \divleft \cohcodisc^\Sin).
%	\end{align*}
%	We can check in the definition of $\cohcodisc^\Sin$ that $I' \cdot \cohcodisc^\Sin$ is of the form $q_i$ where $i$ was already defined above, i.e.\ $\cohcodisc^\Sin$ undoes any degree modification introduced by $\loch \divleft \cohcodisc^\Sin$. Then we proceed:
%	\begin{align*}
%		\ldots &= p' \circ ((q_i \circ \nu) \divleft \cohcodisc^\Sin)
%	\end{align*}
%%	\begin{align*}
%%		\edgedeg i \cdot ((\cohcodisc^\Sin \circ \nu \circ \mu) \divleft \cohcodisc^\Sin)
%%		&= (\edgedeg i \cdot (\cohcodisc^\Sin \circ \nu \circ \mu)) \divleft \cohcodisc^\Sin \\
%%		&= (\nwnonpol_i \circ \nu \circ \mu) \divleft \cohcodisc^\Sin
%%	\end{align*}
\end{proof}
\begin{theorem}
	$\cohcodisc^\Sin : \Id \to \Sin$ is a natural transformation.
\end{theorem}
\begin{proof}
	We have
	\begin{align*}
		\Sin(\mu) \circ \cohcodisc^\Sin
		&= ((\cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin) \circ \cohcodisc^\Sin \\
		&= \cohcodisc^\Sin \circ \mu
		& ((\loch \divleft \cohcodisc^\Sin) \circ \cohcodisc^\Sin = \id)&. && \qedhere
%		\\
%		\cohfget^\Sin \circ \Sin(\mu)
%		&= \cohfget^\Sin \circ ((\cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin) \\
%		&= (\cohfget^\Sin \circ \cohcodisc^\Sin \circ \mu) \divleft \cohcodisc^\Sin
%		& \text{(\cref{thm:poresh-sin:div-poresh:fuse})} \\
%		&= \mu \divleft \cohcodisc^\Sin.
	\end{align*}
\end{proof}
\begin{corollary}
	For any $\mu : \vec a \to \vec b$, we have $\cohfget^\Sin \circ \Sin(\mu) \circ \cohcodisc^\Sin = \mu$. \qed
\end{corollary}
\begin{proposition}
	$\cohfget^\Sin : \Id \to \Sin$ and $\sharp^\Sin : \Sin \to \Sin$ are not natural transformations.
\end{proposition}
\begin{proof}
	If $\cohfget^\Sin$ were natural, then so would $\sharp^\Sin = \cohcodisc^\Sin \cohfget^\Sin$ be.
	Thus, it suffices to disprove the latter.
	
	Consider the modality $\mu = \reshlist{\nonpol_\eqtydeg}{\mixpol_0} : [\ypolar] \to [\ypolar]$.
	Then $\Sin(\mu) = \reshlist{\nonpol_\eqtydeg}{\nwpathpol_0, \nwpathpol_0; \nwnonpol_1}$.
	Meanwhile, $\sharp^\Sin : \Sin([\ypolar]) \to \Sin([\ypolar])$ is given by $\sharp^\Sin = \reshlist{\nonpol_\eqtydeg}{\nwmixpol_0, \nwpospol_0; \nonpol_\top}$.
	Composing these, we get
	\[
		\sharp^\Sin \circ \Sin(\mu) = \reshlist{\nonpol_\eqtydeg}{\nwpathpol_0, \nwpathpol_0; \nonpol_\top},
	\]
	but
	\[
		\Sin(\mu) \circ \sharp^\Sin = \reshlist{\nonpol_\eqtydeg}{\nwmixpol_0, \nwmixpol_0; \nonpol_\top}. \qedhere
	\]
\end{proof}

%\subsubsection{Dextrification}
%By \cref{thm:poresh-adjoint}, right adjoints cannot mention $\isopol_i$ for symmetric degrees $i$, and must preserve $\eqtydeg$.
%So in order to make all polarized reshuffles left adjoint, we will insert formal degrees $\nwedgesym_0$ for equality (causing an offset of 1 on all other degrees), and $\nwbridgesym_{i+1}$ for the $i$-infrajet relation.
%
%\subsubsection{Old stuff}
%
%\begin{definition} \label{def:poresh-sin}
%	We define a functor $\Sin : \poreshcat \to \poreshcat\withr$ called \textbf{sinistrification}, which sends:
%	\begin{itemize}
%		\item an object $\vec a$ to $\Sin(\vec a) := \maskop{[\vec a, \npolar]}{\maskpj}{\maske}$,
%		\item a morphism $\mu : \vec a \to \vec b$ to $\Sin(\mu)$ which we define
%%		by
%%		\[
%%			\begin{array}{c | c c c | l}
%%				j \cdot \mu & \edgedeg j \cdot \mu & \pathdeg j \cdot \mu & \jetdeg j \cdot \mu & \\ \hline
%%				\nonpol_\eqtydeg & \nonpol_\eqtydeg & \nonpol_\eqtydeg & \nonpol_\eqtydeg \\
%%				\nonpol_i & \nwnonpol_i & \nwnonpol_i & \nwnonpol_i & \text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$} \\
%%				\isopol_i & \nwisopol_i & \nwisopol_i & \nwisopol_i & \text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$} \\
%%				\pospol_i &  & \nwpospol_i & \nwbridgepol_i & \text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$} \\
%%				\negpol_i &  & \nwnegpol_i & \nwbridgepol_i & \text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$} \\
%%				\mixpol_i & \nwbridgepol_i & \nwbridgepol_i & \nwbridgepol_i & \text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$} \\
%%			\end{array}
%%		\]
%		using an auxiliary function $\Sin' : \poldegeqtop(\vec a) \to \poldegeq(\Sin(\vec a))$ defined by
%		\[
%			\left\{ \begin{array}{l l l l}
%				\Sin'(\nonpol_\eqtydeg) &:=& \nonpol_\eqtydeg, \\
%				\Sin'(\nonpol_i) &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
%				\Sin'(\mixpol_i) &:=& \nwpathpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Sin'(\pospol_i) &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Sin'(\negpol_i) &:=& \nwnegpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Sin'(\isopol_i) &:=& \nwisopol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Sin'(\nonpol_\top) &:=& \nwnonpol_{\lenpol{\vec a}}. \\
%			\end{array} \right.
%		\]
%		We then define:
%		\begin{itemize}
%			\item $\eqtydeg \cdot \Sin(\mu) := \Sin'(\eqtydeg \cdot \mu)$,
%			\item $\edgedeg j \cdot \Sin(\mu) := \Sin'(j \cdot \mu)$,
%			\item $\pathdeg j \cdot \Sin(\mu) := \Sin'(\mixpol_j \circ \mu)$,
%			\item $\jetdeg j \cdot \Sin(\mu) := \Sin'(j \cdot \mu)$,
%			\item $\edgedeg{\lenpol{\vec b}} \cdot \Sin(\mu) := \edgedeg{\lenpol{\vec a}}$.
%		\end{itemize}
%		\item This respects inequality, since $\Sin'$ is monotonically increasing.
%	\end{itemize}
%\end{definition}
%\begin{corollary} \label{thm:poresh-sin-char}
%	We have, for all $\mu : \vec a \to \vec b$ and $q_j \in \poldegeqtop(\vec b)$, that
%	\begin{align*}
%		\Sin'(q_j) \circ \Sin(\mu) &= \Sin'(q_j \circ \mu).
%	\end{align*}
%\end{corollary}
%\begin{proof}
%	By considering all possibilities for $q_j$.
%\end{proof}
%\begin{definition} \label{def:poresh-dex}
%	We define a functor $\Dex : \poreshcat \to \poreshcat\withl$ called \textbf{dextrification}, which sends:
%	\begin{itemize}
%		\item an object $\vec a$ to $\Dex(\vec a) := \maskop{\vec a}{\maskjb}{\maske}$,
%		\item a morphism $\mu : \vec a \to \vec b$ to $\Dex(\mu)$ which we define using an auxiliary function $\Dex' : \poldegeqtop(\vec a) \to \poldegeqtop(\Dex(\vec a))$ defined by
%		\[
%			\left\{ \begin{array}{l l l l}
%				\Dex'(\nonpol_\eqtydeg) &:=& \nonpol_\eqtydeg, \\
%				\Dex'(\nonpol_i) &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
%				\Dex'(\mixpol_i) &:=& \nwmixpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\pospol_i) &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\negpol_i) &:=& \nwnegpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\isopol_i) &:=& \nwbridgepol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\nonpol_\top) &:=& \nonpol_\top. \\
%			\end{array} \right.
%		\]
%		We then define:
%		\begin{itemize}
%			\item $\eqtydeg \cdot \Dex(\mu) := \Dex'(\eqtydeg \cdot \mu)$,
%			\item $\edgedeg j \cdot \Dex(\mu) := \Dex'(j \cdot \mu)$,
%			\item $\jetdeg j \cdot \Dex(\mu) := \Dex'(j \cdot \mu)$,
%			\item $\bridgedeg j \cdot \Dex(\mu) := \Dex'(\isopol_j \circ \mu)$.
%		\end{itemize}
%		\item This respects inequality, since $\Dex'$ is monotonically increasing.
%	\end{itemize}
%\end{definition}
%\begin{corollary} \label{thm:poresh-dex-char}
%	We have, for all $\mu : \vec a \to \vec b$ and $q_j \in \poldegeqtop(\vec b)$, that
%	\begin{align*}
%		\Dex'(q_j) \circ \Dex(\mu) &= \Dex'(q_j \circ \mu).
%	\end{align*}
%\end{corollary}
%\begin{proof}
%	By considering all possibilities for $q_j$.
%\end{proof}
%\begin{definition} \label{def:poresh-amb}
%	We define a functor $\Amb : \poreshcat \to \poreshcat\withlr$ called \textbf{ambidextrification}, which sends:
%	\begin{itemize}
%		\item an object $\vec a$ to $\Amb(\vec a) := \maskop{[\vec a, \npolar]}{\maskpjb}{\maske}$,
%		\item a morphism $\mu : \vec a \to \vec b$ to $\Amb(\mu)$ which we define using an auxiliary function $\Amb' : \poldegeqtop(\vec a) \to \poldegeq(\Dex(\vec a))$ defined by
%		\[
%			\left\{ \begin{array}{l l l l}
%				\Dex'(\nonpol_\eqtydeg) &:=& \nonpol_\eqtydeg, \\
%				\Dex'(\nonpol_i) &:=& \nwnonpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \npolar$}, \\
%				\Dex'(\mixpol_i) &:=& \nwpathpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\pospol_i) &:=& \nwpospol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\negpol_i) &:=& \nwnegpol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\isopol_i) &:=& \nwbridgepol_i &\text{for $i \in \Deg(\vec a)$ with $a_i = \ypolar$}, \\
%				\Dex'(\nonpol_\top) &:=& \nwnonpol_{\lenpol{\vec a}}. \\
%			\end{array} \right.
%		\]
%		We then define:
%		\begin{itemize}
%			\item $\eqtydeg \cdot \Dex(\mu) := \Dex'(\eqtydeg \cdot \mu)$,
%			\item $\edgedeg j \cdot \Dex(\mu) := \Dex'(j \cdot \mu)$,
%			\item $\pathdeg j \cdot \Sin(\mu) := \Sin'(\mixpol_j \circ \mu)$,
%			\item $\jetdeg j \cdot \Dex(\mu) := \Dex'(j \cdot \mu)$,
%			\item $\bridgedeg j \cdot \Dex(\mu) := \Dex'(\isopol_j \circ \mu)$,
%			\item $\edgedeg{\lenpol{\vec b}} \cdot \Sin(\mu) := \edgedeg{\lenpol{\vec a}}$.
%		\end{itemize}
%		\item This respects inequality, since $\Dex'$ is monotonically increasing.
%	\end{itemize}
%\end{definition}
%\begin{theorem}
%	We have $\Amb = \Sin \circ \Dex = \Dex \circ \Sin$ and $\Amb' = \Sin' \circ \Dex' = \Dex' \circ \Sin'$. \qed
%\end{theorem}
%\begin{corollary}
%	We have, for all $\mu : \vec a \to \vec b$ and $q_j \in \poldegeqtop(\vec b)$, that
%	\begin{align*}
%		\Amb'(q_j) \circ \Amb(\mu) &= \Amb'(q_j \circ \mu). &\qed
%	\end{align*}
%\end{corollary}

\subsection{Adjoint Pair Semantics on Sinistrified Modal Jet-Topic Setoids} \label{sec:poresh-jtset:pair-sin}
Composing sinistrification (\cref{sec:poresh-jtset:sin}) with \ref{thm:poresh-jtset:triple}, we get
\begin{align*}
	&\poreshcat\withr \xrightarrow{\Sin} \poreshcat\withrr \xrightarrow{\jtsetsym\withrr} \Cat\withrr, \\
	&\poreshcat\withl \xrightarrow{\Sin} \poreshcat\withlr \xrightarrow{\jtsetsym\withlr} \Cat\withlr.
\end{align*}
An adjunction $\mu \dashv \rho$ with $\mu : \vec a \to \vec b$ will be sent to an adjunction $\jtsetsym\withrr(\Sin(\mu)) = \Sin(\mu)_! \dashv \jtsetsym\withlr(\Sin(\rho)) = \Sin(\mu)^*$, with $\Sin(\mu)_! : \jtset{\Sin(\vec a)} \to \jtset{\Sin(\vec b)}$.\footnote{Here, we use the abbreviation $\nu$ for $\jettope{\nu}$.}

Now, for all $\vec a$, we would like to take full subcategories of $\jtset{\Sin(\vec a)}$ on those presheaves whose formal equijet and `true' relations coincide with the actual ones.
These would be exactly fixpoints of the semantics of $\sharp^\Sin$, as $\sharp^\Sin$ redefines the formal relations as the actual ones.
However, since $\sharp^\Sin$ is not in general part of an adjoint triple, \cref{thm:poresh-jtset:triple} does not directly provide a semantics on jet-topic sets.
Fortunately, we can reassemble it from its parts, but then we have to reprove some of its properties:
\begin{proposition}
	The functor
	\[
		\sharpsinjtset := \jtsetsym\withll(\cohcodisc^\Sin) \circ \jtsetsym\withlr(\cohfget^\Sin) : \jtset{\Sin(\vec a)} \to \jtset{\Sin(\vec a)}
	\]
	is an idempotent monad.
\end{proposition}
\begin{proof}
	By \cref{thm:poresh-jtset:triple}, we have $\jtsetsym\withlr(\cohfget^\Sin) = \fpsh{(\cohdisc^\Sin)} \dashv \jtsetsym\withll(\cohcodisc^\Sin) = \rpsh{(\cohdisc^\Sin)}$.
	So as a composite of two adjoints, $\sharpsinjtset$ is certainly a monad.
	It remains to be proven that the co-unit of the corresponding comonad $\fpsh{(\cohdisc^\Sin)} \circ \rpsh{(\cohdisc^\Sin)}$ is invertible,
	or equivalently that the unit of its left adjoint monad $\fpsh{(\cohdisc^\Sin)} \circ \lpsh{(\cohdisc^\Sin)}$ is invertible,
	which by a well-known fact about adjoint functors \cite[v141, prop.\ 3.4]{nlab:adjoint-functor} is equivalent to $\lpsh{(\cohdisc^\Sin)}$ being fully faithful.
	This is in turn equivalent to $\cohdisc^\Sin : \jettope{\vec a} \to \jettope{\Sin(\vec a)}$ being fully faithful (see e.g.\ \cite[v4, thm.\ 2.3.4]{transpension-techreport}).
	Since $\jettope{\vec x}$ is a full subcategory of $\jetset{\vec x}$,
	it is sufficient for $\cohdisc^\Sin : \jetset{\vec a} \to \jetset{\Sin(\vec a)}$ to be fully faithful.
	This is equivalent to invertibility of the unit of the monad $\cohfget^\Sin \cohdisc^\Sin : \jetset{\vec a} \to \jetset{\vec a}$, which follows from pseudofunctoriality of $\jetsetsym : \poreshcat \to \Cat$ and the fact that the polarized reshuffle $\cohfget^\Sin \cohdisc^\Sin : \vec a \to \vec a$ is the identity (we do not need to consider equality of 2-cells in the 2-poset $\poreshcat$).
\end{proof}

\subsection{Adjoint Pair Semantics on Jet-Topic Sets} \label{sec:poresh-jtset:pair}
} %endwip

\section{Semantics on Jet Cubes and Jet-Cubical Sets} \label{sec:poresh-jetcube-jcset}
In this section, we investigate how polarized reshuffles act on jet topes and on presheaves over these, which we call jet-topic sets.

\subsection{Semantics on Jet Cubes and Jet Cuboids} \label{sec:poresh-jetcube}
In this section, we want to construct a 2-functor that sends polarized reshuffles $\mu : \vec a \to \vec b$ to functors $\jetcube{\orifb}{\affine}{M}{\vec a} \to \jetcube{\orifb}{\affine}{M}{\vec b}$, with $M \in \accol{\bipointedsym, \booleanalg}$, thus giving our mode theory of polarized reshuffles a semantics on $\orifb$-jet-cubes.
Recall that these are equivalent to $\orif$-jet-cubes (\cref{thm:backward-jets-equivalent}).

Since jet cubes are jet topes (\cref{thm:jet-cubes-are-topes}), the reasoning at the start of \cref{sec:poresh-jettope} applies here as well, so that we will only consider modalities $\mu$ that have a right adjoint $\mu \dashv \rho$.
Since jet cubes are realized as jet sets by repeated application of twisted prism functors to the terminal jet set (\cref{def:jep}), we can deduce the action of $\mu$ on jet cubes from its action on twisted prisms, which is given by \cref{thm:poresh-jetsetoid-prism-commut}.
We see that the outcome may be either: again a twisted prism, or a separated/cartesian product with $\rival{\edgesym_\eqtydeg}$ (i.e.\ the terminal jet set), $\rival{\equijet_j}$ or $\rival{\edgesym_\top}$ (i.e.\ a discrete jet set with two elements).
We have to rule out $\rival{\equijet_j}$ and $\rival{\edgesym_\top}$, since these cannot be realized by jet cubes, but we can support $\rival{\edgesym_\eqtydeg}$ since $\loch \times \rival{\edgesym_\eqtydeg} \cong \Id$.
If we look at what this entails for $\rho$, we see that $\rho$ cannot mention $\mixpol_j$ for directed $j$, nor $\nonpol_\top$, i.e.\ (by \cref{thm:poresh-adjoint}) $\rho$ has to have a right adjoint.

Analogous to what we did in \cref{sec:poresh-jetset}, we will first work on a variant of jet cubes, called jet cuboids%
\footnote{The -oid is in the sense of setoid here.}
$V$, which can have variables typed with the `equality interval' $\rival{\edgesym_\eqtydeg}$, and whose jet endpoint model $\JEP(V)$ is not a jet set but a jet setoid.
This allows us to work in a strictly 2-functorial setting longer.

\subsubsection{Cuboids and Jet Cuboids}
\label{sec:cuboid}
\label{sec:jetcuboid}
\begin{definition}
	\label{def:cuboid}
	\label{def:cuboid-ep}
	Given a monad $M$ and $\mycubex \in \accol{\cartes, \affine}$, we define the \textbf{setoid-enriched category of cuboids $\cuboidcat^\mycubex_M$}, with strict 2-functors $\setoidfget : \setoidfget_1\cuboidcat^\mycubex_M \to \cubecat^\mycubex_M$ and $\setoidquot : \setoidquot_1\cuboidcat^\mycubex_M \to \cubecat^\mycubex_M$ as the category:
	\begin{itemize}
		\item whose objects are lists of elements of $\accol{\IX, \rival{\edgesym_\eqtydeg}}$, denoted in the style $(\dm i_0 : \IX, \ldots, \dm i_{n-1} : \rival{\edgesym_\eqtydeg})$ where the $\dm i_k$ are interpreted as de Bruijn indices, and where
		\begin{align*}
			\setoidfget() &= (), &
			\setoidfget (W, \dm i : \IX) &= (\setoidfget W, \dm i : \IX), &
			\setoidfget (W, \dm i : \rival{\edgesym_\eqtydeg}) &= (\setoidfget W, \dm i : \IX),
			\\
			\setoidquot () &= (), &
			\setoidquot (W, \dm i : \IX) &= (\setoidquot W, \dm i : \IX), &
			\setoidquot (W, \dm i : \rival{\edgesym_\eqtydeg}) &= \setoidquot W.
		\end{align*}
		\item whose morphisms $\vfi : V \to W$ are morphisms $\setoidfget \vfi : \setoidfget V \to \setoidfget W$ such that if $\dm j$ has type $\rival{\edgesym_\eqtydeg}$ in $W$, then $\dm j \psub \vfi$ only mentions variables $\dm i$ in $V$ that also have type $\rival{\edgesym_\eqtydeg}$.
		The morphism $\setoidquot \vfi$ is defined the obvious way.
		\item where morphisms $\vfi, \chi : V \to W$ are considered equivalent if $\setoidquot \vfi = \setoidquot \chi$.
	\end{itemize}
	A setoid-enriched functor $\EP : \cuboidcat^\mycubex_M \to \Setoid$ is defined by:
	\begin{align*}
		\EP() &= (), &
		\EP(W, \dm i : \IX) &= \EP(W) \times \accol{0, 1}, &
		\EP(W, \dm i : \rival{\edgesym_\eqtydeg}) &= \EP(W) \times \accol{0 \edge_\eqtydeg 1}.
	\end{align*}
	We have a natural transformation $\EP \circ \setoidquot \cong \setoidquot \circ \EP$ of functors $\setoidquot_1 \cuboidcat^\mycubex_M \to \Set$.
\end{definition}
\begin{definition}
	\label{def:jet-cuboid}
	Let $\vec a$ be a mask and $\myorix$ an orientation kit.
	We define the set of \textbf{$(\myorix, \vec{a})$-jet-cuboids} as the set of lists of elements of $\set{P_i}{P \in \myorix, i \in \Degeq(\vec a)}$,
	where we identify all $P_i = Q_i =: {\edge}_i$ ($P, Q \in \myorix$) if $a_i = \npolar$.
	We denote jet cuboids as
	$(\dm i_0 : \rival{(P_0)_{i_0}}, \ldots, \dm i_{n-1} : \rival{(P_{n-1})_{i_{n-1}}})$,
	thinking of the names $\dm{i}_k$ as De Bruijn indices.
	
	For any $(\myorix, \vec a)$-jet-cuboid $W$, we define $\setoidquot W$ as the $(\myorix, \vec a)$-jet-\emph{cube} obtained by removing all variables of type $\rival{\edgesym_\eqtydeg}$.
\end{definition}
\begin{definition} \label{def:jet-cuboid-jep}
	For any $(\myorix, \vec a)$-jet-cuboid $W$, we define the $\vec a$-jet-setoid $\JEP(W)$ as in \cref{def:jep} with the additional equation
	\[
		\JEP(W, \dm i : \rival{\edgesym_\eqtydeg}) = \JEP(W) \times \rival{\edgesym_\eqtydeg} = \JEP(W) * \rival{\edgesym_\eqtydeg}.
	\]
	Clearly, we have $\JEP(\setoidquot W) \cong \setoidquot(\JEP(W))$.
\end{definition}
\begin{definition} \label{def:jet-cuboid-erasure}
	For any $(\myorix, \vec a)$-jet-cuboid $W$, we define the jet cuboid $\erasejc{W}$ as in \cref{def:jet-cube-erasure} with the additional equation
	\[
		\erasejc{(W, \dm i : \rival{\edgesym_\eqtydeg})} = (\erasejc W, \dm i : \rival{\edgesym_\eqtydeg}).
	\]
	Clearly, we have $\erasejc{\setoidquot W} = \setoidquot{\erasejc W}$.
\end{definition}
\begin{corollary} \label{thm:jet-cuboid-pullback}
	For any $(\myorix, \vec a)$-jet-cuboid $W$, we have $U(\JEP(W)) = \EP(\erasejc W)$.
	In other words, \cref{thm:jet-cube-pullback} remains valid if we replace cubes with cuboids and jet cubes with jet cuboids.
	
	Moreover, the isomorphisms in \cref{def:cuboid-ep} and \cref{def:jet-cuboid-jep} are compatible along $U : \jetset{\vec a} \to \Set$ and $\erasejc \loch$. \qed
\end{corollary}
\begin{definition} \label{def:jet-cuboid-cat}
	Let $\vec a$ be a mask, $\myorix \in \orikit$, $\mycubex \in \accol{\affine, \cartes}$ and $M$ a monad on $\Set$.
	We define
	the setoid-enriched category $\jetcuboid{\myorix}{\mycubex}{M}{\vec a}$ of \textbf{$(\myorix, \vec a)$-jet-$M$-cuboids}
	as the full subcategory of $\cuboidcat^\mycubex_M \times_\Set \jetset{\vec a}$ on $(\myorix, \vec a)$-jet-cuboids, as justified by \cref{thm:jet-cuboid-pullback}.
	The functions $\JEP$ and $\erasejc{\loch}$ are correspondingly extended to setoid-enriched functors.
\end{definition}
\begin{corollary}
	In the following cube-shaped diagram, the side squares commute strictly while the top and bottom squares commute up to compatible natural isomorphisms:
	\[
		\xymatrix{
			\jetcuboid{\myorix}{\mycubex}{M}{\vec a}
				\ar[rr]^(.3)\JEP
				\ar[dd]_(.3){\erasejc{\loch}}
				\ar[rd]_{\setoidquot}
			&&
			\jetsetoid{\vec a}
				\ar[dd]_(.3){U}
				\ar[rd]_{\setoidquot}
			\\
			&
			\jetcube{\myorix}{\mycubex}{M}{\vec a}
				\ar[rr]^(.3)\JEP
				\ar[dd]_(.3){\erasejc{\loch}}
			&&
			\jetset{\vec a}
				\ar[dd]_(.3){U}
			\\
			\cuboidcat^\mycubex_M
				\ar[rr]^(.3)\EP
				\ar[rd]_{\setoidquot}
			&&
			\Setoid
				\ar[rd]_{\setoidquot}
			\\
			&
			\cubecat^\mycubex_M
				\ar[rr]^(.3)\EP
			&&
			\Set.
		}
	\]
	By the adjunction $\setoidquot_1 \dashv \setoiddisc_1$ (\cref{def:setoid-cohesion}), we can regard each of the arrows labelled $\setoidquot$ in the diagram above as either starting from $\setoidquot_1$ of the domain (making it an ordinary functor) or arriving at $\setoiddisc_1$ of the codomain (making it a setoid-enriched functor).
	The arrows in the upper left square parallel to the page are all setoid-enriched functors, while the arrows in the lower right square are all ordinary functors. \qed
\end{corollary}
\begin{definition} \label{def:cuboid-cohesion}
	We define a setoid-enriched functor $\setoiddisc : \setoiddisc_1 \cubecat^\mycubex_M \to \cuboidcat^\mycubex_M$ which sends a cube $W = (\dm i_0 : \IX, \ldots, \dm i_{n-1} : \IX)$ to the cuboid $\setoiddisc W = (\dm i_0 : \IX, \ldots, \dm i_{n-1} : \IX)$ of the same notation, and has an obvious action on morphisms.
\end{definition}
\begin{corollary} \label{thm:cuboid-cohesion}
	$\setoiddisc : \cubecat^\mycubex_M \to \setoidfget_1 \cuboidcat^\mycubex_M$ is right adjoint to $\setoidquot : \setoidfget_1 \cuboidcat^\mycubex_M \to \cubecat^\mycubex_M$. \qed
\end{corollary}
\begin{corollary} \label{thm:cuboid-equiv-cube}
	$\setoiddisc : \setoiddisc_1 \cubecat^\mycubex_M \to \cuboidcat^\mycubex_M$ and $\setoidquot : \cuboidcat^\mycubex_M \to \setoiddisc_1 \cubecat^\mycubex_M$ form an equivalence of setoid-enriched categories, where $\setoiddisc \setoidquot$ is naturally \emph{equivalent} but not naturally isomorphic to the identity. \qed
\end{corollary}
\begin{definition} \label{def:jetcuboid-cohesion}
	We define a setoid-enriched functor $\setoiddisc : \setoiddisc_1 \jetcube{\myorix}{\mycubex}{M}{\vec a} \to \jetcuboid{\myorix}{\mycubex}{M}{\vec a}$ which sends a jet cube $W = (\dm i_0 : \rival{(P_0)_{i_0}}, \ldots, \dm i_{n-1} : \rival{(P_{n-1})_{i_{n-1}}})$ to the jet cuboid $\setoiddisc W = (\dm i_0 : \rival{(P_0)_{i_0}}, \ldots, \dm i_{n-1} : \rival{(P_{n-1})_{i_{n-1}}})$ of the same notation, and has an obvious action on morphisms.
\end{definition}
\begin{corollary} \label{thm:jetcuboid-cohesion}
	$\setoiddisc : \jetcube{\myorix}{\mycubex}{M}{\vec a} \to \setoidfget_1 \jetcuboid{\myorix}{\mycubex}{M}{\vec a}$ is right adjoint to \\
	$\setoidquot : \setoidfget_1 \jetcuboid{\myorix}{\mycubex}{M}{\vec a} \to \jetcube{\myorix}{\mycubex}{M}{\vec a}$. \qed
\end{corollary}
\begin{corollary} \label{thm:jetcuboid-equiv-jetcube}
	$\setoiddisc : \setoiddisc_1 \jetcube{\myorix}{\mycubex}{M}{\vec a} \to \jetcuboid{\myorix}{\mycubex}{M}{\vec a}$ and $\setoidquot : \jetcuboid{\myorix}{\mycubex}{M}{\vec a} \to \setoiddisc_1 \jetcube{\myorix}{\mycubex}{M}{\vec a}$ form an equivalence of setoid-enriched categories, where $\setoiddisc \setoidquot$ is naturally \emph{equivalent} but not naturally isomorphic to the identity. \qed
\end{corollary}
\begin{corollary}
	There is a strictly commutative diagram
	\[
		\xymatrix{
			\jetcuboid{\myorix}{\mycubex}{M}{\vec a}
				\ar[rr]^(.3)\JEP
				\ar[dd]_(.3){\erasejc{\loch}}
				\ar@{<-}[rd]_{\setoiddisc}
			&&
			\jetsetoid{\vec a}
				\ar[dd]_(.3){U}
				\ar@{<-}[rd]_{\setoiddisc}
			\\
			&
			\jetcube{\myorix}{\mycubex}{M}{\vec a}
				\ar[rr]^(.3)\JEP
				\ar[dd]_(.3){\erasejc{\loch}}
			&&
			\jetset{\vec a}
				\ar[dd]_(.3){U}
			\\
			\cuboidcat^\mycubex_M
				\ar[rr]^(.3)\EP
				\ar@{<-}[rd]_{\setoiddisc}
			&&
			\Setoid
				\ar@{<-}[rd]_{\setoiddisc}
			\\
			&
			\cubecat^\mycubex_M
				\ar[rr]^(.3)\EP
			&&
			\Set.
		}
	\]
	where the arrows in the upper left square parallel to the page are setoid-enriched functors, the arrows in the lower right square are ordinary functors, and the arrows labelled $\setoiddisc$ can be regarded as setoid-enriched functors from $\setoiddisc_1$ of the domain or, equivalently by \cref{def:setoid-cohesion}, as ordinary functors to $\setoidfget_1$ of the codomain. \qed
\end{corollary}

\subsubsection{Semantics on Jet Cubes and Jet Cuboids}
\label{sec:poresh-jetcuboid}
\label{sec:poresh-jetcube:sub}
\begin{definition}
	\begin{enumerate}
		\item We define a strict 2-functor $\jetcuboid{\orifb}{\affine}{M}{\loch} : \poreshcat\withrr \to \Setoid\Cat$ which sends:
		\begin{itemize}
			\item an object $\vec a$ to $\jetcuboid{\orifb}{\affine}{M}{\vec a}$,
			\item a morphism $\mu : \vec a \to \vec b$ with right adjoint $\mu \dashv \rho$ to a functor $\jetcuboid{\orifb}{\affine}{M}{\mu}$ (also just denoted $\mu$) which:
			\begin{itemize}
				\item sends $()$ to $\mu () := ()$,
				\item has an action on other cuboids that can be looked up in the following table:%
				\footnote{Note that if $b_j = \npolar$, then the results for $\nonpol_j$ are consistent.}%
				\footnote{Note that if $i \cdot \rho \in \accol{\mixpol_j, \isopol_j}$, then by \cref{eq:poresh-withl-crit2,eq:poresh-withr-crit2}, $b_j = \npolar$.}
				\[
					\begin{array}{c || c | c | c}
						i \cdot \rho 
						& \nonpol_\eqtydeg 
						& \pospol_j
						& \negpol_j 
						\\ \hline
						\mu(W, \dm i : \rival{\jetsym_i})
						& (\mu W, \dm i : \rival{\edgesym_\eqtydeg})
						& (\mu W, \dm i : \rival{\jetsym_j})
						& (\Op_j \mu W, \dm i : \rival{\tejsym_j})
						\\
						\mu(W, \dm i : \rival{\tejsym_i})
						& (\mu W, \dm i : \rival{\edgesym_\eqtydeg})
						& (\mu W, \dm i : \rival{\tejsym_j})
						& (\Op_j\mu X, \dm i : \rival{\jetsym_j})
					\end{array}
				\]
				\item thus satisfies $\JEP(\mu W) = \mu \JEP(W)$ by \cref{thm:poresh-jetsetoid-prism-commut},
				\item has an action on jet cuboid morphisms defined as follows. Recall that a jet cuboid morphism $\vfi : V \to W$ is a cuboid morphism $\erasejc \vfi : \erasejc V \to \erasejc W$ whose endpoint model $\EP(\erasejc \vfi) = U(\JEP(\vfi))$ is in fact a morphism of jet sets $\JEP(\vfi) : \JEP(V) \to \JEP(W)$ (\cref{def:jet-cuboid-cat}).
				\begin{itemize}
					\item We define $\dm j \psub{\erasejc{\mu(\vfi)}} := \dm j \psub{\erasejc{\vfi}}$.
					\item It is the case that
					\[
						\EP(\erasejc{\mu(\vfi)}) : \EP(\erasejc{\mu V}) = U(\JEP(\mu V)) \to U(\JEP(\mu W)) = \EP(\erasejc{\mu W})
					\]
					is in fact a morphism of jet setoids; indeed it is the morphism $\mu(\JEP(\vfi))$, as can be trivially proven by induction on $W$ of $\vfi$.
				\end{itemize}
				\item If $\mu \leq \nu$, then we have to give a morphism $\ket{\mu \leq \nu} : \mu W \to \nu W$, naturally w.r.t. $W$.
				We define $\erasejc{\ket{\mu \leq \nu}}$ ny $\dm i \psub{\erasejc{\ket{\mu \leq \nu}}} = \dm i$, which is a valid morphism of cuboids exactly because we know that $\mu \leq \nu$.
				This is clearly natural on cubes, therefore on sets, and therefore on jet setoids.
				Its endpoint model ($\EP$) is a jet setoid morphism, again because $\mu \leq \nu$.
			\end{itemize}
		\end{itemize}
		
		\item By \cref{thm:setoid-equiv-set,thm:jetsetoid-equiv-jetset,thm:jetcuboid-equiv-jetcube,thm:cuboid-equiv-cube}, we obtain a pseudofunctor $\jetcube{\orifb}{\affine}{M}{\loch} : \poreshcat\withrr \to \Cat$:
		\begin{itemize}
			\item Sending an object $\vec a$ to $\jetcube{\orifb}{\affine}{M}{\vec a}$,
			\item Sending a morphism $\mu : \vec a \to \vec b$ to $\jetcube{\orifb}{\affine}{M}{\mu} = \setoidquot \circ \jetcuboid{\orifb}{\affine}{M}{\mu} \circ \setoiddisc : \jetcube{\orifb}{\affine}{M}{\vec a} \to \jetcube{\orifb}{\affine}{M}{\vec b}$,
			\item \ldots
		\end{itemize}
		
		\item Additionally, if we consider only modalities $\mu$ satisfying \cref{eq:poresh-withl-crit1} (i.e.\ those for which $\eqtydeg \cdot \mu = \nonpol_\eqtydeg$) and denote the restricted 2-poset as $\poreshcat \noquotwithrr$, then we directly get a strict 2-functor $\jetcube{\orifb}{\affine}{M}{\loch}\noquot : \poreshcat \noquotwithrr \to \Cat$, equivalent to the pseudofunctor above:
		\begin{itemize}
			\item Sending an object $\vec a$ to $\jetcube{\orifb}{\affine}{M}{\vec a}$,
			\item Sending a morphism $\mu : \vec a \to \vec b$ to $\jetcube{\orifb}{\affine}{M}{\mu}\noquot$ which acts on cubes the same way $\jetcuboid{\orifb}{\affine}{M}{\mu}$ acts on cuboids.
			\item \ldots
		\end{itemize}
		
		\item By \cref{thm:backward-jets-equivalent}, if $M \in \accol{\bipointedsym, \booleanalg}$, we obtain pseudofunctors
		\begin{align*}
			\jetcube{\orif}{\affine}{M}{\loch} &: \poreshcat\withrr \to \Cat, \\
			\jetcuboid{\orif}{\affine}{M}{\loch} &: \poreshcat\withrr \to \Setoid\Cat.
		\end{align*}
	\end{enumerate}
\end{definition}

\subsection{Adjoint Triple Semantics on Jet-Cubical Sets} \label{sec:poresh-jcset:triple}
\begin{definition}
	The category of \textbf{$(\omega, \vec a)$-jet-cubical sets} is the presheaf category $\jcset{\omega}{\mycubex}{M}{\vec a} := \Psh(\jetcube{\omega}{\mycubex}{M}{\vec a})$.
\end{definition}
\begin{theorem} \label{thm:poresh-jcset:triple}
	Let $\omega \in \accol{\orif, \orifb}$ and, if $\omega = \orif$ then $M \in \accol{\bipointedsym, \booleanalg}$.
	We have the following pseudofunctors:
	\begin{itemize}
		\item $\jcset{\omega}{\affine}{M}{\loch}\withrr : \poreshcat\withrr \to \Cat\withrr$,
		\item $\jcset{\omega}{\affine}{M}{\loch}\withlr : \poreshcat\withlr \to \Cat\withlr$,
		\item $\jcset{\omega}{\affine}{M}{\loch}\withll : \poreshcat\withll \to \Cat\withll$,
	\end{itemize}
	to the 2-category of categories, functors with a specified number of left/right adjoints (\cref{not:poresh-with}), and natural transformations, where:
	\begin{itemize}
		\item each functor sends an object $\vec a$ to $\Psh(\jetcube{\omega}{\affine}{M}{\vec a})$,
		\item a triple of polarized reshuffles $\mu \dashv \rho \dashv \tau$ is sent by the respective functors to
		\[
			\jcset{\omega}{\affine}{M}{\mu}\withrr = \lpsh \mu
			\quad\dashv\quad
			\jcset{\omega}{\affine}{M}{\rho}\withlr = \fpsh \mu
			\quad\dashv\quad
			\jcset{\omega}{\affine}{M}{\tau}\withll = \rpsh \mu,
		\]
		of which $\fpsh \mu$ is a strict CwF morphism \cite{dybjer-cwf} and $\rpsh \mu$ is a weak CwF morphism \cite[def.\ 2.1.1]{reldtt-techreport}\cite[def.\ 3.2.5]{nuyts-phd} w.r.t.\ the standard CwF structure on a presheaf category \cite[ch.\ 4]{Hofmann97}\cite[\S 4.1]{nuyts-phd}.
		\item 2-cells are also respected.
	\end{itemize}
\end{theorem}
\begin{proof}
	By the exact same reasoning as in the proof of \cref{thm:poresh-jtset:triple}.
\end{proof}

\subsection{No Adjoint Pair Semantics on Jet-Cubical Sets} \label{sec:poresh-jcset:nogo}
As in \cref{sec:poresh-jtset:nogo}, we have a no-go theorem:
\begin{theorem} \label{thm:poresh-jcset:nogo}
	Let $\omega \in \accol{\orif, \orifb}$ and $M \in \accol{\bipointedsym, \booleanalg}$.
	The following, equivalent\footnote{Assuming an adjoint can be picked if one exists.}, objects \textbf{do not exist}:
	\begin{itemize}
		\item A pseudofunctor $\jcset{\omega}{\affine}{M}{\loch}\withr : \poreshcat\withr \to \Cat\withr$ that extends both $\jcset{\omega}{\affine}{M}{\loch}\withrr$ and $\jcset{\omega}{\affine}{M}{\loch}\withlr$ up to natural isomorphism,
		\item A pseudofunctor $\jcset{\omega}{\affine}{M}{\loch}\withl : \poreshcat\withl \to \Cat\withl$ that extends both $\jcset{\omega}{\affine}{M}{\loch}\withlr$ and $\jcset{\omega}{\affine}{M}{\loch}\withll$ up to natural isomorphism.
	\end{itemize}
\end{theorem}
\begin{proof}
	The reasoning in the proof of \cref{thm:poresh-jtset:nogo}, still stands for jet-cubical sets. Note:
	\begin{itemize}
		\item That the interval jet set $\rival{\jetsym_0}$ needs to be replaced with the 1-dimensional jet cube $(\dm i : \rival{\jetsym_0})$.
		\item That all jet set morphisms of $\JEP$s of jet cubes, whose domain is 1-dimensional, are in fact jet cube morphisms. \qedhere
	\end{itemize}
\end{proof}

\subsection{Conclusion} \label{sec:poresh-jcset:conclusion}
We draw the same conclusion as in \cref{sec:poresh-jtset:conclusion}.

\chapter{Paths and Bridges} \label{ch:pb}
\todoi{Rename big degrees to floors}

In \cref{ch:modes}, we decided to consider all anpolarity masks as possible modes.
However, it is unclear why we would be interested in types equipped with an arbitrary sequence of directed and undirected degrees.

In this chapter, we start from the na\"ive viewpoint that, in practice, we will only be interested in anpolarity masks of the form $[\ypolar]^n$, i.e. modes where all degrees are directed.
We will then argue that this situation in itself is undesirable and even unworkable, and fix the matter by inserting symmetric degrees into a given mask.

\todoi{Update this intro when chapter is finished}



\todoi{$\reshlist{\nonpol_\eqtydeg}{\mixpol_0} : [\ypolar] \to [\ypolar]$ is not part of a chain of 3 and therefore unincludable. This is a strong argument for bridges and paths.}

\section{Rods, Paths and Bridges} \label{sec:pb}
\todoi{Reabolish rods}
In this section, we define a number of operations on anpolarity masks (\cref{def:anpolarity}) which serve to insert symmetric \emph{bridge} and/or \emph{path} relations for every degree.
The idea, in the universe of small types, is the following:
\begin{itemize}
	\item Rods express strict equality,
	\item Paths express isomorphism (in the presence of rods or bridges) or equivalence (in absence of rods),
	\item Jets express homomorphism,
	\item Bridges express relations.
\end{itemize}
Bridges and rods will not occur together, because bridges can be regarded as pro-rods (with `pro-' in the sense of pro-arrow equipments): a bridge between types expresses a relation, which is a notion of heterogeneous strict equality.

The mask operations serve three goals:
\begin{itemize}
	\item They are helpful to understand equijets\todo{refer},
	%\item They are helpful to prove pseudofunctoriality of the semantics of the mode theory\todo{refer},
	\item They generate the modes that we will likely want to use in practice.
\end{itemize}

%\subsection{Path/Bridge Transformations}
\begin{definition} \label{def:pb}
	Let $\mymaskx \in \accol{\maskj, \maskpj, \maskjb, \maskpjb, \maskrpj}$ and $\mymasky \in \accol{\maske, \maskpb, \maskrp}$, and let $a$ be an anpolarity.
	We define $\maskop a \mymaskx \mymasky \in \List\,\Anpolarity$ as follows:
	\[
		\begin{array}{l c c c l c c}
			\maskop \ypolar \maskj \mymasky &=& [\ypolar]
			&\qquad&
			\maskop \npolar \mymaskx \maske &=& [\npolar]
			\\
			\maskop \ypolar \maskpj \mymasky &=& [\npolar, \ypolar]
			&\qquad&
			\maskop \npolar \mymaskx \maskpb &=& [\npolar, \npolar]
			\\
			\maskop \ypolar \maskjb \mymasky &=& [\ypolar, \npolar]
			&\qquad&
			\maskop \npolar \mymaskx \maskrp &=& [\npolar, \npolar]
			\\
			\maskop \ypolar \maskpjb \mymasky &=& [\npolar, \ypolar, \npolar]
			\\
			\maskop \ypolar \maskrpj \mymasky &=& [\npolar, \npolar, \ypolar]
		\end{array}
	\]
	We extend this operation to anpolarity masks as follows: $\maskop{\vec a}{\mymaskx}{\mymasky}$ is the concatenation (join / monadic multiplication) of the list of lists obtained by applying $\maskop{\loch}{\mymaskx}{\mymasky}$ to every element of $\vec a$.
	
	Indexing the resulting mask is complicated, because the length of the resulting mask depends not only on the length of $\vec a$ but also on its contents.
	In order to stay sane, we will use an indexing system that still refers to the degrees of $\vec a$, which we will call \textbf{big degrees}, whereas the degrees of $\maskop{\vec a}{\mymaskx}{\mymasky}$ will be called \textbf{small degrees}.
	Concretely, a small degree subscript will be replaced with a big degree subscript combined with a superscript indicating whether we are talking about the rod/path/jet/bridge or edge relation.
	For example, if $\vec a = [\ypolar, \npolar, \ypolar]$, then the relations of $\maskop{\vec a}{\maskpjb}{\maske}$ will be denoted as:
	\[
		\nwpath_0, \quad
		\nwjet_0, \quad
		\nwbridge_0, \quad
		\nwedge_1, \quad
		\nwpath_2, \quad
		\nwjet_2, \quad
		\nwbridge_2,
	\]
	rather than
	\[
		\edge_0, \quad
		\jet_1, \quad
		\edge_2, \quad
		\edge_3, \quad
		\edge_4, \quad
		\jet_5, \quad
		{\edge_6}.
	\]
	When we need a degree in itself, we will write e.g.\ $\pathdeg{0}$.
	
	A modality $\mu : \maskop{\vec a}{\maskpjb}{\maske} \to \maskop{\vec a}{\maskpjb}{\maske}$ will be denoted
	\[
		\reshlist{\eqtydeg \cdot \mu}{\pathdeg 0 \cdot \mu, \jetdeg 0 \cdot \mu, \bridgedeg 0 \cdot \mu ; \edgedeg 1 \cdot \mu ; \pathdeg 2 \cdot \mu, \jetdeg 2 \cdot \mu, \bridgedeg 2 \cdot \mu},
	\]
	i.e.\ we will use semicolons (;) to group small degree information per big degree.
\end{definition}

\section{Understanding Equijets}
\todoi{This is way easier if you have modalities}

\section{Intended Meaning of Big and Small Degrees}
\todoi{
\begin{itemize}
	\item Big degree 1 is where the magic happens.
	\item Big degree 0 should be discrete for closed types, and encodes the `graph' of big degree 1 stuff. Discreteness at closed types guarantees that the reflexive:
	\begin{itemize}
		\item 1-path is the identity isomorphism
		\item 1-jet is the identity morphism
		\item 1-bridge is the \textbf{strict} equality relation
	\end{itemize}
	at any type.
	\item If you conflate $i$-bridges with $(i+1)$-paths, then
	\begin{itemize}
		\item 0-paths in the universe are discrete
		\item 0-jets in the universe are discrete
		\item 1-paths in the universe are isomorphisms (the reflexive one the identity)
		\item 1-jets in the universe are morphisms (the reflexive one the identity)
		\item 2-paths in the universe are pro-isomorphisms (the reflexive one the 1-path relation, not the equality relation).
	\end{itemize}
	\item Universe gets discrete big degree 0 by moving all other stuff one slot.
	\item Higher degrees get their meaning of pro-something automatically.
	\item Mixed-polar operations:
	\begin{itemize}
		\item Will ask a path in order to produce a jet.
		\item Can still produce a bridge if you give them a bridge.
	\end{itemize}
	This is an argument to have both bridges and paths.
	\item Isopolar functions probably don't occur much: we have naturality instead.
	\item You can leave out bridges. Then there is no strict equality relation (at least not along bridges; we do have strict equality along functions and bijections), but mixed-variant functions can still preserve suc-paths.
	\begin{itemize}
		\item If you leave out bridges, then data types which only have big degree 0, have no heterogeneous equality along bridges, only along morphisms and isos, so you've lost parametricity.
	\end{itemize}
	\item You cannot leave out both bridges and paths, because then there is no mixed-variance.
	\item You can leave out paths but not bridges. Then there is strict equality, but no HoTT.
	\item Its never really HoTT, because an iso in the universe is up to strict equality.
	\item Alternatively, you can let big degree 0 correspond to 1-paths entirely (and probably not have bridges).
\end{itemize}
}

\chapter{Transpension}
\todoi{Does Tw : sSet $\to$ sSet have a transp type? (Yes if it's Tw$_!$)}

\appendix
\chapter{Version history}
\begin{description}
	\item[v0.1] Wrote \cref{ch:modes}.
	\item[v0.1.1] Changed title. \\
		Proofread \cref{ch:modes}. \\
		Added missing clause for \ruleref{concursor} in proof of \cref{thm:calculus-sound}. \\
		Cleaned up affine boolean normalization lemmas in \cref{sec:jetcubes:calculus:lemmas}. \\
		Introduced orientation kits (\cref{def:orientation-kit}). \\
		Introduced conventional cubes (\cref{def:conv-jet-cube-cat}). \\
		General cleanup.
	\item[v0.2] Wrote \cref{ch:modalities}. \\
		Changed title. \\
		Renamed jet jewels to jet topes; modified their definition (\cref{def:jet-tope}).
	\item[v0.3] \ldots
\end{description}

\bibliographystyle{alphaurl}
\bibliography{../refs/refs.bib}

\end{document}