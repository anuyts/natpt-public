\documentclass[a4paper]{article}

\usepackage{a4wide}

\usepackage{amsthm}
\pdfoutput=1

\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{mathrsfs}
\RequirePackage{mathtools}
%\RequirePackage{mathabx}
\RequirePackage{latexsym}
%\RequirePackage{epstopdf}
%\RequirePackage{array}
\RequirePackage{stmaryrd}
\RequirePackage[normalem]{ulem}
%\RequirePackage{xfrac}

%\usepackage{bm}
\usepackage[all,cmtip]{xy}
%\usepackage{mathtools}
%\usepackage{longtable}

%\usepackage{mdframed}
%\let\framedCopy=\framed
%\let\framed=\undefined

\usepackage[hidelinks,bookmarksnumbered]{hyperref}
\RequirePackage{cleveref}

\usepackage{wasysym}
\usepackage{stmaryrd}
%\usepackage[notext]{stix}
\usepackage{fontawesome}
\RequirePackage{amssymb}
\RequirePackage{xcolor}
\usepackage{xypic}
	\CompileMatrices
\RequirePackage{mathtools}
\usepackage{stmaryrd}

\usepackage{libertine}

\usepackage[english]{babel}
%\usepackage[dutch]{babel}

\usepackage{../natpt-macros}

%\newcommand{\todoi}[1]{\textbf{\textcolor{red}{#1 \qed}}\par\noindent}
%\newcommand{\todo}[1]{\textbf{\textcolor{red}{\footnote{\textcolor{red}{#1}}}}}
%\newcommand{\todoi}[1]{}
%\newcommand{\todo}[1]{}

\newcommand{\thetitle}{Naturality Pretype Theory - Extended Version}
\newcommand{\theauthors}{Andreas Nuyts}
\begin{document}
	\addtolength{\voffset}{-.5in}

\title{\thetitle}
%\subtitle{Technical report}
\date{\today}
\author{\theauthors{}}
%\address{imec-DistriNet, KU Leuven, Belgium}
\maketitle
%\vspace*{-.5in}
%\begin{abstract}
%\end{abstract}

\tableofcontents

\pagebreak

\section{Base Categories and Modes}

\subsection{Modes are Anpolarity Lists}
In RelDTT, modes were natural numbers (minus one) expressing the number of available relations.
In NatPT, we will specify for each of these relations whether it is directed or not.
\begin{definition} \label{def:anpolarity}
	An \textbf{anpolarity}\footnote{`An' is Latin for `whether', as in `Nescio an polare sit,' meaning `I do not know whether it is polar'.} is an element of the set $\Anpolarity := \accol{\ypolar, \npolar}$, where $\ypolar$ stands for polar/directed and $\npolar$ stands for nonpolar/symmetric.
\end{definition}
\noindent As our set of modes, we take $\List\,\Anpolarity$. If $\vec a \in \List\,\Anpolarity$, we write $\lenpol{\vec a}$ for its length.

\begin{remark}
	We note that it is always possible to restrict our mode theory, by discarding modes but keeping the same modalities and 2-cells between remaining modes.
	We could decide to restrict to any of the following subsets of modes:
	\begin{itemize}
		\item Modes of the form $[\ypolar]^*$, i.e.\ where all degrees are polar,
		\item Modes of the form $([\npolar] | [\npolar, \ypolar])^*$, i.e.\ where we think of a level as containing a path relation and optionally a weaker jet relation,
		\begin{itemize}
			\item Modes of the form $[\npolar, \ypolar]^*$ where the presence of a jet relation at each level is required,
		\end{itemize}
		\item Modes of the form $([\npolar] | [\ypolar, \npolar])^*$, i.e.\ where we think of a level as containing a bridge relation and optionally a stronger jet relation,
		\begin{itemize}
			\item Modes of the form $[\ypolar, \npolar]^*$ where the presence of a jet relation at each level is required,
		\end{itemize}
		\item Modes of the form $([\npolar, \npolar] | [\npolar, \ypolar, \npolar])^*$, i.e.\ where we think of a level as containing a path relation and a weaker bridge relation and optionally, in between, a jet relation,
		\begin{itemize}
			\item Modes of the form $[\npolar, \ypolar, \npolar]^*$ where the presence of a jet relation at each level is required.
		\end{itemize}
	\end{itemize}
	We will occasionally discuss these subtheories. By considering all of $\List\,\Anpolarity$ in the current paper, we maintain generality.
\end{remark}

\subsection{Jet Sets}
\begin{definition} \label{def:jetset}
	Let $\vec a$ be a mode. A \textbf{jet set of mode $\vec a$} is a set $X$ equipped with $\lenpol{\vec a}$ (proof-irrelevant%
	\footnote{So these relations are functions $X \to X \to \Prop$ where $\Prop$ is a universe of $h$-propositions \cite{hottbook}. In most applications, these relations will be decidable, but we do not require this.}%
	) relations $\jet_i$ where
	\begin{itemize}
		\item $0 \leq i < \lenpol{\vec a}$ is called the \textbf{degree} and
		\item $\jet_i$ is called the \textbf{$i$-jet relation}
	\end{itemize}
	such that
	\begin{itemize}
		\item when $a_i = \npolar$, then $\jet_i$ is symmetric, in which case we will denote it as $\edge_i$ and call it the \textbf{$i$-edge relation} (notwithstanding that we still consider it a special case of a jet relation),
		\item $x \jet_i y$ implies both $x \jet_{i+1} y$ and $x \tej_{i+1} y$ whenever $0 \leq i < i+1 < \lenpol{\vec a}$.
	\end{itemize}
	A \textbf{morphism} of jet sets of mode $\vec a$ is a function that preserves all the jet and edge relations.
	
	The category of jet sets of mode $\vec a$ is called $\jetset{\vec a}$.
	
	A jet set is called \textbf{transitive} if each of the $i$-jet relations is transitive (i.e. a pre-order and, if $i = \npolar$, an equivalence relation).
\end{definition}
\begin{proposition}
	Let $X$ be a transitive jet set of mode $\vec a$ and $0 \leq i < j < \lenpol{\vec a}$.
	Then the double category whose objects are elements of $X$, morphisms are (unique) proofs of $x \jet_i y$, pro-arrows are (unique) proofs of $x \jet_{j} y$ and squares are elements of the unit type, is a pro-arrow equipment \cite{nlab:proarrow,proarrow1,proarrow2}\todo{Refer to dedicated section instead.}.
\end{proposition}
\begin{proof}
	It is clearly a double category. The existence of companions and conjoints is trivial.
\end{proof}
\begin{definition}
	We define the
	\begin{itemize}
		\item \textbf{$i$-equijet relation} $\equijet_i$ as the symmetric interior of $\jet_i$, i.e.\ $x \equijet_i y$ if and only if $x \jet_i y$ and $x \tej_i y$;
		\item \textbf{$i$-infrajet relation} $\infrajet_i$ as the symmetric closure of $\jet_i$, i.e.\ $x \equijet_i y$ if and only if $x \jet_i y$ or $x \tej_i y$.
	\end{itemize}
\end{definition}
It is immediately clear that for nonpolar degrees, the jet/edge, equijet and infrajet relations coincide.
In general, we can observe that $x \infrajet_i y$ implies $x \equijet_j y$ for $i < j$.
So for mode $[\ypolar, \ypolar, \npolar]$, we get
\[
\xymatrix{
	& 
	\jet_0
		\ar@{:>}[rd]
	&&& 
	\jet_1 
		\ar@{:>}[rd]
	&&& 
	\jet_2 
		\ar@{<:>}[rd]
	\\
	\equijet_0
		\ar@{:>}[ru]
		\ar@{:>}[rd]
	&&
	\infrajet_0
		\ar@{:>}[r]
	&
	\equijet_1
		\ar@{:>}[ru]
		\ar@{:>}[rd]
	&&
	\infrajet_1
		\ar@{:>}[r]
	&
	\equijet_2
		\ar@{<:>}[ru]
		\ar@{<:>}[rd]
	&
	\edge_2
		\ar@{<:>}[l]
		\ar@{<:>}[u]
		\ar@{<:>}[r]
		\ar@{<:>}[d]
	&
	\infrajet_2.
	\\
	& 
	\tej_0 
		\ar@{:>}[ru]
	&&& 
	\tej_1 
		\ar@{:>}[ru]
	&&& 
	\tej_2 
		\ar@{<:>}[ru]
}
\]

\begin{definition}
	Let $\vec a$ be a mode, $i < \lenpol{\vec a}$ and $X \in \Obj(\jetset{\vec a})$.
	We define the \textbf{$i$-opposite $\Op_i(X)$ of $X$} as the jet set with the same carrier and relations as $X$ except that the $i$-jet relation is reversed: $x \jet_i^{\Op_i(X)} y$ if and only if $x \tej_i^X y$.
	This defines a functor $\Op_i(X) : \jetset{\vec a} \to \jetset{\vec a}$.
\end{definition}
We have $\Op_i \circ \Op_i = \Id$ and if $a_i = \npolar$ then $\Op_i = \Id$.

\subsection{Intervals and Prisms}
\begin{definition} \label{def:interval}
	Let $\vec a$ be a mode and $i < \lenpol{\vec a}$.
	\begin{itemize}
		\item The \textbf{$i$-jet interval} $\rival{\jet_i}$ is defined as the jet set of mode $\vec a$ with carrier $\accol{0, 1}$ and relations generated by $0 \jet_i 1$.
		\item The \textbf{$i$-equijet interval} $\rival{\equijet_i}$ is defined as the jet set of mode $\vec a$ with carrier $\accol{0, 1}$ and relations generated by $0 \equijet_i 1$.
	\end{itemize}
	If $a_i = \npolar$ then $\rival{\jet_i} = \rival{\equijet_i} =: \rival{\edge_i}$ is called the \textbf{$i$-edge interval}.
\end{definition}
Note that it would be meaningless to define an $i$-infrajet interval in the same way.

\begin{definition} \label{def:prism}
	Let $\vec a$ be a mode, $i < \lenpol{\vec a}$ and $X \in \Obj(\jetset{\vec a})$.
	We define the \textbf{$i$-twisted prism $X \multip \rival{\jet_i}$} on $X$ as the jet set of mode $\vec a$ with
	\begin{itemize}
		\item carrier $X \times \accol{0, 1}$,
		\item jet relations generated by the following requirements:
		\begin{itemize}
			\item $(\loch, 0) : \Op_i(X) \to X \multip \rival{\jet_i}$ is a jet set morphism,
			\item $(\loch, 1) : X \to X \multip \rival{\jet_i}$ is a jet set morphism,
			\item $(x, 0) \jet_i (x, 1)$ for all $x \in X$.
		\end{itemize}
	\end{itemize}
	This defines the \textbf{$i$-twisted prism functor} $\loch \multip \rival{\jet_i} : \jetset{\vec a} \to \jetset{\vec a}$.
	If $a_i = \npolar$, then we call this simply the \textbf{$i$-prism functor $\loch \multip \rival{\edge_i}$.}
\end{definition}
\todoi{Should there be a prism functor for $\rival{\equijet_i}$?}

\subsection{Intermezzo: Cube Categories}
We introduce a family of cube categories with one flavour of dimension. Fix a monad $M$ on $\Set$.
\begin{example} \label{ex:cube-monads}
	Typically $M$ will be one of the following:
	\begin{itemize}
		\item The `exception' monad $\bipointed$ that sends a set $X$ to $X \uplus \accol{0,1}$, which is the carrier of the free bipointed set over $X$;
		\item The monad $\bipointedsym$ that sends a set $X$ to $X \uplus \set{\lnot x}{x \in X} \uplus \accol{0, 1}$, which is the carrier of the free [bipointed set equipped with an involution $\lnot$ that swaps $0$ and $1$] over $X$;
		\item The monad $\distlattice$ that sends a set $X$ to the carrier of the free distributive lattice over $X$;
		\item The monad $\demorgan$ that sends a set $X$ to the carrier of the free de Morgan algebra over $X$;
		\item The monad $\booleanalg$ that sends a set $X$ to the carrier of the free boolean algebra over $X$.
	\end{itemize}
\end{example}

\subsubsection{Cartesian Cubes}
\begin{definition}
	We construct the \textbf{(named) category of cartesian $M$-cubes} $\cubecat_M$ (and $\namedcubecat_M$ resp.) stepwise:
	\begin{itemize}
		\item The Kleisli category $\Kleisli(M)$ of $M$ has objects $\inKleisli{X}$ where $X$ is a set, and its morphisms $\inKleisli f : \inKleisli X \to \inKleisli Y$ are functions $f : X \to MY$.
		\item Of this, we take the opposite $\Kleisli(M)\op$. (This is the Lawvere theory corresponding to the monad $M$.)
		\item We define $\namedcubecat_M$ as the full subcategory of $\Kleisli(M)\op$ on finite sets.
		\item We define $\cubecat_M$ as a designate skeleton of $\namedcubecat_M$, e.g.\ the full subcategory of $\namedcubecat_M$ on sets of the form $\accol{0, \ldots, n-1}$ with $n \geq 0$.
	\end{itemize}
\end{definition}
Objects of $\namedcubecat_M$ will be denoted as tuples of names $(i_0 : \IX, \ldots, i_{n-1} : \IX)$ where $\IX$ is meaningless but conveys the intuition that we regard $i_k$ as a value ranging over the interval (the cube given by the singleton object).
A morphism $\vfi : (i_0 : \IX, \ldots, i_{n-1} : \IX) \to (j_0 : \IX, \ldots, j_{m-1} : \IX)$ is then a function sending each $j_k$ to an expression $j_k \psub{\vfi} \in M\accol{i_0, \ldots, i_{n-1}}$.
The morphism $\vfi$ will also be denoted as $(j_0 \psub \vfi / j_0, \ldots, j_{m-1} \psub \vfi / j_{m-1})$.
The situation in $\cubecat_M$ is the same except that we now regard the names $i_k$ as de Bruijn indices.

\subsubsection{Affine Cubes}
If $T$ is a \emph{container} monad \cite{container-combinatorics}, i.e. a monad whose underlying functor is a container functor \cite{containers} of the form $TX = \Sigma(s : S).(P(s) \to X)$, then we define $T^\# X$ as the set of \emph{affine} expressions $\Sigma(s : S).(P(s) \hookrightarrow X)$, which is an endofunctor on the category $\Set^{\hookrightarrow}$ of sets and injective functions.
If $M$ is merely a \emph{quotient} of a container monad, i.e. $M$ is of the form $MX = TX/\sim_X$ with $T$ as above, then we define $M^\# X$ as the set of equivalence classes with an affine representant.

\begin{remark}
An important source of monads such as $M$ are monads specified by a syntactic algebraic theory \cite{manes-book,adamek-book,keml-diagrams}.
A syntactic algebraic theory specifies a set of operations $S_0$, assigns to each operation $s : S_0$ an arity $P_0(s)$ which is again a set, and subjects these to a set of axioms.%
\footnote{We use `syntactic algebraic theory' to refer to the syntactic presentation as described here, and `monad' and `Lawvere theory' to refer to the less syntactic objects they specify.
%There seems to be disagreement on the terminology.
%Syntactic algebraic theories (a.k.a. presentations of algebraic theories \cite{manes-book,keml-diagrams}) give rise to a monad and a Lawvere category (a.k.a. Lawvere theory or algebraic theory \cite{manes-book}).
%Depending on your definition of a Lawvere theory, the monadic presentation and the Lawvere theory may be interderivable; in turn, they give rise to a category of algebras.
%Neither of these two steps reflects equivalence, so we truly have three different notions, and there is disagreement which one the term `algebraic theory' refers to \cite{adamek-book}.
%
%Different syntactic algebraic theories may have the same category of models, in which case they are called \emph{Morita equivalent} \cite[ch.\ 15]{adamek-book}. We can thus distinguish algebraic theories by their syntactic presentation or consider them up to Morita equivalence. We will use \emph{syntactic algebraic theory} in the former case and \emph{monadic/Lawverian algebraic theory} in the latter case. Some authors insist on the usage of the word `presentation' for the former case \cite{manes-book}, or call the latter case `algebraic categories' \cite{adamek-book}, while the term `algebraic theories' seems to be in use for either case.
}
The container $(S_0, P_0)$ specifies a container functor $FX = \Sigma(s : S_0).(P_0(s) \to X)$ on $\Set$.
A free monad $F^*$ over this functor $F$ exists and satisfies the fixpoint equation $F^* X \cong X \uplus F F^* X$.
We remark that the free monad $F^*$ over a container functor $F$ is again a container functor, i.e.\ there exists a container $(S, P)$ such that
$F^* X = \Sigma(s : S).(P(s) \to X)$
specifies the free monad over $F$.
The axioms determine an equivalence relation $\sim_X$ on $F^* X$ such that $M X := F^* X/\sim_X$ is again a monad.
This situation applies to each of the monads in \cref{ex:cube-monads}.

In fact, often the quotient can be taken already at the level of the container, so that there exists a container $(S', P')$ such that $MX \cong \Sigma(s : S').(P'(s) \to X)$.
\end{remark}

We say that $(s, f), (s', f') \in T^\# X$ are \textbf{mutually fresh}, denoted $(s, f) \freshbin (s', f')$, if $f(P(s))$ and $f'(P(s'))$ are disjoint.
Elements of $M^\# X$ are mutually fresh if they have mutually fresh representants.
We call the monad $(T, \eta, \mu)$ \textbf{affine} if $\eta_X : X \to TX$ lands in $T^\# X$ for all $X$ and $\mu_X : TTX \to TX$ restricted to $(TT)^\# X$ (note that container functors are closed under composition) lands in $T^\# X$; and similar for $M$.

\begin{definition}
Let $M$ be a quotient of a container monad, and let it be affine.
We construct the \textbf{(named) category of affine $M$-cubes $\cubecat_M^\affine$} (and $\namedcubecat_M^\affine$ resp.) stepwise:
\begin{itemize}
	\item The affine Kleisli category $\Kleisli^\#(M)$ has objects $\inKleisli{X}$ where $X$ is a set, and its morphisms $\inKleisli f : \inKleisli X \to \inKleisli Y$ are functions $f : X \to M^\#Y$ such that for any $x \neq x'$ in $X$, we have $f(x) \freshbin f(x')$.
	Identity and composition are well-defined because $M$ is affine.
	\item Of this, we take the opposite $\Kleisli^\#(M)\op$.
	\item We define $\namedcubecat_M^\affine$ as the full subcategory of $\Kleisli^\#(M)\op$ on finite sets.
	\item We define $\cubecat_M^\affine$ as a designate skeleton of $\namedcubecat^\affine_M$, e.g.\ the full subcategory of $\namedcubecat^\affine_M$ on sets of the form $\accol{0, \ldots, n-1}$ with $n \geq 0$.
\end{itemize}
\end{definition}
Objects will be represented as for the cartesian cube categories.

\subsubsection{Examples}
This way, we get -- among others -- the following cube categories:
\begin{enumerate}
	\item[$\cubecat_{\bipointed}$] The cartesian cube category.
	A morphism $\vfi : V \to W$ sends every dimension $j \in W$ to $j \psub \vfi \in V \cup \accol{0, 1}$.
	Its cubes have diagonals.
	\item[$\cubecat^\affine_{\bipointed}$] The affine cube category.
	A morphism $\vfi : V \to W$ sends every dimension $j \in W$ to $j \psub \vfi \in V \cup \accol{0, 1}$, such that if $j\psub \vfi = j' \psub \vfi \in V$ then $j = j'$.
	Its cubes have no diagonals.
	\item[$\cubecat_{\bipointedsym}$] The symmetric cartesian cube category. We have a negation/involution/symmetry $(\lnot i / j) : (i : \IX) \to (j : \IX)$.
	\item[$\cubecat_{\distlattice}$] The cartesian cube category with connections. We have morphisms $(i \vee j / k), (i \wedge j / k) : (i : \IX, j : \IX) \to (k : \IX)$. There are no symmetries
	\item[$\cubecat_{\demorgan}$] The CCHM cube category, which combines symmetries and connections \cite{cubical}. We have $(i \wedge \lnot i / j) \neq (0/j) : (i : \IX) \to (j : \IX)$ and $(i \vee \lnot i / j) \neq (1/j) : (i : \IX) \to (j : \IX)$.
	\item[$\cubecat_{\booleanalg}$] A cube category very similar to the CCHM one, but we have $(i \wedge \lnot i / j) = (0/j) : (i : \IX) \to (j : \IX)$ and $(i \vee \lnot i / j) = (1/j) : (i : \IX) \to (j : \IX)$.
\end{enumerate}
We remark that $\cubecat^\affine_{\demorgan}$ and $\cubecat^\affine_{\booleanalg}$ should be isomorphic as the additional law of boolean algebras w.r.t.\ de Morgan algebras only affects non-affine expressions.

\todoi{Map them to corner maps}
\todoi{Given that elements of the free boolean algebra can be uniquely written in full disjunctive normal form, it is clear that the free boolean algebra is the set of truth tables. Then the mapping to corner maps is fully faithful.}

\subsubsection{The Endpoint Model}
We remarked above that $\catL := \Kleisli(M)\op$ is the Lawvere category of $M$.
It is known then (see e.g.\ \cite{keml-diagrams}), that the Eilenberg-Moore category of $M$ (which is the category of Eilenberg-Moore algebras of $M$) is equivalent to the category of product-preserving functors $\catL \to \Set$.
Such functors are fully determined by the image of the singleton set (as every set is a coproduct of singletons and the Kleisli-category retains coproducts) and that image will be exactly the carrier of the corresponding Eilenberg-Moore algebra.

It is clear that both the cartesian and affine (named) cube categories are subcategories of $\catL$.
As such, any $M$-algebra induces a functor $\catL \to \Set$ and hence a functor from any of the $M$-cube categories to $\Set$.

We are interested, in particular, in $M$-algebra structures on the set of endpoints $\accol{0, 1}$.
Each of the monads in \cref{ex:cube-monads} has an obvious such algebra structure.
Thus, we get functors from each of the corresponding cube categories to $\Set$,
sending $(i_0 : \IX, \ldots, i_{n-1} : \IX)$ to $\accol{0, 1}^{\accol{i_0, \ldots, i_{n-1}}}$.
We will denote each of those functors as $\EP$.

Recall that a morphism $\vfi : (i_0 : \IX, \ldots, i_{n-1} : \IX) \to (j_0 : \IX, \ldots, j_{m-1} : \IX)$ assigns to each $j$ a value $j\psub \vfi$ in $M \accol{i_0, \ldots, i_{n-1}}$, the free $M$-algebra over $\accol{i_0, \ldots, i_{n-1}}$.
The function $\EP(\vfi)$ is defined by
\[
	\EP(\vfi)
	\paren{ v^{\accol{i_0, \ldots, i_{n-1}} \to \accol{0, 1}} }
	(j)
	= \alpha\paren{ M(v)(j \psub \vfi) },
\]
where $\alpha : M\accol{0, 1} \to \accol{0, 1}$ is the algebra structure on $\accol{0, 1}$.
Using the operation $\bindop^\alpha : MX \to (X \to \accol{0, 1}) \to \accol{0, 1} : \hat x \mapsto f \mapsto \alpha (Mf(\hat x))$, we can write this as $\EP(\vfi)(v)(j) = j \psub \vfi \bindop^\alpha v$.

\begin{proposition}
	The functor $\EP : \cubecat_\booleanalg \to \Set$ is fully faithful.
\end{proposition}
\begin{proof}
	We need to show that any function $f : \accol{0, 1}^{\accol{i_0, \ldots, i_{n-1}}} \to \accol{0, 1}^{\accol{j_0, \ldots, j_{m-1}}}$
	can be obtained as some $\EP(\vfi)$ with $\vfi : (i_0 : \IX, \ldots, i_{n-1} : \IX) \to (j_0 : \IX, \ldots, j_{m-1} : \IX)$.
	We remark that such a function $f$ in fact consists of $m$ truth tables in $n$ boolean variables.
	From the full disjunctive normal form, it is clear that elements of the free boolean algebra are in 1-1 correspondence with truth tables.
	Concretely, for each $j$, define $j \psub \vfi$ to be the element of $\booleanalg \accol{i_0, \ldots, i_{n-1}}$ corresponding to the truth table $f(\loch, j)$.
	Then $j \psub \vfi \bindop^\alpha v$ will evaluate $j \psub \vfi$ after replacing each variable $i$ with its value $v(i)$, yielding the value $f(v, j)$ prescribed by the truth table $f(\loch, j)$.
\end{proof}

\subsection{Jet Cubes}
\begin{definition} \label{def:jet-cube}
	Let $\vec a$ be a mode.
	We define the set of \textbf{jet cubes of mode $\vec a$} as the set of objects of $\jetset{\vec a}$ generated by:
	\begin{itemize}
		\item the terminal object $\top := \accol{()}$,
		\item the twisted prism operations $\loch \multip \rival{\jet_i} : \Obj(\jetset{\vec a}) \to \Obj(\jetset{\vec a})$.
	\end{itemize}
\end{definition}
It is clear that every jet cube can be generated by the above steps in only a single way, so we can reason about jet cubes inductively.%
\footnote{In a proof assistant, we would define an inductive predicate over objects of $\jetset{\vec a}$ and prove that it is a mere proposition.}

\begin{corollary} \label{thm:jet-cube-op}
	If $W$ is a jet cube, then $\Op_i(W)$ is isomorphic (in $\jetset{\vec a}$) to a jet cube $\Opcube_i(W)$.
	We have $\Opcube_i \circ \Opcube_i = \Id$.
	\todoi{Do we use this? I guess later on to characterize.}
\end{corollary}
In fact, it happens to be the case that $\Opcube_i(W) = W$, but we will avoid to use this fact as the isomorphism $\Op_i(W) \cong \Opcube_i(W) = W$ is not the identity on objects.
\begin{proof}
	We define recursively:
	\begin{itemize}
		\item $\Opcube_i(\top) := \top = \Op_i(\top)$,
		\item $\Opcube_i(W \multip \rival{\jet_i}) := W \multip \rival{\jet_i} \cong \Op_i(W \multip \rival{\jet_i})$ (by swapping 0 and 1),
		\item $\Opcube_i(W \multip \rival{\jet_j}) := \Opcube_i(W) \multip \rival{\jet_j} \cong \Op_i(W) \multip \rival{\jet_j} = \Op_i(W \multip \rival{\jet_j})$ if $i \neq j$. \qedhere
	\end{itemize}
\end{proof}
\begin{definition} \label{def:jet-cube-cat}
	Let $\vec a$ be a mode.
	We define the category $\jetcube{\vec a}$ of \textbf{jet cubes of mode $\vec a$} as the category
	\begin{itemize}
		\item whose objects are jet cubes of mode $\vec a$,
		\item 
	\end{itemize}
\end{definition}

\subsection{Jet Cubes Old}
\todoi{This is all wrong: there is no symmetry, no degradation and no connections/companions/conjoints.}

\begin{definition} \label{def:jet-cube-cat}
	Let $\vec a$ be a mode.
	We define the category $\jetcube{\vec a}$ of \textbf{jet cubes of mode $\vec a$} as the proof-relevant sub\emph{graph} (a priori; it will be a category after \cref{thm:jet-cube-cat}) of $\jetset{\vec a}$ whose nodes are the jet cubes, and whose edges are generated by:
	\begin{itemize}
		\item $(\vfi, 0) : \Hom_{\jetcube{\vec a}}(V, W \multip \rival{\jet_i})$ for $\vfi : \Hom_{\jetcube{\vec a}}(V, \Opcube_i(W))$,
		\item $(\vfi, 1) : \Hom_{\jetcube{\vec a}}(V, W \multip \rival{\jet_i})$ for $\vfi : \Hom_{\jetcube{\vec a}}(V, W)$,
		\item $\vfi \multip \rival{\jet_i} : \Hom_{\jetcube{\vec a}}(V \multip \rival{\jet_i}, W \multip \rival{\jet_i})$ for $\vfi : \Hom_{\jetcube{\vec a}}(V, W)$,
		\item $() : \Hom_{\jetcube{\vec a}}(V, \top)$.
	\end{itemize}
\end{definition}
Again, every jet cube morphism can be generated by the above steps in only a single way, so we can reason about them inductively.
\begin{corollary} \label{thm:jet-cube-op-ftr}
	Each $\Opcube_i$ extends to a well-defined graph endomorphism (and hence, after \cref{thm:jet-cube-cat}, an endofunctor) on $\jetcube{\vec a}$.
	We have $\Opcube_i \circ \Opcube_i = \Id$.
\end{corollary}
\begin{proof}
	We define recursively:
	\begin{itemize}
		\item $\Opcube_i(\vfi, 0 \in \rival{\jet_i}) := (\Opcube_i(\vfi), 1)$,
		\item $\Opcube_i(\vfi, 0 \in \rival{\jet_j}) := (\Opcube_i(\vfi), 0)$ if $i \neq j$,
		\item $\Opcube_i(\vfi, 1 \in \rival{\jet_i}) := (\Opcube_i(\vfi), 0)$,
		\item $\Opcube_i(\vfi, 1 \in \rival{\jet_j}) := (\Opcube_i(\vfi), 1)$ if $i \neq j$,
		\item $\Opcube_i(\vfi \multip \rival{\jet_i}) = \vfi \multip \rival{\jet_i}$,
		\item $\Opcube_i(\vfi \multip \rival{\jet_j}) = \Opcube_i(\vfi) \multip \rival{\jet_j}$ if $i \neq j$,
		\item $\Opcube_i(()) = ()$. \qedhere
	\end{itemize}
\end{proof}
\begin{corollary} \label{thm:jet-cube-cat}
	$\jetcube{\vec a}$ is a category.
\end{corollary}
\begin{proof}
	Identity and composition can be defined recursively; category laws proven inductively.
\end{proof}

\subsection{Comparison to Pinyo and Kraus's Twisted Cube Category}
In this section, we discuss how our approach reduces to Pinyo and Kraus's \cite{pinyo-twisted} when $\vec a = [\ypolar]$.
$\jetset{[\ypolar]}$ is the category of proof-irrelevant reflexive graphs.
Pinyo and Kraus use arbitrary proof-irrelevant graphs, but since $\top$ is reflexive and the twisted prism functor \cite[def.\ 4]{pinyo-twisted} restricts to reflexive graphs, all twisted cubes are reflexive graphs anyway.
\todoi{Continue}


Out of the category of jet sets, we will carve the category of jet cubes, in such a way that the category of jet cubes of mode $[\ypolar]$ is isomorphic to the twisted cube category \cite{pinyo-twisted}.


\bibliographystyle{alphaurl}
\bibliography{../refs/refs.bib}

\end{document}